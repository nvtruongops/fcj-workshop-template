[
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/5-workshop/5.01-workshop-overview/",
	"title": "Tổng quan Workshop",
	"tags": [],
	"description": "",
	"content": "Kiến trúc EveryoneCook EveryoneCook là một nền tảng mạng xã hội nấu ăn hiện đại được xây dựng hoàn toàn trên công nghệ serverless của AWS. Kiến trúc tuân theo các best practices về khả năng mở rộng, bảo mật và tối ưu chi phí, với trọng tâm là hỗ trợ nguyên liệu tiếng Việt và đề xuất công thức nấu ăn bằng AI.\nCác thành phần chính Frontend: Ứng dụng Next.js 15 với Flowbite React components được host trên AWS Amplify Backend: API serverless sử dụng API Gateway với mô hình API Router và 6 Lambda modules Database: DynamoDB Single Table Design với username-based PK và 5 GSI indexes Storage: S3 buckets với Intelligent-Tiering và CloudFront CDN với OAC Authentication: Cognito User Pool với Lambda triggers cho custom flows AI Integration: Amazon Bedrock (Claude 3 Haiku - anthropic.claude-3-haiku-20240307-v1:0) cho dịch nguyên liệu, tra cứu dinh dưỡng và tạo công thức Security: WAF cho API Gateway, Shield Standard cho CloudFront, KMS encryption Monitoring: CloudWatch dashboards, alarms, và X-Ray distributed tracing Sơ đồ kiến trúc Quy trình Workshop Workshop này tuân theo quy trình phát triển ứng dụng thực tế:\nThiết lập Môi trường - Cài đặt công cụ (Node.js, AWS CLI, CDK CLI) CDK Bootstrap - Chuẩn bị AWS account cho CDK deployments Cấu hình Stacks - Thiết lập cấu hình hạ tầng (DNS, Certificate, Core, Auth, Backend, Observability) Triển khai Infrastructure - Deploy tất cả CDK stacks lên AWS Cấu hình API \u0026amp; Lambda - Thiết lập API Gateway routes và Lambda functions Triển khai Backend - Deploy API và Lambda code Kiểm tra Endpoints - Xác minh tất cả endpoints hoạt động end-to-end Push lên GitLab - Version control và thiết lập CI/CD Triển khai lên Amplify - Deploy frontend lên AWS Amplify Giám sát \u0026amp; Bảo trì - Sử dụng CloudWatch và X-Ray để monitoring Những gì bạn sẽ học Infrastructure as Code với AWS CDK (TypeScript) Kiến trúc serverless với mô hình API Router DynamoDB Single Table Design với PROVISIONED billing mode CloudFront CDN với Origin Access Control (OAC) - PriceClass 200 Cognito authentication với Lambda triggers Tổ chức Lambda function theo modules (6 modules: API Router, Auth/User, Social, Recipe/AI, Admin, Upload) Xử lý bất đồng bộ với SQS (4 queues và workers) Tích hợp Bedrock AI (Claude 3 Haiku) với chiến lược dictionary-first caching WAF security cho API Gateway (REGIONAL scope) CloudWatch monitoring với structured logging (X-Ray disabled để tối ưu chi phí) Chiến lược tối ưu chi phí cho low-traffic scenarios Ước tính chi phí thực tế (Low Traffic Scenarios) Kịch bản 1: 100-500 Active Users/Day (2 giờ sử dụng)\nMonthly Active Users: ~3,000-15,000 Daily Requests: ~5,000-25,000 API calls Ước tính Chi phí Tháng: $12-18/tháng ($0.40-0.60/ngày) Kịch bản 2: 1,000 Active Users/Day (2 giờ sử dụng)\nMonthly Active Users: ~30,000 Daily Requests: ~50,000 API calls Ước tính Chi phí Tháng: $25-35/tháng ($0.83-1.17/ngày) Các yếu tố chi phí chính:\nDynamoDB: PROVISIONED mode (2 RCU/WCU) với auto-scaling → $1.25/tháng base + $0.50-3/tháng scaling Lambda: 6 functions (512MB-1GB memory) → $2-8/tháng (1M requests đầu miễn phí) CloudFront: PriceClass 200 (Asia/US/Europe) → $1-5/tháng (1TB đầu miễn phí, sau đó $0.085/GB) API Gateway: Regional endpoint → $1-3/tháng (1M đầu miễn phí, sau đó $3.50/triệu) Cognito: Standard security (không có Advanced Security Mode) → $0-1.50/tháng (50K MAU đầu miễn phí) S3: Intelligent-Tiering → $0.50-2/tháng (50GB đầu miễn phí) Bedrock AI: Claude 3 Haiku ($0.25/1M input tokens) → $2-8/tháng với 99% dictionary cache hit rate SQS: 4 queues (AI, Image, Analytics, Notification) → $0-0.40/tháng (1M requests đầu miễn phí) CloudWatch Logs: 3-day retention → $0.50-2/tháng WAF: Chỉ API Gateway (không có CloudFront WAF) → $5/tháng base + $0.60/triệu requests Tối ưu Chi phí Đã áp dụng:\nX-Ray tracing disabled (tiết kiệm $5-10/tháng) CloudFront WAF đã xóa, dùng Shield Standard (tiết kiệm $6/tháng) DynamoDB PROVISIONED mode với baseline thấp (2 RCU/WCU) thay vì ON_DEMAND CloudWatch log retention giảm xuống 3 ngày cho dev (tiết kiệm $2-5/tháng) API Gateway caching disabled cho dev (tiết kiệm $14.60/tháng) Bedrock dictionary-first strategy (99% cache hit rate, giảm chi phí AI 70%) Lambda Shared Dependencies Layer (giảm deployment size 90%, cold starts nhanh hơn) Tính năng chính Hỗ trợ tiếng Việt: Vietnamese analyzer cho tìm kiếm nguyên liệu Hỗ trợ AI: Bedrock Claude 3 Haiku cho tạo công thức Dịch Dictionary-First: Mục tiêu coverage 80% với intelligent caching Nền tảng Mạng xã hội: Posts, comments, reactions, friends, notifications Field-Level Privacy: Kiểm soát chi tiết về khả năng hiển thị profile Content Moderation: Quy trình kiểm duyệt tự động và thủ công Tìm kiếm Nâng cao: Full-text search với Vietnamese normalization Tối ưu Chi phí: Intelligent-Tiering, caching và tối ưu tài nguyên "
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/1-worklog/1.1-week1/",
	"title": "Nhật ký công việc Tuần 1",
	"tags": [],
	"description": "",
	"content": "Mục tiêu Tuần 1: Kết nối và làm quen với các thành viên của First Cloud Journey. Hiểu các dịch vụ cơ bản của AWS, cách sử dụng Console \u0026amp; CLI. Nhiệm vụ cần thực hiện trong tuần: Ngày Nhiệm vụ Ngày bắt đầu Ngày hoàn thành Tài liệu tham khảo 2 - Làm quen với các thành viên FCJ - Đọc và ghi chú lại nội quy, quy định của đơn vị thực tập 08/09/2025 08/09/2025 3 - Tìm hiểu về AWS và các nhóm dịch vụ chính + Compute + Storage + Networking + Database - Học cách vẽ kiến trúc AWS trên draw.io - Cách thực hiện workshop AWS 09/09/2025 09/09/2025 https://cloudjourney.awsstudygroup.com/ https://www.youtube.com/watch?v=l8isyDe-GwY\u0026list=PLahN4TLWtox2a3vElknwzU_urND8hLn1i\u0026index=2 https://www.youtube.com/watch?v=mXRqgMr_97U\u0026list=PLahN4TLWtox2a3vElknwzU_urND8hLn1i\u0026index=3 4 - Tạo tài khoản AWS mới - Quản lý chi phí sử dụng trên AWS bằng AWS Budgets - Yêu cầu hỗ trợ với AWS Support -Thực hành: + Thiết lập tài khoản AWS đầu tiên, bật MFA, tạo nhóm/người dùng Admin, cấu hình Console và quản lý Support Cases + Tạo ngân sách bằng mẫu, bao gồm Cost Budget, Usage Budget, RI Budget và Savings Plans Budget. + Thay đổi gói hỗ trợ và tạo yêu cầu hỗ trợ. 10/09/2025 10/09/2025 https://000001.awsstudygroup.com/ https://000007.awsstudygroup.com/ https://000009.awsstudygroup.com/ 5 - Quản lý truy cập với AWS Identity and Access Management (AWS IAM) - Triển khai hạ tầng mạng với Amazon Virtual Private Cloud (Amazon VPC) + Firewall trong VPC + Triển khai Amazon EC2 Instances + Thiết lập Site-to-Site VPN Connection trong AWS Thực hành: + Tạo VPC với subnet, internet gateway, route table, security group, EC2 server, NAT gateway, và môi trường VPN. 11/09/2025 11/09/2025 https://000002.awsstudygroup.com/ https://000003.awsstudygroup.com/ 6 - Bắt đầu và triển khai ứng dụng trên Amazon Compute Cloud (Amazon EC2) + Khởi chạy Microsoft Windows Server 2022 Instance + Triển khai ứng dụng Quản lý người dùng AWS trên Amazon Linux 2 + Triển khai ứng dụng Node.js trên Amazon EC2 Windows + Quản trị chi phí \u0026amp; sử dụng với IAM - Cấp quyền ứng dụng truy cập dịch vụ AWS thông qua IAM Role (AWS IAM) -Thực hành: + Kết nối tới Windows Server 2022 và Amazon Linux, cài đặt web server LAMP/XAMPP, và triển khai quản trị chi phí với AWS IAM. + Tạo S3 bucket 12/09/2025 12/09/2025 https://000004.awsstudygroup.com/ https://000048.awsstudygroup.com/ Thành tựu Tuần 1 Định hướng \u0026amp; Làm quen Làm quen với các thành viên FCJ Đọc và ghi chú lại nội quy, quy định của đơn vị thực tập Nền tảng AWS cơ bản Tìm hiểu về AWS và các nhóm dịch vụ chính: Compute, Storage, Networking, Database Thực hành vẽ kiến trúc AWS bằng draw.io Tham khảo workshop AWS qua tài liệu và video hướng dẫn Thiết lập tài khoản \u0026amp; Quản lý chi phí Tạo và cấu hình thành công tài khoản AWS Free Tier Bật Multi-Factor Authentication (MFA) để tăng cường bảo mật Tạo nhóm Admin và người dùng Admin, cấu hình truy cập qua AWS Management Console Thực hành quản lý chi phí bằng AWS Budgets: Cost Budget Usage Budget RI Budget Savings Plans Budget Thay đổi gói hỗ trợ và tạo yêu cầu hỗ trợ Nắm được quy trình quản lý Support Case với AWS Support IAM \u0026amp; Triển khai VPC Thực hành Quản lý truy cập với AWS Identity and Access Management (IAM) Triển khai hạ tầng mạng bằng Amazon VPC: Tạo subnet, internet gateway, route table, và security group Khởi chạy EC2 instances trong VPC Cấu hình NAT Gateway và thiết lập Site-to-Site VPN connection EC2 \u0026amp; Triển khai ứng dụng Khởi chạy và kết nối tới Microsoft Windows Server 2022 và Amazon Linux 2 Cài đặt và cấu hình LAMP trên Linux và XAMPP trên Windows Triển khai ứng dụng thử nghiệm bao gồm Node.js trên Amazon EC2 Thực hiện quản trị chi phí \u0026amp; sử dụng bằng IAM policies và roles Cấp quyền cho ứng dụng truy cập dịch vụ AWS thông qua IAM Roles Tạo và quản lý thành công S3 buckets để lưu trữ "
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/4-eventparticipated/4.1-event1/",
	"title": "Event 1",
	"tags": [],
	"description": "",
	"content": "Báo Cáo Sau Sự Kiện: The First Cloud Journey (FCJ) Program Kick-off Mục Tiêu Sự Kiện Khởi động chính thức chương trình The First Cloud Journey (FCJ) kéo dài 12 tuần. Kết nối thành viên, Mentor và Ban Tổ Chức (BTC). Giới thiệu tổng quan về tổ chức, mục tiêu học tập và lộ trình triển khai dự án. Hướng dẫn cách làm việc nhóm và tiến hành thành lập các đội dự án. Danh Sách Diễn Giả Đại diện BTC – Trình bày về tầm nhìn và định hướng của chương trình. Các Mentor – Chia sẻ kinh nghiệm thực tế và hành trình sự nghiệp trong lĩnh vực Cloud. Cựu thành viên (Alumni) – Truyền đạt những bài học quan trọng từ các khóa trước. Nội Dung Chính Cấu Trúc Chương Trình và Lộ Trình 12 Tuần Giới thiệu chi tiết lộ trình 12 tuần, từ kiến thức nền tảng AWS (VPC, EC2) đến xây dựng hoàn chỉnh một ứng dụng Serverless. Làm rõ mục tiêu học tập và yêu cầu về sản phẩm tối thiểu (MVP). Quy Tắc Làm Việc và Văn Hóa Tổ Chức Quy định về kỷ luật và tham gia: Nhấn mạnh sự cam kết và tinh thần trách nhiệm của từng thành viên. Văn hóa chia sẻ – hỗ trợ: Tạo môi trường học tập tích cực giữa các thành viên. Thành Lập Đội Dự Án và Định Hướng Ban Đầu Hướng dẫn quy trình xây dựng đội nhóm hiệu quả, phân chia vai trò và sử dụng công cụ giao tiếp. Định hướng ban đầu cho các dự án Cloud, hỗ trợ nhóm bắt đầu nghiên cứu. Bảo Mật Tài Khoản AWS Hướng dẫn thiết lập xác thực hai lớp (2FA) và tạo ngân sách giám sát chi phí (Budget) ngay từ đầu. Những Điều Rút Ra Tư Duy và Mức Độ Cam Kết Tính kỷ luật rất quan trọng: Nhận thức rõ sự nghiêm túc cần thiết để hoàn thành chương trình. Giá trị của cộng đồng: Thấy được tầm quan trọng của sự hỗ trợ từ Mentor và các thành viên khác. Hiểu Biết Về Tổ Chức Nắm rõ mục tiêu của chương trình và những kỹ năng Cloud sẽ được trang bị. Hiểu được lộ trình học tập 12 tuần với các mốc kiến thức quan trọng. Kỹ Năng Thực Hành Ban Đầu Hoàn thành việc thành lập đội nhóm, bắt đầu phân công vai trò. Học được các bước thiết lập bảo mật và quản lý chi phí cơ bản cho tài khoản AWS. Ứng Dụng Vào Công Việc Thành lập đội dự án và giao nhiệm vụ ban đầu. Bắt đầu tìm hiểu kiến thức nền tảng về Cloud và thông tin của tổ chức. Thực hiện các thao tác cơ bản trên AWS như kích hoạt 2FA và thiết lập Budget (theo Worklog Tuần 1). Trải Nghiệm Sự Kiện Sự kiện Kick-off mang lại nguồn năng lượng tích cực và giúp tôi định hình rõ ràng hướng đi cho hành trình sắp tới.\nKết Nối Và Không Khí Chung Được chào đón nồng nhiệt: Làm quen các thành viên FCJ, tạo nên môi trường học tập thân thiện. Tính nghiêm túc: Những chia sẻ từ BTC giúp tôi hiểu rõ kỳ vọng và mức độ cam kết cần thiết. Lộ Trình Và Mục Tiêu Tầm nhìn rõ ràng: Lần đầu thấy trực quan lộ trình 12 tuần, giúp tôi chủ động lên kế hoạch học tập. Hiểu rằng mục tiêu cuối cùng không chỉ là học mà còn xây dựng một sản phẩm Cloud thực tế. Bài Học Thực Tế Ban Đầu Quản lý chi phí và bảo mật: Hiểu được tầm quan trọng của 2FA và Budget ngay từ ngày đầu sử dụng AWS. Tinh thần làm việc nhóm: Nhanh chóng phối hợp với đội để xác định cách làm việc chung. Kết Luận Buổi Kick-off không đơn thuần là buổi giới thiệu chương trình; đây là một phiên định hướng toàn diện giúp tôi có đủ thông tin, động lực và sự tự tin để bước vào hành trình 12 tuần chinh phục Cloud.\n"
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/3-blogstranslated/3.1-blog1/",
	"title": "Blog 1: AWS được vinh danh là Nhà lãnh đạo trong Magic Quadrant 2025 của Gartner về Dịch vụ Nền tảng Đám mây Chiến lược trong 15 năm liên tiếp",
	"tags": [],
	"description": "",
	"content": "Tổng quan: 15 Năm Dẫn Đầu Ngành Công Nghiệp Cloud Vào ngày 4 tháng 8 năm 2025, Gartner đã công bố báo cáo Magic Quadrant for Strategic Cloud Platform Services (SCPS) mới nhất. Amazon Web Services (AWS) một lần nữa được công nhận là Nhà lãnh đạo (Leader) – đánh dấu năm thứ 15 liên tiếp AWS giữ vị trí cao nhất trong báo cáo này.\nĐặc biệt, Gartner đã xếp AWS cao nhất trên trục \u0026ldquo;Ability to Execute\u0026rdquo; (Khả năng thực thi), phản ánh cam kết không ngừng nghỉ của AWS trong việc cung cấp bộ khả năng rộng và sâu nhất để đẩy nhanh đổi mới, cùng với bảo mật, độ tin cậy và hiệu suất vượt trội mà khách hàng có thể tin tưởng cho các ứng dụng quan trọng nhất.\n1. Ba Điểm Mạnh Cốt Lõi Được Gartner Công Nhận 1.1. Cộng Đồng Cloud Lớn Nhất Thế Giới AWS đã xây dựng một cộng đồng chuyên gia cloud mạnh mẽ trên toàn cầu, mang lại cơ hội học tập và gắn kết đáng kể.\nCác sáng kiến cộng đồng chính:\nAWS Builder Center: Nền tảng kết nối trực tiếp với AWS Heroes và AWS Community Builders AWS User Groups: Mạng lưới nhóm người dùng toàn cầu để trao đổi kiến thức Hàng triệu khách hàng tích cực và hàng chục nghìn đối tác trên toàn thế giới Đây là phản hồi phổ biến nhất từ khách hàng: AWS có cộng đồng cloud lớn nhất và năng động nhất, giúp việc đặt câu hỏi và học hỏi từ cộng đồng trở nên dễ dàng.\n1.2. Silicon Tùy Chỉnh Lấy Cảm Hứng Từ Cloud AWS đã tận dụng kinh nghiệm điện toán đám mây để phát triển các thiết kế silicon tùy chỉnh:\nAWS Graviton: Bộ vi xử lý tối ưu hóa hiệu suất và chi phí AWS Inferentia: Chip chuyên dụng cho suy luận AI/ML AWS Trainium: Chip huấn luyện mô hình machine learning Lợi ích:\nTích hợp chặt chẽ hơn giữa phần cứng và phần mềm Cải thiện hiệu quả năng lượng Kiểm soát tốt hơn chuỗi cung ứng 1.3. Quy Mô Toàn Cầu và Thực Thi Vận Hành Thị phần doanh thu cloud toàn cầu đáng kể của AWS đã cho phép xây dựng mạng lưới đối tác tích hợp lớn hơn và mạnh mẽ hơn so với các nhà cung cấp khác trong phân tích này. Điều này giúp các tổ chức áp dụng cloud thành công.\n2. Các Chương Trình Hỗ Trợ Doanh Nghiệp AWS tập trung vào việc hỗ trợ chuyển đổi số của khách hàng doanh nghiệp thông qua nhiều chương trình:\n2.1. AWS Migration Acceleration Program Chương trình gia tốc migration giúp doanh nghiệp di chuyển workload lên cloud nhanh hơn và hiệu quả hơn.\n2.2. AWS Transform Sử dụng generative AI để hỗ trợ migration và modernization của các workload quan trọng:\nỨng dụng .NET Mainframe Môi trường VMware 3. Cách Tiếp Cận Báo Cáo và Đánh Giá Báo cáo đầy đủ của Gartner nêu rõ phương pháp luận và tiêu chí đánh giá được sử dụng để phát triển đánh giá của họ đối với từng nhà cung cấp dịch vụ cloud.\nBáo cáo này có thể phục vụ như một hướng dẫn khi lựa chọn nhà cung cấp cloud giúp bạn đổi mới vì lợi ích của khách hàng.\nKết luận Việc AWS được công nhận là Leader trong Magic Quadrant của Gartner suốt 15 năm liên tiếp không chỉ là một thành tựu đáng tự hào mà còn là minh chứng cho:\nSự đổi mới liên tục: Từ silicon tùy chỉnh đến generative AI Cam kết với khách hàng: Cộng đồng lớn nhất, chương trình hỗ trợ toàn diện Khả năng thực thi vượt trội: Quy mô toàn cầu, mạng lưới đối tác mạnh mẽ Doanh nghiệp có thể tin tưởng vào AWS như một đối tác chiến lược lâu dài để xây dựng, vận hành và đổi mới trên đám mây.\nLưu ý pháp lý quan trọng:\nGartner không ủng hộ bất kỳ vendor, sản phẩm hoặc dịch vụ nào được mô tả trong các ấn phẩm nghiên cứu của mình và không khuyên người dùng công nghệ chỉ chọn những vendor có xếp hạng cao nhất. Các ấn phẩm nghiên cứu của Gartner bao gồm ý kiến của tổ chức nghiên cứu Gartner và không nên được hiểu là tuyên bố về sự thật.\nTác giả Channy Yun (윤석찬)\rChanny là Lead Blogger của AWS News Blog và Principal Developer Advocate cho AWS Cloud. Với tư cách là một người đam mê open web và blogger từ trong tim, ông yêu thích việc học hỏi và chia sẻ công nghệ dựa trên cộng đồng.\n"
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/",
	"title": "Báo cáo thực tập",
	"tags": [],
	"description": "",
	"content": "Báo cáo thực tập Thông tin sinh viên: Họ và tên: Nguyễn Văn Trường\nSố điện thoại: 0764648648\nEmail: truongnvse182034@fpt.edu.vn\nTrường: Trường đại học FPT Hồ Chí Minh\nNgành: An toàn thông tin\nLớp: AWS092025\nCông ty thực tập: Công ty TNHH Amazon Web Services Vietnam\nVị trí thực tập: FCJ Cloud Intern\nThời gian thực tập: Từ ngày 12/08/2025 đến ngày 12/11/2025\nNội dung báo cáo Worklog Proposal Các bài blogs đã dịch Các events đã tham gia Workshop Tự đánh giá Chia sẻ, đóng góp ý kiến "
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/1-worklog/",
	"title": "Nhật ký công việc",
	"tags": [],
	"description": "",
	"content": "Trong trang này bạn sẽ cần giới thiệu worklog của bạn như thế nào? Bạn hoàn thành chương trình trong vòng bao nhiêu tuần? Bạn đã làm gì trong các tuần đó?\nThông thường và cũng là tiêu chuẩn, một worklog được thực hiện trong khoảng 3 tháng (trong suốt thời gian thực tập) với nội dung các tuần như sau:\nTuần 1: Làm quen với AWS và các dịch vụ cơ bản trong AWS\nTuần 2: Dịch vụ tính toán và lưu trữ cốt lõi trên AWS\nTuần 3: Xây dựng kiến trúc có tính sẵn sàng cao và khả năng mở rộng\nTuần 4: Triển khai lưu trữ dữ liệu, sao lưu và bảo mật\nTuần 5: Tối ưu hiệu năng và chi phí trên AWS\nTuần 6: Xây dựng hệ thống không máy chủ với tự động hóa\nTuần 7: Giám sát tài nguyên đám mây và tối ưu chi phí\nTuần 8: Mạng Nâng Cao và Hybrid Cloud\nTuần 9: Củng cố kiến thức backend và luyện các dịch vụ AWS quan trọng\nTuần 10: Nâng cao bảo mật backend và triển khai xác thực với Cognito và API Gateway.\nTuần 11: Tối ưu logic backend, cải thiện hiệu năng API và mô hình truy xuất dữ liệu.\nTuần 12: Xây dựng pipeline CI/CD và hoàn thiện tích hợp triển khai cho hệ thống backend.\n"
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/5-workshop/5.04-configure-stacks/5.4.1-dns-stack/",
	"title": "5.4.1 DNS Stack",
	"tags": [],
	"description": "",
	"content": " DNS Stack - Route 53 Hosted Zone Tổng quan DNS Stack là lớp nền tảng (Phase 1) của hạ tầng EveryoneCook. Nó quản lý Route 53 Hosted Zone cho domain everyonecook.cloud, cung cấp hạ tầng DNS mà tất cả các stacks khác phụ thuộc vào.\nThứ tự Triển khai: Stack này BẮT BUỘC phải được deploy đầu tiên trước bất kỳ stack nào khác.\nTrách nhiệm Chính Tạo và quản lý Route 53 Public Hosted Zone Export Hosted Zone ID và name cho cross-stack references Cung cấp nameservers cho domain delegation từ Hostinger Stack này KHÔNG bao gồm SES Email Identity (được quản lý bởi Auth Stack - Phase 3) DKIM/SPF/DMARC records (được quản lý bởi Auth Stack - Phase 3) ACM Certificates (được quản lý bởi Certificate Stack - Phase 1.5) Application DNS records (được quản lý bởi các stacks tương ứng) Kiến trúc ┌─────────────────────────────────────────────────────────┐\r│ Hostinger Domain │\r│ everyonecook.cloud │\r│ │\r│ ┌────────────────────────────────────────────────┐ │\r│ │ Domain Registrar Settings │ │\r│ │ • Cập nhật Nameservers thành Route 53 NS │ │\r│ └────────────────┬───────────────────────────────┘ │\r└───────────────────┼──────────────────────────────────────┘\r│ DNS Delegation\r▼\r┌─────────────────────────────────────────────────────────┐\r│ AWS Route 53 Hosted Zone │\r│ everyonecook.cloud │\r│ │\r│ Tài nguyên Được tạo: │\r│ • Public Hosted Zone │\r│ • 4 Nameserver (NS) Records │\r│ • SOA Record (tự động) │\r│ │\r│ Exports: │\r│ • Hosted Zone ID → Sử dụng bởi Certificate Stack │\r│ • Hosted Zone Name → Sử dụng bởi các stacks khác │\r│ • Nameservers → Cấu hình tại Hostinger │\r└─────────────────────────────────────────────────────────┘ Cấu hình Stack Cấu trúc File infrastructure/lib/stacks/\r└── dns-stack.ts # DNS Stack implementation Code Implementation File: infrastructure/lib/stacks/dns-stack.ts\nimport * as cdk from \u0026#39;aws-cdk-lib\u0026#39;; import { Construct } from \u0026#39;constructs\u0026#39;; import { BaseStack, BaseStackProps } from \u0026#39;../base-stack\u0026#39;; export class DnsStack extends BaseStack { public readonly hostedZone: cdk.aws_route53.IHostedZone; constructor(scope: Construct, id: string, props: BaseStackProps) { super(scope, id, props); // Thêm stack-specific tags cdk.Tags.of(this).add(\u0026#39;StackType\u0026#39;, \u0026#39;DNS\u0026#39;); cdk.Tags.of(this).add(\u0026#39;Layer\u0026#39;, \u0026#39;Foundation\u0026#39;); cdk.Tags.of(this).add(\u0026#39;CostCenter\u0026#39;, `DNS-${this.config.environment}`); // Tạo Route 53 Hosted Zone this.hostedZone = this.createHostedZone(); // Export stack outputs this.exportOutputs(); } private createHostedZone(): cdk.aws_route53.IHostedZone { // Trích xuất root domain từ environment config const rootDomain = this.config.domains.frontend .replace(/^(dev\\.|staging\\.)/, \u0026#39;\u0026#39;); // everyonecook.cloud const hostedZone = new cdk.aws_route53.PublicHostedZone( this, \u0026#39;HostedZone\u0026#39;, { zoneName: rootDomain, comment: `Hosted Zone cho Everyone Cook ${this.config.environment} environment`, } ); cdk.Tags.of(hostedZone).add(\u0026#39;Component\u0026#39;, \u0026#39;DNS\u0026#39;); cdk.Tags.of(hostedZone).add(\u0026#39;ManagedBy\u0026#39;, \u0026#39;CDK\u0026#39;); return hostedZone; } private exportOutputs(): void { // Export Hosted Zone ID new cdk.CfnOutput(this, \u0026#39;HostedZoneId\u0026#39;, { value: this.hostedZone.hostedZoneId, exportName: this.exportName(\u0026#39;HostedZoneId\u0026#39;), description: \u0026#39;Route 53 Hosted Zone ID\u0026#39;, }); // Export Hosted Zone Name new cdk.CfnOutput(this, \u0026#39;HostedZoneName\u0026#39;, { value: this.hostedZone.zoneName, exportName: this.exportName(\u0026#39;HostedZoneName\u0026#39;), description: \u0026#39;Domain name được quản lý bởi Route 53\u0026#39;, }); // Export Nameservers (cho cấu hình Hostinger) new cdk.CfnOutput(this, \u0026#39;NameServers\u0026#39;, { value: cdk.Fn.join(\u0026#39;, \u0026#39;, this.hostedZone.hostedZoneNameServers || []), description: \u0026#39;⚠️ Cập nhật các nameservers này tại Hostinger\u0026#39;, }); } } Chi tiết Cấu hình Chính 1. Logic Trích xuất Domain Stack tự động trích xuất root domain từ environment configuration:\n// Environment config: dev.everyonecook.cloud // Domain được trích xuất: everyonecook.cloud const rootDomain = this.config.domains.frontend.replace(/^(dev\\.|staging\\.)/, \u0026#39;\u0026#39;); Các Environments:\nDev: dev.everyonecook.cloud → Hosted Zone: everyonecook.cloud Staging: staging.everyonecook.cloud → Hosted Zone: everyonecook.cloud Prod: everyonecook.cloud → Hosted Zone: everyonecook.cloud 2. Quy ước Đặt tên Resource Tất cả resources tuân theo một mẫu đặt tên nhất quán:\n// Định dạng tên resource: everyonecook-{env}-{resource} protected resourceName(name: string): string { return `everyonecook-${this.config.environment}-${name}`; } // Định dạng tên export: EveryoneCook-{Env}-{Export} protected exportName(name: string): string { return `EveryoneCook-${this.config.environment}-${name}`; } Ví dụ:\nTên stack: EveryoneCook-dev-DNS Export: EveryoneCook-dev-HostedZoneId 3. Resource Tags Mỗi resource được tag để theo dõi chi phí và quản lý:\n{ Stack: \u0026#39;EveryoneCook-dev-DNS\u0026#39;, Environment: \u0026#39;dev\u0026#39;, StackType: \u0026#39;DNS\u0026#39;, Layer: \u0026#39;Foundation\u0026#39;, CostCenter: \u0026#39;DNS-dev\u0026#39;, Component: \u0026#39;DNS\u0026#39;, ManagedBy: \u0026#39;CDK\u0026#39;, Project: \u0026#39;EveryoneCook\u0026#39; } Stack Outputs Sau khi deployment, stack export các giá trị sau:\nTên Output Giá trị Sử dụng HostedZoneId Z0123456789ABCDEFGHIJ Sử dụng bởi Certificate Stack cho DNS validation HostedZoneName everyonecook.cloud Sử dụng bởi các stacks khác để tạo DNS records NameServers ns-1.awsdns-01.com, ns-2.awsdns-02.org, ... Cấu hình tại Hostinger cho DNS delegation Các Bước Triển khai Bước 1: Review Cấu hình Di chuyển đến thư mục infrastructure:\ncd D:\\Project_AWS\\everyonecook\\infrastructure Xác minh environment configuration trong config/environment.ts:\ndev: { environment: \u0026#39;dev\u0026#39;, account: \u0026#39;YOUR_AWS_ACCOUNT_ID\u0026#39;, region: \u0026#39;ap-southeast-1\u0026#39;, domains: { frontend: \u0026#39;dev.everyonecook.cloud\u0026#39;, api: \u0026#39;api-dev.everyonecook.cloud\u0026#39;, cdn: \u0026#39;cdn-dev.everyonecook.cloud\u0026#39;, }, // ... các configs khác } Bước 2: Deploy DNS Stack Deploy DNS stack lên AWS:\n# Deploy chỉ DNS Stack npx cdk deploy EveryoneCook-dev-DNS --context environment=dev Kết quả mong đợi:\n✨ Synthesis time: 5.23s\rEveryoneCook-dev-DNS: deploying...\rEveryoneCook-dev-DNS: creating CloudFormation changeset...\r✅ EveryoneCook-dev-DNS\r✨ Deployment time: 45.67s\rOutputs:\rEveryoneCook-dev-DNS.HostedZoneId = Z0123456789ABCDEFGHIJ\rEveryoneCook-dev-DNS.HostedZoneName = everyonecook.cloud\rEveryoneCook-dev-DNS.NameServers = ns-123.awsdns-45.com, ns-678.awsdns-90.net, ns-1234.awsdns-56.org, ns-5678.awsdns-01.co.uk\rStack ARN:\rarn:aws:cloudformation:ap-southeast-1:123456789012:stack/EveryoneCook-dev-DNS/... Bước 3: Xác minh trong AWS Console Di chuyển đến Route 53 trong AWS Console Vào Hosted zones Xác minh hosted zone everyonecook.cloud đã được tạo Giao diện mong đợi:\nDomain name: everyonecook.cloud Type: Public hosted zone Records: 2 (NS và SOA records - tự động được tạo) Route 53 Hosted Zone hiển thị chi tiết domain, NS records (4 nameservers), và SOA record\nBước 4: Copy Nameservers Từ CloudFormation Outputs hoặc Route 53 console, copy tất cả 4 nameserver records:\nns-123.awsdns-45.com\rns-678.awsdns-90.net\rns-1234.awsdns-56.org\rns-5678.awsdns-01.co.uk Vị trí nameserver records trong Route 53 console\nCấu hình Hostinger Bước Quan trọng Sau Deployment ⚠️ QUAN TRỌNG: Sau khi deploy DNS Stack, bạn BẮT BUỘC phải cập nhật nameservers tại Hostinger để ủy quyền quản lý DNS cho Route 53.\nCập nhật Nameservers tại Hostinger Đăng nhập vào Hostinger hPanel\nTruy cập https://hpanel.hostinger.com Đăng nhập với thông tin đăng nhập Hostinger của bạn Truy cập Quản lý Domain\nVào mục Domains Chọn domain everyonecook.cloud Thay đổi Nameservers\nClick vào DNS/Nameservers Chọn Change nameservers Chọn Custom nameservers Nhập Route 53 Nameservers\nNameserver 1: ns-123.awsdns-45.com Nameserver 2: ns-678.awsdns-90.net Nameserver 3: ns-1234.awsdns-56.org Nameserver 4: ns-5678.awsdns-01.co.uk Lưu Cấu hình\nClick nút Change nameservers Đợi xác nhận Hostinger hPanel hiển thị cấu hình custom nameservers với Route 53 NS records\nThời gian Propagation Propagation ban đầu: 15-30 phút Full global propagation: Lên đến 48 giờ (thường trong vòng 2-4 giờ) Xác minh DNS Delegation Sau khi cập nhật nameservers, xác minh delegation:\n# Kiểm tra nameservers cho domain nslookup -type=NS everyonecook.cloud # Hoặc sử dụng dig (nếu có) dig NS everyonecook.cloud Kết quả mong đợi:\neveryonecook.cloud nameserver = ns-123.awsdns-45.com\reveryonecook.cloud nameserver = ns-678.awsdns-90.net\reveryonecook.cloud nameserver = ns-1234.awsdns-56.org\reveryonecook.cloud nameserver = ns-5678.awsdns-01.co.uk Phân tích Chi phí Chi phí Hàng tháng Resource Chi phí Ghi chú Route 53 Hosted Zone $0.50/tháng Chi phí cố định cho mỗi hosted zone DNS Queries $0.40 per triệu queries 1 tỷ queries đầu tiên/tháng Tổng (Ước tính) ~$0.50-1.00/tháng Traffic rất thấp trong dev environment Ghi chú Tối ưu Chi phí ✅ Một hosted zone duy nhất cho tất cả environments (dev, staging, prod) ✅ Sử dụng subdomain prefixes để phân biệt environments ✅ Không có chi phí bổ sung cho NS, SOA, hoặc các DNS records khác ✅ Giá pay-per-query rất hiệu quả về chi phí cho low-medium traffic Cross-Stack Dependencies Exports Được sử dụng bởi Các Stacks Khác DNS Stack export các giá trị được import bởi:\nCertificate Stack (Phase 1.5)\nImports: HostedZoneId Mục đích: Tạo DNS validation records cho ACM certificates Core Stack (Phase 2)\nImports: HostedZoneId, HostedZoneName Mục đích: Tạo CloudFront A/AAAA alias records Backend Stack (Phase 4)\nImports: HostedZoneId Mục đích: Tạo API Gateway custom domain DNS records Luồng Dependencies DNS Stack (Route 53)\r│\r├─► Certificate Stack (ACM certificates)\r│\r├─► Core Stack (CloudFront DNS records)\r│\r└─► Backend Stack (API Gateway DNS records) Checklist Validation Trước khi tiếp tục deploy Certificate Stack:\nDNS Stack đã deploy thành công lên AWS Route 53 Hosted Zone hiển thị trong AWS Console 4 nameserver records đã lấy từ stack outputs Nameservers đã cập nhật tại Hostinger hPanel DNS delegation đã xác minh với nslookup hoặc dig Stack exports hiển thị trong CloudFormation console Tags đã được áp dụng đúng cho tất cả resources Bước tiếp theo Sau khi deploy và cấu hình DNS Stack thành công:\n➡️ 5.4.2 Certificate Stack - Tạo ACM certificates với DNS validation\nCertificate Stack sẽ:\nTạo ACM certificate cho CloudFront (cdn.everyonecook.cloud) Tạo wildcard ACM certificate cho API Gateway (*.everyonecook.cloud) Tự động tạo DNS validation records trong Route 53 Phải được deploy tới region us-east-1 (yêu cầu CloudFront) Tài liệu Tham khảo Source Code: infrastructure/lib/stacks/dns-stack.ts Base Stack: infrastructure/lib/base-stack.ts Environment Config: infrastructure/config/environment.ts AWS Documentation: Route 53 Hosted Zones Hostinger Guide: How to Change Nameservers "
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/5-workshop/5.02-setup-environment/",
	"title": "Thiết lập Môi trường",
	"tags": [],
	"description": "",
	"content": "Tổng quan Trong bước này, bạn sẽ cài đặt tất cả các công cụ cần thiết để phát triển và deploy ứng dụng EveryoneCook.\nCác công cụ cần thiết 1. Node.js 20.x\n# Tải từ https://nodejs.org/ # Hoặc sử dụng nvm (khuyến nghị) nvm install 20 nvm use 20 # Kiểm tra cài đặt node --version # Phải là v20.x npm --version Screenshot: Terminal hiển thị Node.js 20.x đã cài đặt\n2. AWS CLI v2\n# Windows: Tải từ https://aws.amazon.com/cli/ # macOS: brew install awscli # Linux: curl \u0026#34;https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip\u0026#34; -o \u0026#34;awscliv2.zip\u0026#34; unzip awscliv2.zip sudo ./aws/install # Kiểm tra cài đặt aws --version Screenshot: Terminal hiển thị AWS CLI v2 đã cài đặt\n3. AWS CDK CLI\n# Cài đặt CDK global npm install -g aws-cdk # Kiểm tra cài đặt cdk --version Screenshot: Terminal hiển thị CDK CLI đã cài đặt\n4. Git\n# Tải từ https://git-scm.com/ # Hoặc sử dụng package manager # Kiểm tra cài đặt git --version 5. Code Editor\nKhuyến nghị: Visual Studio Code với các extensions:\nAWS Toolkit GitLab Workflow ESLint Prettier Thiết lập AWS Account 1. Tạo AWS Account\nNếu chưa có AWS account:\nTruy cập https://aws.amazon.com/ Click \u0026ldquo;Create an AWS Account\u0026rdquo; Làm theo quy trình đăng ký Thêm phương thức thanh toán 2. Tạo IAM User\nĐể bảo mật, không sử dụng root account\nVào IAM Console → Users → Create user Tạo user và lưu credentials Screenshot: IAM console hiển thị user đã tạo với AdministratorAccess\n3. Cấu hình AWS CLI\n# Cấu hình AWS credentials aws configure # Nhập: # AWS Access Key ID: [Your Access Key] # AWS Secret Access Key: [Your Secret Key] # Default region name: us-east-1 # Default output format: json Screenshot: Terminal hiển thị aws configure hoàn tất\n4. Xác minh AWS Access\n# Kiểm tra AWS credentials aws sts get-caller-identity # Sẽ trả về account ID và user ARN của bạn Thiết lập Domain (Tùy chọn) Nếu muốn sử dụng custom domain:\n1. Đăng ký Domain\nMua domain name trên hpanel.hostinger Route 53 tạo dns record tới hostinger Cho workshop này, chúng tôi sử dụng: everyonecook.cloud\n2. Ghi chú Domain Registrar\nBạn sẽ cần truy cập domain registrar để cập nhật nameservers sau này.\nThiết lập GitLab Tạo GitLab Repo\nScreenshot: GitLab hiển thị personal access token đã tạo\n3. Cấu hình Git\n# Đặt tên và email của bạn git config --global user.name \u0026#34;Your Name\u0026#34; git config --global user.email \u0026#34;your.email@example.com\u0026#34; # Xác minh cấu hình git config --list Thiết lập Project 1. Clone hoặc Tạo Project\nTùy chọn A: Clone project hiện có\ngit clone https://gitlab.com/your-username/everyonecook.git cd everyonecook Tùy chọn B: Tạo project mới\nmkdir everyonecook cd everyonecook git init 2. Cài đặt Dependencies\n# Cài đặt tất cả dependencies npm install # Cài đặt: # - Infrastructure dependencies (CDK) # - Backend dependencies (Lambda modules) # - Shared dependencies 3. Copy Environment Variables\n# Copy file env mẫu cp .env.example .env # Chỉnh sửa .env với các giá trị của bạn # Các biến chính: # - AWS_REGION=us-east-1 # - AWS_ACCOUNT_ID=your-account-id # - DOMAIN_NAME=everyonecook.cloud # - GITLAB_TOKEN=your-gitlab-token Xác minh Kiểm tra mọi thứ đã cài đặt đúng:\n# Kiểm tra Node.js node --version # v20.x # Kiểm tra npm npm --version # 10.x # Kiểm tra AWS CLI aws --version # aws-cli/2.x # Kiểm tra CDK cdk --version # 2.x # Kiểm tra Git git --version # 2.x # Kiểm tra AWS credentials aws sts get-caller-identity # Kiểm tra project dependencies npm list --depth=0 Khắc phục sự cố Vấn đề: Node.js version không khớp\n# Sử dụng nvm để chuyển phiên bản nvm install 20 nvm use 20 Vấn đề: Không tìm thấy AWS CLI\nKhởi động lại terminal sau khi cài đặt Kiểm tra biến môi trường PATH Vấn đề: Không tìm thấy lệnh CDK\n# Cài đặt lại CDK globally npm uninstall -g aws-cdk npm install -g aws-cdk Vấn đề: AWS credentials không hợp lệ\n# Cấu hình lại AWS CLI aws configure # Nhập credentials đúng Bước tiếp theo Sau khi thiết lập môi trường xong, tiếp tục với CDK Bootstrap để chuẩn bị AWS account cho CDK deployments.\n"
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/4-eventparticipated/4.2-event2/",
	"title": "Event 2",
	"tags": [],
	"description": "",
	"content": "Báo Cáo Sau Sự Kiện: AWS Cloud Mastery Series #1 — AI/ML/GenAI on AWS Mục Tiêu Sự Kiện Cung cấp góc nhìn tổng quan về bối cảnh AI/ML tại Việt Nam. Giới thiệu các dịch vụ AI/ML chủ đạo của AWS, đặc biệt là Amazon SageMaker. Khám phá Generative AI thông qua Amazon Bedrock, bao gồm Foundation Models và các phương pháp triển khai hiện đại như RAG và Prompt Engineering. Nội Dung Nổi Bật Buổi Sáng: Tổng Quan Dịch Vụ AI/ML của AWS Trình bày bối cảnh AI/ML tại Việt Nam và mục tiêu của workshop. Amazon SageMaker: nền tảng ML toàn diện của AWS. Quy trình làm ML: chuẩn bị dữ liệu, gán nhãn, huấn luyện, tối ưu và triển khai mô hình. Tích hợp MLOps sẵn có trong SageMaker. Demo trực tiếp: hướng dẫn thao tác với SageMaker Studio. Buổi Chiều: Generative AI với Amazon Bedrock Foundation Models: so sánh và định hướng lựa chọn giữa Claude, Llama, Titan và các mô hình khác. Prompt Engineering: Kỹ thuật nâng cao như Chain-of-Thought và Few-shot Learning. Retrieval-Augmented Generation (RAG): Kiến trúc RAG và cách tích hợp nguồn dữ liệu bên ngoài. Bedrock Agents: xây dựng quy trình nhiều bước và tích hợp công cụ. Guardrails: nguyên tắc kiểm soát an toàn và lọc nội dung. Demo trực tiếp: xây dựng chatbot Generative AI bằng Bedrock. Những Điều Rút Ra SageMaker: hiểu rõ vai trò như một nền tảng quản lý toàn bộ vòng đời ML (từ chuẩn bị dữ liệu → huấn luyện → triển khai). Bedrock \u0026amp; GenAI: nắm được cách Bedrock quản lý Foundation Models, phương pháp so sánh mô hình và các kỹ thuật cốt lõi như Prompt Engineering và RAG. Ứng dụng vào dự án: RAG và Bedrock Agents rất hữu ích trong việc nâng cấp tính năng chatbot của dự án Travel-Guided. Các phần demo đem lại cái nhìn thực tế về quy trình triển khai và khả năng tạo prototype nhanh với Bedrock. Trải Nghiệm Sự Kiện Ấn tượng với các demo trực tiếp, đặc biệt là tốc độ xây dựng chatbot bằng Bedrock. Sự kiện tạo cơ hội kết nối và trao đổi giá trị với các chuyên gia AI/ML tại Việt Nam. "
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/3-blogstranslated/3.2-blog2/",
	"title": "Blog 2: Các mô hình Qwen hiện đã có sẵn trong Amazon Bedrock",
	"tags": [],
	"description": "",
	"content": "Tổng quan: Mở rộng lựa chọn mô hình với Qwen từ Alibaba Cloud Amazon Bedrock tiếp tục mở rộng thư viện Generative AI của mình bằng cách bổ sung các mô hình Qwen3 từ Alibaba Cloud. Đây là các mô hình nền tảng (Foundation Models - FMs) trọng số mở, được quản lý hoàn toàn và không yêu cầu máy chủ (serverless).\nViệc ra mắt này mang đến cho các nhà phát triển nhiều lựa chọn linh hoạt hơn, từ các mô hình Mixture-of-Experts (MoE) hiệu suất cao đến các mô hình Dense (dày đặc) tối ưu chi phí, đáp ứng đa dạng nhu cầu từ lập trình, suy luận phức tạp đến triển khai trên các thiết bị biên.\n1. Các biến thể Qwen3 có sẵn trên Bedrock Bản phát hành này bao gồm 4 biến thể mô hình chính, mỗi biến thể được tối ưu hóa cho các yêu cầu cụ thể về hiệu suất và chi phí:\nQwen3-Coder-480B-A35B-Instruct: Mô hình MoE khổng lồ với 480 tỷ tham số (35 tỷ kích hoạt). Tối ưu hóa cho các tác vụ lập trình và tác tử (agentic), xử lý tốt việc phân tích kho mã nguồn lớn. Qwen3-Coder-30B-A3B-Instruct: Mô hình MoE nhỏ gọn hơn, chuyên biệt cho việc tạo mã, gỡ lỗi và tuân theo hướng dẫn lập trình đa ngôn ngữ. Qwen3-235B-A22B-Instruct-2507: Mô hình MoE cân bằng giữa khả năng và hiệu quả, cạnh tranh mạnh mẽ trong các tác vụ suy luận chung và toán học. Qwen3-32B (Dense): Mô hình kiến trúc dày đặc, phù hợp cho các môi trường thời gian thực hoặc hạn chế tài nguyên (như thiết bị di động/edge) nhờ hiệu suất ổn định. 2. Các tính năng kiến trúc nổi bật Các mô hình Qwen3 giới thiệu nhiều cải tiến kỹ thuật quan trọng giúp giải quyết các bài toán doanh nghiệp phức tạp.\nChế độ tư duy lai (Hybrid Thinking Modes): Hỗ trợ hai chế độ giải quyết vấn đề: Thinking mode: Suy luận từng bước cho các vấn đề phức tạp. Non-thinking mode: Phản hồi tức thì cho các tác vụ đơn giản, giúp tối ưu hóa chi phí. Khả năng Agentic \u0026amp; Gọi công cụ (Tool Use): Các mô hình có khả năng lập kế hoạch nhiều bước và giao tiếp chuẩn hóa với các API bên ngoài, lý tưởng để xây dựng các quy trình tự động hóa. Cửa sổ ngữ cảnh siêu lớn (Long-context): Dòng Qwen3-Coder hỗ trợ ngữ cảnh lên tới 1 triệu tokens (thông qua phương pháp ngoại suy), cho phép xử lý toàn bộ kho tài liệu kỹ thuật hoặc lịch sử hội thoại dài trong một lần gọi. 3. Truy cập và Tích hợp Người dùng có thể trải nghiệm ngay các mô hình Qwen thông qua Amazon Bedrock Console tại khu vực Chat/Text Playground hoặc tích hợp vào ứng dụng thông qua AWS SDK.\nĐặc biệt, Amazon Bedrock đã đơn giản hóa quy trình truy cập mô hình. Quản trị viên tài khoản có toàn quyền kiểm soát việc bật/tắt quyền truy cập thông qua AWS IAM policies và Service Control Policies (SCPs), đảm bảo tuân thủ bảo mật doanh nghiệp mà không cần kích hoạt thủ công từng mô hình.\nKết luận Sự bổ sung Qwen3 vào Amazon Bedrock mang lại sức mạnh to lớn cho các kỹ sư phần mềm và nhà khoa học dữ liệu. Với khả năng xử lý mã nguồn vượt trội và kiến trúc linh hoạt, doanh nghiệp có thể:\nTự động hóa quy trình phân tích và refactor mã nguồn. Xây dựng các trợ lý AI thông minh với chi phí suy luận tối ưu. Triển khai đa dạng từ đám mây xuống thiết bị biên mà không thay đổi nền tảng quản lý. Tác giả Danilo Poccia\rDanilo là Chief Evangelist (EMEA) tại Amazon Web Services. Ông làm việc với các công ty khởi nghiệp và doanh nghiệp ở mọi quy mô để hỗ trợ đổi mới sáng tạo. Ông tận dụng kinh nghiệm của mình để giúp mọi người hiện thực hóa ý tưởng, tập trung vào kiến trúc serverless, lập trình hướng sự kiện (event-driven), và tác động kinh doanh của máy học (Machine Learning) cũng như điện toán biên (Edge Computing). Ông cũng là tác giả cuốn sách \"AWS Lambda in Action\" của nhà xuất bản Manning.\n"
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/1-worklog/1.2-week2/",
	"title": "Nhật ký Tuần 2",
	"tags": [],
	"description": "",
	"content": "Mục tiêu Tuần 2: Làm chủ việc sử dụng AWS Cloud9 IDE và AWS CLI để tương tác với các dịch vụ AWS. Tìm hiểu sâu về các dịch vụ Lưu trữ AWS (S3) bao gồm Lưu trữ Trang web Tĩnh, Phiên bản, Sao chép và Mạng Phân phối Nội dung (CloudFront). Triển khai và quản lý Cơ sở dữ liệu Quan hệ với Amazon RDS, bao gồm các chiến lược sao lưu và phục hồi. Triển khai kiến trúc Tính khả dụng cao và Khả năng mở rộng bằng cách sử dụng Mẫu Khởi chạy, Cân bằng Tải Đàn hồi (ELB) và Nhóm Tự động Mở rộng (ASG). Nhiệm vụ cần thực hiện trong tuần này: Ngày Nhiệm vụ Ngày Bắt đầu Ngày Hoàn thành Tài liệu Tham khảo 2 Tương tác với Dịch vụ AWS (Cloud9 \u0026amp; CLI) - Tạo môi trường AWS Cloud9 - Khám phá Tính năng Cơ bản: Sử dụng dòng lệnh, Làm việc với tệp văn bản - Thực hành sử dụng AWS CLI để tương tác với các dịch vụ - Dọn dẹp tài nguyên 15/09/2025 15/09/2025 https://000049.awsstudygroup.com/ 3 Lưu trữ \u0026amp; Phân phối Nội dung (S3 \u0026amp; CloudFront) - Tạo S3 Bucket \u0026amp; Tải lên Dữ liệu - Cấu hình Lưu trữ Trang web Tĩnh trên S3 - Quản lý Chặn Truy cập Công khai \u0026amp; chính sách Đối tượng Công khai - Tăng tốc trang web với tích hợp Amazon CloudFront - Triển khai Phiên bản S3 Bucket để bảo vệ dữ liệu - Thực hành Di chuyển Đối tượng \u0026amp; Sao chép Liên Vùng (CRR) 16/09/2025 16/09/2025 https://000057.awsstudygroup.com/ 4 Quản lý Cơ sở dữ liệu (Amazon RDS) - Chuẩn bị Mạng: VPC, Nhóm Bảo mật cho EC2 \u0026amp; RDS, Nhóm Subnet DB - Khởi chạy phiên bản EC2 cho ứng dụng - Cung cấp phiên bản cơ sở dữ liệu Amazon RDS - Triển khai ứng dụng và kết nối với RDS - Thực hiện các thao tác Sao lưu và Phục hồi cho RDS 17/09/2025 17/09/2025 https://000005.awsstudygroup.com/ 5 Kiến trúc Tính khả dụng Cao - Phần 1 - Chuẩn bị Hạ tầng: Mạng, EC2, RDS, Triển khai Máy chủ Web - Tạo Mẫu Khởi chạy cho việc khởi chạy phiên bản tiêu chuẩn - Cấu hình Bộ Cân bằng Tải Ứng dụng (ALB) + Tạo Nhóm Mục tiêu + Thiết lập trình lắng nghe Bộ Cân bằng Tải - Kiểm tra phân phối lưu lượng Cân bằng Tải 18/09/2025 18/09/2025 https://000006.awsstudygroup.com/ 6 Kiến trúc Tính khả dụng Cao - Phần 2 (Tự động Mở rộng) - Tạo Nhóm Tự động Mở rộng (ASG) gắn với Bộ Cân bằng Tải - Kiểm tra Giải pháp Mở rộng: + Mở rộng Thủ công: Điều chỉnh dung lượng thủ công + Mở rộng Theo lịch: Mở rộng dựa trên thời gian + Mở rộng Động: Mở rộng dựa trên các chỉ số (CPU, v.v.) + Mở rộng Dự đoán: Xem xét các chỉ số - Dọn dẹp tất cả tài nguyên 19/09/2025 19/09/2025 https://000006.awsstudygroup.com/ Thành tựu Tuần 2 Công cụ Phát triển \u0026amp; CLI Thiết lập thành công AWS Cloud9 như một IDE dựa trên đám mây. Thành thạo trong việc sử dụng AWS CLI để quản lý dịch vụ mà không cần Console. Hiểu được quy trình chỉnh sửa, gỡ lỗi và chạy tập lệnh trực tiếp trên Cloud9. Làm chủ Lưu trữ \u0026amp; CDN Triển khai Trang web Tĩnh sử dụng Amazon S3. Bảo mật và tối ưu hóa phân phối nội dung toàn cầu bằng Amazon CloudFront. Triển khai các chiến lược bảo vệ dữ liệu bằng Phiên bản S3. Cấu hình Sao chép Liên Vùng (CRR) để khôi phục thảm họa và định vị dữ liệu. Quản lý Cơ sở dữ liệu Triển khai cơ sở dữ liệu quan hệ được quản lý hoàn toàn bằng Amazon RDS. Kết nối thành công ứng dụng web được lưu trữ trên EC2 với phiên bản RDS. Thực hành các nhiệm vụ bảo trì cơ sở dữ liệu bao gồm tạo Ảnh chụp nhanh và thực hiện Khôi phục Tại thời điểm. Quản lý bảo mật mạng cho cơ sở dữ liệu bằng Nhóm Bảo mật và Nhóm Subnet DB. Tính khả dụng Cao \u0026amp; Khả năng Mở rộng Thiết kế kiến trúc chịu lỗi bằng cách sử dụng Cân bằng Tải Đàn hồi (ALB) và Nhóm Tự động Mở rộng (ASG). Tạo Mẫu Khởi chạy để xác định cấu hình phiên bản cho tự động mở rộng. Triển khai và kiểm tra các chính sách mở rộng khác nhau: Mở rộng Thủ công để kiểm soát trực tiếp. Mở rộng Theo lịch cho các mẫu lưu lượng có thể dự đoán. Mở rộng Động để phản ứng với các thay đổi tải thời gian thực. Xác minh phân phối lưu lượng và tính khả dụng của ứng dụng trong các sự kiện mở rộng. "
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/2-proposal/",
	"title": "Đề xuất dự án",
	"tags": [],
	"description": "",
	"content": "AWS First Cloud AI Journey – Kế Hoạch Dự Án Hello World – Đại học FPT – EveryoneCook\nNgày: 30/11/2025\n📥 Tải Đề Xuất Đầy Đủ (DOCX)\nMỤC LỤC 1. BỐI CẢNH VÀ ĐỘNG LỰC\n1.1 Tóm tắt điều hành\n1.2 TIÊU CHÍ THÀNH CÔNG DỰ ÁN\n1.3 Giả định\n2. KIẾN TRÚC GIẢI PHÁP / SƠ ĐỒ KIẾN TRÚC\n2.1 Sơ đồ Kiến trúc Kỹ thuật\n2.2 Kế hoạch Kỹ thuật\n2.3 Kế hoạch Dự án\n2.4 Cân nhắc Bảo mật\n3. HOẠT ĐỘNG VÀ SẢN PHẨM BÀN GIAO\n3.1 Hoạt động và sản phẩm bàn giao\n3.2 NGOÀI PHẠM VI\n3.3 LỘ TRÌNH ĐƯA VÀO SẢN XUẤT\n4. DỰ TOÁN CHI PHÍ AWS THEO DỊCH VỤ\n5. NHÓM DỰ ÁN\n6. NGUỒN LỰC \u0026amp; ƯỚC TÍNH CHI PHÍ\n7. CHẤP THUẬN\n1. BỐI CẢNH VÀ ĐỘNG LỰC 1.1 Tóm tắt điều hành Thông tin khách hàng\nKhách hàng là một startup tập trung xây dựng nền tảng mạng xã hội hiện đại, nơi người dùng có thể chia sẻ công thức nấu ăn, tải lên hình ảnh món ăn, trao đổi kinh nghiệm ẩm thực và khám phá các món ăn được AI gợi ý. Tổ chức hướng đến việc cung cấp một nền tảng tương tác cao, có khả năng phục vụ lượng người dùng lớn và ngày càng tăng.\nMục tiêu kinh doanh và kỹ thuật \u0026ndash; động lực chuyển sang AWS cloud\nCho phép phát triển và triển khai nhanh chóng sử dụng các dịch vụ quản lý của AWS Đảm bảo khả năng mở rộng cao khi lượng người dùng và lưu trữ media tăng Cung cấp môi trường đáng tin cậy, độ trễ thấp cho tính toán AI và phân phối nội dung Giảm chi phí hạ tầng ban đầu và chuyển sang mô hình pay-as-you-go Cải thiện bảo mật dữ liệu, sao lưu và tuân thủ thông qua các khả năng native của AWS Các trường hợp sử dụng\nNgười dùng tải lên công thức, hình ảnh và video nấu ăn lên nền tảng Hệ thống gợi ý món ăn sử dụng AI dựa trên nguyên liệu có sẵn do người dùng cung cấp Người dùng tương tác xã hội thông qua thích, bình luận, chia sẻ và theo dõi AI xử lý văn bản và hình ảnh để tạo gợi ý công thức Quản trị viên quản lý nội dung, giám sát hoạt động nền tảng và theo dõi phân tích hiệu suất Để đáp ứng mục tiêu của khách hàng trong việc xây dựng nền tảng nấu ăn xã hội có khả năng mở rộng với gợi ý công thức được hỗ trợ bởi AI, đối tác sẽ cung cấp triển khai cloud end-to-end đầy đủ trên AWS. Các dịch vụ cung cấp bao gồm:\nThiết kế Kiến trúc Cloud: Định nghĩa kiến trúc serverless an toàn, có khả năng mở rộng cao sử dụng các phương pháp hay nhất của AWS (Route 53, API Gateway, Lambda, DynamoDB, S3, CloudFront, Cognito) Tích hợp AI: Triển khai AWS Bedrock (Claude 3.5 Sonnet) cho gợi ý công thức thông minh, phân tích hình ảnh và các tính năng xử lý ngôn ngữ tự nhiên Triển khai Hạ tầng: Xây dựng và triển khai tất cả backend, frontend, xác thực và lớp dữ liệu sử dụng Infrastructure as Code (IaC) với CI/CD pipelines tự động hoàn toàn Bảo mật \u0026amp; Tuân thủ: Cấu hình IAM roles, mã hóa (KMS), WAF, logging, monitoring và các guardrails tuân thủ để đảm bảo bảo mật nền tảng Thiết lập Observability: Bật CloudWatch dashboards, alarms, X-Ray tracing và tập trung log cho monitoring và insights hiệu suất thời gian thực DevOps \u0026amp; Tự động hóa: Triển khai quy trình build/deploy tự động qua GitLab + Amplify, operational pipelines và cấu hình auto-scaling Tối ưu Hiệu suất: Cấu hình CDN caching, DynamoDB capacity scaling, search indexing và xử lý background bất đồng bộ dựa trên SQS Chuyển giao Kiến thức \u0026amp; Tài liệu: Cung cấp tài liệu kỹ thuật, phương pháp hay nhất, hướng dẫn kiến trúc và đào tạo bàn giao cho đội ngũ kỹ thuật của khách hàng 1.2 TIÊU CHÍ THÀNH CÔNG DỰ ÁN Khả dụng hệ thống ≥ 99.9% uptime trên tất cả dịch vụ production (API Gateway, Lambda, DynamoDB, CloudFront) Thời gian tải trang \u0026lt; 2.5 giây cho giao diện người dùng chính được phân phối qua CloudFront và Amplify Thời gian phản hồi API \u0026lt; 300 ms cho 90% tất cả các yêu cầu API hướng người dùng trong điều kiện traffic bình thường Độ trễ xử lý AI \u0026lt; 5 giây cho gợi ý công thức được tạo bởi AWS Bedrock Tỷ lệ thành công xác thực người dùng ≥ 98% với Cognito xử lý đăng ký, đăng nhập và xác minh email Không có lỗ hổng bảo mật nghiêm trọng sau khi review bảo mật và triển khai WAF rules Độ bền dữ liệu 99.999999999% (11 nines) được đảm bảo thông qua S3 object storage và DynamoDB Khả năng mở rộng hỗ trợ 10,000+ người dùng đồng thời mà không giảm hiệu suất nhờ hạ tầng serverless Kiểm soát chi phí vận hành trong ngân sách mục tiêu: sử dụng AWS hàng tháng không vượt quá $200 cho production Tỷ lệ thành công tải lên \u0026amp; xử lý hình ảnh ≥ 99%, được hỗ trợ bởi S3, Lambda Workers và SQS Hiệu suất tìm kiếm dưới 1 giây (nếu OpenSearch được bật) cho các truy vấn tìm kiếm công thức/nội dung Phạm vi monitoring 100% dịch vụ quan trọng sử dụng CloudWatch dashboards, alarms và X-Ray tracing Thời gian triển khai CI/CD \u0026lt; 5 phút qua GitHub → Amplify và IaC automation Không có sự kiện mất dữ liệu, được đảm bảo bởi DynamoDB PITR và S3 versioning 1.3 Giả định Khách hàng sẽ cung cấp quyền truy cập đầy đủ vào domain registrar (Hostinger) để cấu hình DNS delegation sang Route 53 Khách hàng sẽ cung cấp quyền truy cập AWS account hợp lệ với quyền Administrator cho triển khai và cấu hình Tất cả dịch vụ AWS cần thiết (Amplify, API Gateway, Lambda, DynamoDB, CloudFront, Cognito, Bedrock, SES) đều khả dụng và được hỗ trợ trong region đã chọn SES sẽ được chuyển thành công ra khỏi sandbox và được phê duyệt cho gửi email production Các tích hợp bên thứ ba (GitHub cho CI/CD, email clients bên ngoài, nguồn tải lên hình ảnh) sẽ vẫn khả dụng và ổn định Đội ngũ phát triển sẽ duy trì chất lượng source code và tuân theo các hướng dẫn kiến trúc do đối tác cung cấp Khách hàng sẽ cung cấp phản hồi và phê duyệt kịp thời trong các giai đoạn thiết kế, testing và triển khai Phụ thuộc\nKết nối internet đáng tin cậy được yêu cầu cho tất cả người dùng truy cập ứng dụng web và APIs Hệ thống phụ thuộc vào AWS Bedrock (Claude 3.5 Sonnet) cho tạo công thức AI và có thể gặp biến động hiệu suất nếu model bị rate-limited Quy trình tải lên và xử lý hình ảnh phụ thuộc vào độ tin cậy xử lý của S3, Lambda và SQS Nếu OpenSearch được bật, các tính năng tìm kiếm phụ thuộc vào khả dụng của OpenSearch domain GitHub Actions và Amplify phụ thuộc vào khả dụng dịch vụ GitHub Ràng buộc\nDự án sẽ được triển khai hoàn toàn trong một AWS region duy nhất, có thể ảnh hưởng đến độ trễ cho người dùng ngoài region Giải pháp được thiết kế sử dụng các pattern serverless; các workload dựa trên EC2 tùy chỉnh nằm ngoài phạm vi dự án Uy tín domain SES có thể ảnh hưởng đến khả năng gửi email trong những tuần đầu OpenSearch được triển khai dưới dạng cluster single-node để tiết kiệm chi phí, nghĩa là không có high availability cho search indexing Hệ thống phải nằm trong mục tiêu chi phí của khách hàng (\u0026lt; $200/tháng), hạn chế việc sử dụng tài nguyên compute lớn Rủi ro\nPhê duyệt SES production có thể bị trì hoãn, ảnh hưởng đến email onboarding và thông báo người dùng Nếu traffic tăng bất ngờ, DynamoDB provisioned capacity có thể bị throttle mà không có điều chỉnh scaling kịp thời Thay đổi chi phí hoặc độ trễ AI model bởi AWS có thể ảnh hưởng đến hiệu suất ứng dụng hoặc kiểm soát chi phí Cấu hình CloudFront caching sai có thể dẫn đến độ trễ cao hơn hoặc tăng chi phí data transfer Bất kỳ cấu hình IAM không chính xác nào có thể dẫn đến rủi ro bảo mật hoặc gián đoạn dịch vụ Thay đổi nhân sự đội ngũ khách hàng hoặc thiếu kỹ năng DevOps có thể làm chậm bảo trì hoặc triển khai trong tương lai 2. KIẾN TRÚC GIẢI PHÁP / SƠ ĐỒ KIẾN TRÚC 2.1 Sơ đồ Kiến trúc Kỹ thuật Kiến trúc giải pháp đề xuất cho nền tảng mạng xã hội nấu ăn được hỗ trợ bởi AI được thiết kế sử dụng stack cloud-native AWS hoàn toàn serverless và có khả năng mở rộng. Kiến trúc đảm bảo high availability, bảo mật và tích hợp liền mạch giữa web frontend, backend APIs, xác thực, lưu trữ dữ liệu và dịch vụ gợi ý AI.\nDưới đây là mô tả các thành phần chính và cách dữ liệu chảy qua hệ thống:\n1. Lớp Network \u0026amp; Edge\nAmazon Route 53: Cung cấp DNS routing cho custom domain được sử dụng bởi nền tảng. Các yêu cầu HTTPS đến từ người dùng được resolve và chuyển tiếp đến CloudFront Amazon CloudFront: Hoạt động như CDN toàn cầu phân phối nội dung frontend với độ trễ thấp trong khi cache các file tĩnh AWS WAF: Bảo vệ ứng dụng khỏi các khai thác web phổ biến như SQL injection, XSS và bot attacks 2. Frontend Hosting \u0026amp; Deployment\nAWS Amplify Hosting: Host và triển khai ứng dụng frontend Next.js, tích hợp với GitLab CI/CD cho triển khai tự động từ quy trình phát triển 3. Lớp Application\nAmazon Cognito: Xử lý xác thực và ủy quyền người dùng, hỗ trợ email/password và social logins Amazon API Gateway: Phục vụ như điểm vào chính cho backend APIs, expose các REST endpoints được sử dụng bởi frontend AWS Lambda: Chứa business logic backend, bao gồm quản lý người dùng, thao tác bài đăng và công thức, phân tích nguyên liệu, kết nối đến Bedrock cho gợi ý AI 4. Lớp AI Recommendation\nAmazon Bedrock: Cung cấp khả năng generative AI để gợi ý công thức dựa trên nguyên liệu do người dùng cung cấp. Lambda gọi các model Bedrock (Claude, Titan) để phân tích danh sách nguyên liệu, tạo gợi ý công thức, phân loại danh mục thực phẩm và tối ưu các bước nấu ăn 5. Lớp Data Storage\nAmazon DynamoDB: Lưu trữ dữ liệu ứng dụng có cấu trúc như user profiles, posts/recipes, likes \u0026amp; comments, ingredient metadata Amazon S3: Lưu trữ dữ liệu phi cấu trúc như recipe images, user-uploaded food photos, static content. S3 bucket được tích hợp với CloudFront qua OAI cho truy cập an toàn 6. Lớp Observability \u0026amp; Security\nAmazon CloudWatch: Giám sát hiệu suất Lambda, API Gateway access logs và system metrics AWS X-Ray: Thực hiện distributed tracing cho API calls và debugging IAM: Định nghĩa permission boundaries giữa API, Lambda functions, Bedrock, DynamoDB và S3 Amazon SES: Gửi verification emails, notifications và password recovery messages Amazon SNS: Xử lý system-level alerts và asynchronous messaging 7. Deployment \u0026amp; Infrastructure Management\nAWS CDK: Được developers sử dụng để định nghĩa và provision toàn bộ hạ tầng qua CloudFormation templates, đảm bảo triển khai nhất quán, có thể tái tạo và version-controlled 2.2 Kế hoạch Kỹ thuật Đối tác sẽ phát triển Infrastructure-as-Code (IaC) automation sử dụng AWS CDK (Cloud Development Kit) với TypeScript/Python để provision toàn bộ môi trường cloud. Cách tiếp cận này đảm bảo triển khai nhanh, nhất quán và có thể lặp lại trên nhiều AWS accounts và environments (dev, staging, production).\nTất cả resources như API Gateway, Lambda functions, DynamoDB tables, S3 buckets, Cognito user pools, Bedrock integration policies và CloudFront distributions sẽ được tự động hóa hoàn toàn qua IaC.\nQuy trình build và deployment ứng dụng cho frontend (Next.js) sẽ được tự động hóa sử dụng AWS Amplify Hosting, tích hợp với GitLab pipelines. Các thành phần backend sẽ được triển khai thông qua CDK pipelines để đảm bảo releases được kiểm soát, versioned và có thể lặp lại.\n2.3 Kế hoạch Dự án Đối tác sẽ áp dụng Agile Scrum framework qua tám sprint 2 tuần. Các stakeholders từ team được yêu cầu tham gia Sprint Reviews và Sprint Retrospectives để đảm bảo alignment và cải tiến liên tục.\nTrách nhiệm team đề xuất:\nProduct Owner: Định nghĩa user stories, ưu tiên backlog và đảm bảo sản phẩm đáp ứng nhu cầu người dùng Scrum Master: Điều phối Scrum ceremonies, loại bỏ blockers và duy trì năng suất team Development Team: Triển khai features, thực hiện unit testing và cộng tác integration AI/ML Specialist: Phát triển và tinh chỉnh AI recommendation engine gợi ý công thức dựa trên nguyên liệu do người dùng cung cấp UI/UX Designer: Thiết kế giao diện trực quan và đảm bảo trải nghiệm người dùng mượt mà trên cả web và mobile platforms QA/Testers: Xác nhận chức năng feature, thực hiện regression testing và đảm bảo độ tin cậy hệ thống Nhịp độ giao tiếp:\nDaily Stand-ups: Họp 15 phút cho cập nhật tiến độ và blockers ngay lập tức Sprint Planning: Vào đầu mỗi sprint để ưu tiên tasks Sprint Review: Vào cuối mỗi sprint để showcase các features hoàn thành cho stakeholders Sprint Retrospective: Sau mỗi sprint review để xác định cải tiến cho sprint tiếp theo 2.4 Cân nhắc Bảo mật Đối tác sẽ triển khai các phương pháp bảo mật tốt nhất trên năm danh mục sau để đảm bảo tính bảo mật, toàn vẹn và khả dụng của nền tảng:\n1. Access\nBật Multi-Factor Authentication (MFA) cho tất cả tài khoản người dùng và quản trị Triển khai role-based access control (RBAC) để giới hạn quyền dựa trên vai trò người dùng Thực thi chính sách mật khẩu mạnh và rotation định kỳ 2. Infrastructure\nTriển khai ứng dụng trên các dịch vụ cloud được quản lý, an toàn theo các phương pháp bảo mật tốt nhất của AWS Sử dụng Virtual Private Cloud (VPC), network segmentation và security groups để cô lập resources Patch thường xuyên operating systems và containerized services để giảm thiểu vulnerabilities 3. Data\nMã hóa tất cả dữ liệu at rest sử dụng AWS KMS-managed keys và dữ liệu in transit sử dụng TLS/HTTPS Triển khai data classification để bảo vệ thông tin người dùng nhạy cảm Áp dụng quy trình lưu trữ và backup dữ liệu an toàn 4. Detection\nBật AWS CloudTrail và AWS Config để giám sát API activity và resource configurations Triển khai cơ chế logging và alerting để phát hiện các hoạt động bất thường hoặc đáng ngờ theo thời gian thực Thực hiện vulnerability scanning và penetration testing định kỳ trên nền tảng 5. Incident Management\nThiết lập kế hoạch incident response chính thức bao gồm detection, containment, remediation và communication Duy trì audit trails và logs để hỗ trợ forensic investigation nếu xảy ra sự kiện bảo mật 3. HOẠT ĐỘNG VÀ SẢN PHẨM BÀN GIAO 3.1 Hoạt động và sản phẩm bàn giao Giai đoạn Dự án Timeline Hoạt động Sản phẩm/Milestones Thời gian Infrastructure Setup Tuần 1-2 Học tất cả dịch vụ AWS, Thực hành Lab Worklog 2 tuần Project Foundation Tuần 3 Initialize monorepo, setup môi trường dev, Git/CI/CD, CDK project Git repository, CDK project, environment configs 1 tuần DNS Infrastructure Tuần 4-5 Route 53 setup, ACM certificates, DNS validation Hosted Zone, SSL certificates, DNS stack 2 tuần Core Stack Tuần 6-7 DynamoDB, S3, CloudFront, OpenSearch setup Core infrastructure, storage, CDN 2 tuần Authentication Stack Tuần 8 Cognito User Pool, SES integration, Lambda triggers User authentication system 1 tuần Backend Stack Tuần 9-10 API Gateway, Lambda functions, routing logic REST API, backend services 2 tuần 3.2 NGOÀI PHẠM VI Hệ thống Messaging / Chat thời gian thực\nPrivate hoặc group chat Hạ tầng messaging thời gian thực (WebSocket, SignalR, Firebase Realtime DB, etc.) Lưu trữ \u0026amp; mã hóa lịch sử tin nhắn Quản lý Friends / Social Graph\nFriend requests, following/followers User-to-user connection graph Activity feed, notifications liên quan đến friend actions Voice \u0026amp; Video Calling thời gian thực\n1-to-1 hoặc group voice call Video call, screen sharing WebRTC signaling servers \u0026amp; TURN/STUN infrastructure Advanced Social Interaction\nIn-app messaging reactions Typing indicators, online/offline status Read receipts, presence tracking 3.3 LỘ TRÌNH ĐƯA VÀO SẢN XUẤT 1. Project Foundation \u0026amp; Infrastructure\nInitialize project structure Set up core infrastructure baseline Configure Route 53 Hosted Zone (DNS Stack) 2. Cross-Region Certificate\nHandle CloudFront requirement cho ACM certificate ở us-east-1 Sync certificate usage với main stack ở ap-southeast-1 3. Core Application Stacks\nCore Stack: Shared resources / environment setup Authentication Stack: User auth, Cognito, permissions Backend Stack: API Gateway + Lambda functions 4. Frontend Deployment\nDeploy frontend (S3 + CloudFront) Bug fixes \u0026amp; QA testing 4. DỰ TOÁN CHI PHÍ AWS THEO DỊCH VỤ Target workload: 100-500 Monthly Active Users (MAU)\nDịch vụ Chi phí hàng tháng (USD) Mô tả Amazon DynamoDB $13.06 Single-table design, 5 GSIs, provisioned capacity Amazon S3 $0.84 2 buckets, Intelligent-Tiering Amazon CloudFront $1.44 CDN, Price Class 200 Amazon Cognito $0.00 Free Tier (\u0026lt; 50K MAU) AWS Lambda $0.20 1M requests/month (Free Tier) Amazon SES $0.10 Email sending API Gateway $14.60 With caching (0.5GB) Amazon Bedrock $5.00 Claude 3 Haiku (on-demand) Tổng ~$35.24/tháng Nằm trong ngân sách $200 📊 AWS Pricing Calculator\n5. NHÓM DỰ ÁN Partner Executive Sponsor\nTên Chức danh Mô tả Liên hệ Nguyen Gia Hung Director of FCJ Vietnam Training Program Executive Sponsor chịu trách nhiệm giám sát tổng thể chương trình thực tập FCJ hunggia@amazon.com Project Stakeholders\nTên Chức danh Vai trò Liên hệ Van Hoang Kha Support Teams Executive Assistant chịu trách nhiệm giám sát tổng thể chương trình thực tập FCJ Khab9thd@gmail.com Partner Project Team\nTên Vai trò Trách nhiệm Liên hệ Pham Minh Hoang Viet Leader Project Manager vietpmhse181851@gmail.com Nguyen Van Truong Member DevOps truongnvse182034@fpt.edu.vn Huynh Duc Anh Member Cloud Engineer anhhdse183114@fpt.edu.vn Nguyen Thanh Hong Member Tester hongntse183239@fpt.edu.vn Nguyen Quy Duc Member Frontend ducnqse182087@fpt.edu.vn 6. NGUỒN LỰC \u0026amp; ƯỚC TÍNH CHI PHÍ Nguồn lực Trách nhiệm Rate (USD)/Giờ Solution Architects [1] Architecture design, AWS service selection, security review, cost optimization $150 Engineers [2] Frontend (Next.js), Backend (Lambda/Node.js), Infrastructure (CDK), Testing $100 DevOps [1] CI/CD setup, monitoring, deployment automation $80 Giai đoạn Dự án Architects Engineers DevOps Tổng Giờ Discovery \u0026amp; Requirements 16 24 8 48 Architecture Design 40 16 8 64 Development 16 200 40 256 Testing \u0026amp; QA 8 40 16 64 Deployment \u0026amp; Go-Live 8 24 24 56 Documentation \u0026amp; Training 8 16 8 32 Tổng Giờ 96 320 104 520 Tổng Chi phí $14,400 $32,000 $8,320 $54,720 7. CHẤP THUẬN Vì dự án này hiện đang ở giai đoạn trình bày và chưa được khách hàng đánh giá chính thức, nên quy trình chấp nhận sau đây được đề xuất cho các giai đoạn phân phối trong tương lai:\n7.1 Tiêu chí Chấp nhận (Đề xuất) Một sản phẩm sẽ được coi là chấp nhận được khi đáp ứng các tiêu chí sau:\nCác tính năng chức năng hoạt động theo đúng quy định (xác thực, quản lý công thức, tính năng xã hội, chức năng AI).\nTất cả các API đều phản hồi chính xác và tích hợp với các dịch vụ AWS (Lambda, API Gateway, DynamoDB, S3).\nĐáp ứng các yêu cầu bảo mật (xác minh JWT, HTTPS, kiểm soát truy cập, mã hóa dữ liệu).\nGiao diện người dùng hoạt động như mong đợi trên các thiết bị được hỗ trợ.\nKhông xuất hiện lỗi nghiêm trọng nào trong quá trình thực hiện kiểm thử.\n7.2 Quy trình Chấp nhận Thời gian xem xét: 8 ngày làm việc để đánh giá và kiểm thử.\nNếu được chấp nhận → Sản phẩm được ký duyệt.\nNếu phát hiện vấn đề → Chúng tôi sẽ gửi thông báo từ chối kèm theo phản hồi.\n"
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/5-workshop/5.04-configure-stacks/5.4.2-certificate-stack/",
	"title": "5.4.2 Certificate Stack",
	"tags": [],
	"description": "",
	"content": " Certificate Stack - Chứng Chỉ ACM cho SSL/TLS Tổng Quan Certificate Stack là tầng hạ tầng Phase 1.5 của dự án EveryoneCook. Nó quản lý các chứng chỉ AWS Certificate Manager (ACM) cho CloudFront CDN và API Gateway, cung cấp mã hóa SSL/TLS cho mọi lưu lượng HTTPS.\nThứ Tự Triển Khai: Stack này BẮT BUỘC phải được triển khai sau DNS Stack và trước Core Stack và Backend Stack.\nYêu Cầu Region Quan Trọng: Stack này BẮT BUỘC phải được triển khai ở region us-east-1 vì CloudFront là dịch vụ toàn cầu chỉ có thể truy cập chứng chỉ ACM từ us-east-1.\nTrách Nhiệm Chính Tạo chứng chỉ ACM cho CloudFront CDN (cdn.everyonecook.cloud hoặc cdn-dev.everyonecook.cloud) Tạo chứng chỉ ACM wildcard cho API Gateway (*.everyonecook.cloud) Xác thực DNS tự động qua Route 53 Export các Certificate ARN cho Core Stack và Backend Stack Những Gì Stack Này KHÔNG Bao Gồm DNS records (được quản lý bởi DNS Stack - Phase 1) CloudFront distribution (được quản lý bởi Core Stack - Phase 2) API Gateway custom domain (được quản lý bởi Backend Stack - Phase 4) CloudFront WAF Web ACL (đã loại bỏ để tối ưu chi phí) Kiến Trúc ┌─────────────────────────────────────────────────────────────────┐\r│ Route 53 Hosted Zone │\r│ everyonecook.cloud │\r│ (từ DNS Stack) │\r└───────────────────┬─────────────────────────────────────────────┘\r│ DNS Validation\r▼\r┌─────────────────────────────────────────────────────────────────┐\r│ AWS Certificate Manager (us-east-1) │\r│ │\r│ Certificate 1: CloudFront Certificate │\r│ ├─ Domain: cdn.everyonecook.cloud (hoặc cdn-dev) │\r│ ├─ Validation: DNS (Route 53) │\r│ ├─ Status: Issued (5-10 phút) │\r│ └─ Export: CloudFrontCertificateArn │\r│ │\r│ Certificate 2: API Gateway Wildcard Certificate │\r│ ├─ Domain: *.everyonecook.cloud │\r│ ├─ SAN: everyonecook.cloud │\r│ ├─ Bao gồm: api.everyonecook.cloud, api-dev, api-staging │\r│ ├─ Validation: DNS (Route 53) │\r│ ├─ Status: Issued (5-10 phút) │\r│ └─ Export: ApiGatewayCertificateArn │\r│ │\r│ Tối ưu chi phí: │\r│ CloudFront WAF đã loại bỏ (-$9/tháng) │\r│ Shield Standard (miễn phí, tự động bật) │\r└─────────────────────────────────────────────────────────────────┘\r│\r│ Certificate ARN Exports\r▼\r┌───────────────────────┬\r▼ ▼ Core Stack Backend Stack (CloudFront) (API Gateway) Cấu Hình Stack Cấu Trúc File infrastructure/lib/stacks/\r└── certificate-stack.ts # Certificate Stack implementation Triển Khai Code File: infrastructure/lib/stacks/certificate-stack.ts\nimport * as cdk from \u0026#39;aws-cdk-lib\u0026#39;; import * as acm from \u0026#39;aws-cdk-lib/aws-certificatemanager\u0026#39;; import * as route53 from \u0026#39;aws-cdk-lib/aws-route53\u0026#39;; import { Construct } from \u0026#39;constructs\u0026#39;; import { BaseStack, BaseStackProps } from \u0026#39;../base-stack\u0026#39;; /** * Certificate Stack cho CloudFront và API Gateway * * Stack này tạo các chứng chỉ ACM cho CloudFront và API Gateway. * * YÊU CẦU REGION QUAN TRỌNG: * - CloudFront certificate: BẮT BUỘC ở us-east-1 (yêu cầu của CloudFront) * - API Gateway certificate: Nên ở cùng region với API Gateway (ap-southeast-1) * * Stack này được triển khai ở us-east-1 để xử lý yêu cầu cross-region của CloudFront. * Với API Gateway, chúng ta sử dụng wildcard certificate bao phủ api.everyonecook.cloud. * * Trách nhiệm: * - Tạo chứng chỉ ACM cho CloudFront ở us-east-1 * - Tạo chứng chỉ ACM wildcard cho API Gateway ở us-east-1 (hoạt động toàn cầu) * - Xác thực chứng chỉ qua Route 53 DNS * - Export các certificate ARN để Core Stack và Backend Stack sử dụng * * LƯU Ý TỐI ƯU CHI PHÍ: * - CloudFront WAF đã loại bỏ để tiết kiệm $9/tháng ($108/năm) * - CloudFront vẫn được bảo vệ bởi Shield Standard (miễn phí, tự động bật) * - API Gateway có đầy đủ bảo vệ WAF (BackendStack) */ export class CertificateStack extends BaseStack { public readonly cloudFrontCertificate: acm.ICertificate; public readonly apiGatewayCertificate: acm.ICertificate; constructor(scope: Construct, id: string, props: BaseStackProps) { super(scope, id, props); // Thêm các tag đặc thù cho stack cdk.Tags.of(this).add(\u0026#39;StackType\u0026#39;, \u0026#39;Certificate\u0026#39;); cdk.Tags.of(this).add(\u0026#39;Layer\u0026#39;, \u0026#39;Infrastructure\u0026#39;); cdk.Tags.of(this).add(\u0026#39;CostCenter\u0026#39;, `Certificate-${this.config.environment}`); // Import Route 53 Hosted Zone từ DNS Stack // Lưu ý: Không thể sử dụng Fn.importValue hoặc SSM Parameter cho cross-region references // Hosted Zone ID là ổn định và không thay đổi, nên chúng ta hardcode nó // Giá trị này đến từ DNS Stack output: Z018823421GWCSYG5UMHV const hostedZoneId = \u0026#39;Z018823421GWCSYG5UMHV\u0026#39;; const hostedZone = route53.HostedZone.fromHostedZoneAttributes(this, \u0026#39;HostedZone\u0026#39;, { hostedZoneId: hostedZoneId, zoneName: \u0026#39;everyonecook.cloud\u0026#39;, }); // Tạo chứng chỉ ACM cho CloudFront // Chứng chỉ này BẮT BUỘC ở us-east-1 để CloudFront sử dụng this.cloudFrontCertificate = this.createCloudFrontCertificate(hostedZone); // Tạo chứng chỉ ACM wildcard cho API Gateway // Wildcard *.everyonecook.cloud bao phủ api.everyonecook.cloud // Chứng chỉ này ở us-east-1 có thể được sử dụng bởi API Gateway ở bất kỳ region nào this.apiGatewayCertificate = this.createApiGatewayCertificate(hostedZone); // TỐI ƯU CHI PHÍ: CloudFront WAF đã loại bỏ // CloudFront được bảo vệ bởi Shield Standard (miễn phí, tự động bật) // API Gateway có đầy đủ bảo vệ WAF trong BackendStack // Tiết kiệm: $9/tháng ($108/năm) // Export các certificate ARN this.exportOutputs(); } /** * Tạo chứng chỉ ACM cho CloudFront CDN * * QUAN TRỌNG: Stack này BẮT BUỘC phải được triển khai ở region us-east-1. * CloudFront là dịch vụ toàn cầu nhưng control plane của nó ở us-east-1, * nên nó chỉ có thể truy cập chứng chỉ từ us-east-1. * * Xác thực DNS là tự động qua Route 53. * Xác thực thường mất 5-10 phút. * * @param hostedZone - Route 53 Hosted Zone cho DNS validation * @returns ACM Certificate cho CloudFront */ private createCloudFrontCertificate(hostedZone: route53.IHostedZone): acm.Certificate { const certificate = new acm.Certificate(this, \u0026#39;CloudFrontCertificate\u0026#39;, { domainName: this.config.domains.cdn, validation: acm.CertificateValidation.fromDns(hostedZone), certificateName: `EveryoneCook-CloudFront-${this.config.environment}`, }); // Thêm tags cdk.Tags.of(certificate).add(\u0026#39;Component\u0026#39;, \u0026#39;CloudFront\u0026#39;); cdk.Tags.of(certificate).add(\u0026#39;Purpose\u0026#39;, \u0026#39;CDN-SSL\u0026#39;); return certificate; } /** * Tạo chứng chỉ ACM wildcard cho API Gateway * * Tạo wildcard certificate (*.everyonecook.cloud) bao phủ: * - api.everyonecook.cloud (API Gateway) * - api-dev.everyonecook.cloud (API Gateway dev) * - api-staging.everyonecook.cloud (API Gateway staging) * * Chứng chỉ này được tạo ở us-east-1 nhưng có thể được sử dụng bởi API Gateway * ở bất kỳ region nào qua cross-region certificate reference. * * Xác thực DNS là tự động qua Route 53. * Xác thực thường mất 5-10 phút. * * @param hostedZone - Route 53 Hosted Zone cho DNS validation * @returns ACM Certificate cho API Gateway */ private createApiGatewayCertificate(hostedZone: route53.IHostedZone): acm.Certificate { const certificate = new acm.Certificate(this, \u0026#39;ApiGatewayCertificate\u0026#39;, { domainName: \u0026#39;*.everyonecook.cloud\u0026#39;, // Wildcard bao phủ api.everyonecook.cloud subjectAlternativeNames: [\u0026#39;everyonecook.cloud\u0026#39;], // Cũng bao phủ root domain validation: acm.CertificateValidation.fromDns(hostedZone), certificateName: `EveryoneCook-API-${this.config.environment}`, }); // Thêm tags cdk.Tags.of(certificate).add(\u0026#39;Component\u0026#39;, \u0026#39;APIGateway\u0026#39;); cdk.Tags.of(certificate).add(\u0026#39;Purpose\u0026#39;, \u0026#39;API-SSL\u0026#39;); return certificate; } /** * Export stack outputs cho cross-stack references * * Exports: * - CloudFrontCertificateArn: ACM Certificate ARN cho CloudFront (us-east-1) * - ApiGatewayCertificateArn: ACM Certificate ARN cho API Gateway (us-east-1) * * ĐÃ LOẠI BỎ: CloudFrontWebAclArn (tối ưu chi phí) */ private exportOutputs(): void { // Export CloudFront certificate ARN cho Core Stack new cdk.CfnOutput(this, \u0026#39;CloudFrontCertificateArn\u0026#39;, { value: this.cloudFrontCertificate.certificateArn, exportName: this.exportName(\u0026#39;CloudFrontCertificateArn\u0026#39;), description: \u0026#39;ACM Certificate ARN cho CloudFront (us-east-1)\u0026#39;, }); // Export CloudFront certificate domain để xác minh new cdk.CfnOutput(this, \u0026#39;CloudFrontCertificateDomain\u0026#39;, { value: this.config.domains.cdn, description: \u0026#39;Domain name cho CloudFront certificate\u0026#39;, }); // Export API Gateway certificate ARN cho Backend Stack new cdk.CfnOutput(this, \u0026#39;ApiGatewayCertificateArn\u0026#39;, { value: this.apiGatewayCertificate.certificateArn, exportName: this.exportName(\u0026#39;ApiGatewayCertificateArn\u0026#39;), description: \u0026#39;ACM Wildcard Certificate ARN cho API Gateway (us-east-1)\u0026#39;, }); // Export API Gateway certificate domain để xác minh new cdk.CfnOutput(this, \u0026#39;ApiGatewayCertificateDomain\u0026#39;, { value: \u0026#39;*.everyonecook.cloud\u0026#39;, description: \u0026#39;Domain name cho API Gateway certificate (wildcard)\u0026#39;, }); } } Chi Tiết Cấu Hình Chính 1. Yêu Cầu Region Quan Trọng: Stack này BẮT BUỘC phải được triển khai ở us-east-1:\n// Trong infrastructure/bin/app.ts const certificateStack = new CertificateStack(app, `${stackPrefix}-Certificate`, { env: { account: config.account, region: \u0026#39;us-east-1\u0026#39;, // BẮT BUỘC là us-east-1 cho CloudFront }, config, description: `ACM Certificate cho CloudFront (${config.environment}) - us-east-1`, }); Tại sao us-east-1?\nCloudFront là dịch vụ toàn cầu với control plane ở us-east-1 CloudFront chỉ có thể truy cập chứng chỉ ACM từ us-east-1 API Gateway wildcard certificate ở us-east-1 hoạt động toàn cầu 2. Certificate Domains Stack tạo hai chứng chỉ với domain theo environment:\nCloudFront Certificate:\n// Dev environment domainName: \u0026#39;cdn-dev.everyonecook.cloud\u0026#39; // Staging environment domainName: \u0026#39;cdn-staging.everyonecook.cloud\u0026#39; // Production environment domainName: \u0026#39;cdn.everyonecook.cloud\u0026#39; API Gateway Wildcard Certificate:\ndomainName: \u0026#39;*.everyonecook.cloud\u0026#39; // Bao phủ tất cả subdomain subjectAlternativeNames: [\u0026#39;everyonecook.cloud\u0026#39;] // Cũng bao phủ root domain // Bao phủ: // - api.everyonecook.cloud // - api-dev.everyonecook.cloud // - api-staging.everyonecook.cloud // - Bất kỳ *.everyonecook.cloud subdomain nào trong tương lai 3. Xác Thực DNS Tự Động ACM tự động tạo DNS validation records trong Route 53:\nvalidation: acm.CertificateValidation.fromDns(hostedZone) Điều gì xảy ra:\nACM tạo CNAME record trong Route 53 để xác thực Route 53 ngay lập tức phản hồi với validation record ACM xác minh record và cấp chứng chỉ Xác thực hoàn thành trong 5-10 phút (thường nhanh hơn) 4. Cross-Region Certificate Reference Chứng chỉ được tạo ở us-east-1 được sử dụng bởi các stack khác ở ap-southeast-1:\n// Trong Core Stack (ap-southeast-1) - import CloudFront certificate từ us-east-1 const certificate = acm.Certificate.fromCertificateArn( this, \u0026#39;ImportedCloudFrontCertificate\u0026#39;, \u0026#39;arn:aws:acm:us-east-1:616580903213:certificate/8d53776e-0480-47d2-a6ff-4fe9b2eb6534\u0026#39; ); 5. Tối Ưu Chi Phí - Loại Bỏ WAF Quyết định: CloudFront WAF Web ACL đã loại bỏ để tiết kiệm chi phí:\n// ĐÃ LOẠI BỎ: CloudFront WAF Web ACL // Chi phí hàng tháng trước đây: $9/tháng = $108/năm // Tình trạng bảo vệ: // Shield Standard: Bảo vệ DDoS (miễn phí, tự động bật) // CloudFront OAC: Chặn truy cập S3 trực tiếp // Signed URLs: Bảo vệ nội dung riêng tư // ❌ WAF: Đã loại bỏ (tối ưu chi phí) Lý do:\nCloudFront chỉ phục vụ nội dung tĩnh (bề mặt tấn công thấp) Shield Standard cung cấp bảo vệ DDoS Layer 3/4 (miễn phí) API Gateway có đầy đủ bảo vệ WAF cho tấn công Layer 7 Tiết kiệm: $9/tháng = $108/năm Stack Outputs Sau khi triển khai, stack export các giá trị sau:\nOutput Name Value Sử dụng CloudFrontCertificateArn arn:aws:acm:us-east-1:616580903213:certificate/8d53776e-... Được Core Stack sử dụng cho CloudFront distribution CloudFrontCertificateDomain cdn.everyonecook.cloud (hoặc cdn-dev) Chỉ để xác minh ApiGatewayCertificateArn arn:aws:acm:us-east-1:616580903213:certificate/a1b2c3d4-... Được Backend Stack sử dụng cho API Gateway domain ApiGatewayCertificateDomain *.everyonecook.cloud Chỉ để xác minh (wildcard) Các Bước Triển Khai Bước 1: Xác Minh Điều Kiện Tiên Quyết Trước khi triển khai Certificate Stack, hãy đảm bảo:\nDNS Stack đã triển khai thành công Route 53 Hosted Zone tồn tại với nameserver chính xác Ủy quyền DNS từ Hostinger đã hoàn thành và lan truyền Xác minh DNS đang hoạt động:\nnslookup -type=NS everyonecook.cloud Bước 2: Triển Khai Certificate Stack Di chuyển đến thư mục infrastructure:\ncd D:\\Project_AWS\\everyonecook\\infrastructure Triển khai Certificate Stack đến us-east-1:\n# Triển khai Certificate Stack npx cdk deploy EveryoneCook-dev-Certificate --context environment=dev Quan trọng: Lưu ý region là us-east-1, không phải ap-southeast-1.\nKết quả mong đợi:\n✨ Synthesis time: 6.12s\rEveryoneCook-dev-Certificate: deploying...\r[████████████████████████████████████████] (3/3)\rEveryoneCook-dev-Certificate: creating CloudFormation changeset...\rEveryoneCook-dev-Certificate\r✨ Deployment time: 125.34s\rOutputs:\rEveryoneCook-dev-Certificate.CloudFrontCertificateArn = arn:aws:acm:us-east-1:616580903213:certificate/8d53776e-0480-47d2-a6ff-4fe9b2eb6534\rEveryoneCook-dev-Certificate.CloudFrontCertificateDomain = cdn-dev.everyonecook.cloud\rEveryoneCook-dev-Certificate.ApiGatewayCertificateArn = arn:aws:acm:us-east-1:616580903213:certificate/a1b2c3d4-5678-90ef-ghij-klmnopqrstuv\rEveryoneCook-dev-Certificate.ApiGatewayCertificateDomain = *.everyonecook.cloud\rStack ARN:\rarn:aws:cloudformation:us-east-1:616580903213:stack/EveryoneCook-dev-Certificate/... Bước 3: Chờ Xác Thực Certificate Chứng chỉ ACM yêu cầu xác thực DNS. Quá trình này mất 5-10 phút:\nACM tạo CNAME validation records trong Route 53 Route 53 phản hồi với dữ liệu xác thực ACM xác minh và cấp chứng chỉ Trạng thái thay đổi từ \u0026ldquo;Pending validation\u0026rdquo; thành \u0026ldquo;Issued\u0026rdquo; Bạn có thể theo dõi tiến trình xác thực trong AWS Console.\nBước 4: Xác Minh trong AWS Console Điều hướng đến ACM (region us-east-1) Mở AWS Console QUAN TRỌNG: Chuyển region sang N. Virginia (us-east-1) Điều hướng đến Certificate Manager Chuyển AWS Console sang region us-east-1 trước khi xem chứng chỉ\nXác Minh CloudFront Certificate Tìm certificate với domain cdn-dev.everyonecook.cloud Kiểm tra trạng thái là Issued Xác minh DNS validation records đã có mặt Chứng chỉ ACM cho CloudFront hiển thị trạng thái \u0026ldquo;Issued\u0026rdquo;, tên domain, phương thức xác thực (DNS), và CNAME validation record\nXác Minh API Gateway Wildcard Certificate Tìm certificate với domain *.everyonecook.cloud Kiểm tra trạng thái là Issued Xác minh nó bao phủ wildcard và SAN (everyonecook.cloud) Chứng chỉ ACM Wildcard cho API Gateway hiển thị domain *.everyonecook.cloud, SAN everyonecook.cloud, và validation records\nXác Minh DNS Validation Records trong Route 53 Điều hướng đến Route 53 \u0026gt; Hosted zones Chọn everyonecook.cloud hosted zone Xác minh CNAME validation records đã được tạo Route 53 hiển thị CNAME validation records tự động được tạo bởi ACM để xác thực chứng chỉ\nRecords mong đợi:\n_abc123def456.cdn-dev.everyonecook.cloud CNAME _xyz789.acm-validations.aws.\r_ghi789jkl012.everyonecook.cloud CNAME _mno345.acm-validations.aws. Chi Tiết Chi Phí Chi Phí Hàng Tháng Tài nguyên Chi phí Ghi chú Chứng chỉ ACM $0/tháng Miễn phí cho chứng chỉ sử dụng với dịch vụ AWS DNS Validation Records $0/tháng Bao gồm trong chi phí Route 53 hosted zone Gia hạn chứng chỉ $0/tháng Gia hạn tự động (miễn phí) Tổng $0/tháng 100% miễn phí (không có chi phí liên tục) Tối Ưu Chi Phí Chứng chỉ ACM miễn phí khi sử dụng với CloudFront, API Gateway, ALB, v.v. Gia hạn tự động (không cần can thiệp thủ công) CloudFront WAF đã loại bỏ để tiết kiệm $9/tháng ($108/năm) Shield Standard cung cấp bảo vệ DDoS miễn phí Tiết Kiệm Hàng Năm từ Loại Bỏ WAF: $108/năm\nCross-Stack Dependencies Import từ DNS Stack Certificate Stack import từ DNS Stack:\n// Hardcoded Hosted Zone ID (ổn định, không thay đổi) const hostedZoneId = \u0026#39;Z018823421GWCSYG5UMHV\u0026#39;; const hostedZone = route53.HostedZone.fromHostedZoneAttributes(this, \u0026#39;HostedZone\u0026#39;, { hostedZoneId: hostedZoneId, zoneName: \u0026#39;everyonecook.cloud\u0026#39;, }); Tại sao Hardcoded?\nKhông thể sử dụng Fn.importValue cho cross-region references (us-east-1 ← ap-southeast-1) Hosted Zone ID ổn định và không bao giờ thay đổi Thay thế: Sử dụng SSM Parameter Store (phức tạp hơn, kết quả giống nhau) Export Được Sử Dụng Bởi Các Stack Khác Certificate Stack export được sử dụng bởi:\nCore Stack (Phase 2)\nImport: CloudFrontCertificateArn Mục đích: Gắn chứng chỉ SSL vào CloudFront distribution Region: ap-southeast-1 (cross-region import) Backend Stack (Phase 4)\nImport: ApiGatewayCertificateArn Mục đích: Tạo API Gateway custom domain với SSL Region: ap-southeast-1 (cross-region import) Luồng Dependency DNS Stack (ap-southeast-1)\r│\r├─ Hosted Zone ID: Z018823421GWCSYG5UMHV\r│\r▼\rCertificate Stack (us-east-1) ← BẮT BUỘC là us-east-1\r│\r├─ CloudFront Certificate ARN\r│ └─► Core Stack (ap-southeast-1)\r│\r└─ API Gateway Certificate ARN\r└─► Backend Stack (ap-southeast-1) Danh Sách Kiểm Tra Xác Thực Trước khi tiến hành triển khai Core Stack:\nCertificate Stack đã triển khai đến region us-east-1 Trạng thái CloudFront certificate là Issued Trạng thái API Gateway wildcard certificate là Issued DNS validation CNAME records hiển thị trong Route 53 Certificate ARN đã export trong CloudFormation outputs Region được xác nhận là us-east-1 trong AWS Console Tags được áp dụng chính xác cho tất cả tài nguyên Các Bước Tiếp Theo Sau khi triển khai thành công Certificate Stack:\n➡️ 5.4.3 Core Stack - Tạo DynamoDB, S3, và CloudFront infrastructure\nCore Stack sẽ:\nTạo DynamoDB Single Table với mã hóa Tạo S3 buckets cho nội dung và CDN logs Tạo CloudFront distribution với chứng chỉ SSL Import CloudFrontCertificateArn từ stack này Cấu hình custom domain cdn.everyonecook.cloud Tài Liệu Tham Khảo Mã nguồn: infrastructure/lib/stacks/certificate-stack.ts Base Stack: infrastructure/lib/base-stack.ts Cấu hình App: infrastructure/bin/app.ts Tài liệu AWS: ACM Certificates DNS Validation CloudFront with ACM Cross-Region References: CloudFormation Cross-Region References "
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/5-workshop/5.03-cdk-bootstrap/",
	"title": "CDK Bootstrap",
	"tags": [],
	"description": "",
	"content": "Tổng quan AWS CDK Bootstrap chuẩn bị AWS account của bạn để triển khai các ứng dụng CDK bằng cách tạo các tài nguyên hạ tầng cần thiết. Đây là quy trình thiết lập một lần cho mỗi tổ hợp AWS account/region để thiết lập nền tảng cho tất cả các triển khai CDK.\nCDK Bootstrap tạo gì Quá trình bootstrap cung cấp các tài nguyên AWS sau trong account của bạn:\n1. S3 Bucket (CDK Assets Bucket)\nLưu trữ Lambda function deployment packages Lưu trữ CloudFormation templates Lưu trữ file assets được tham chiếu bởi CDK stacks Mẫu đặt tên: cdk-hnb659fds-assets-{ACCOUNT-ID}-{REGION} Versioning được bật để hỗ trợ rollback 2. CloudFormation Stack (CDKToolkit)\nStack hạ tầng chính chứa tất cả bootstrap resources Tên stack: CDKToolkit Quản lý vòng đời của bootstrap resources 3. IAM Roles\ncdk-hnb659fds-cfn-exec-role: CloudFormation execution role để deploy stacks cdk-hnb659fds-deploy-role: Role được CDK CLI sử dụng trong quá trình deployment cdk-hnb659fds-file-publishing-role: Role để upload assets lên S3 cdk-hnb659fds-lookup-role: Role để đọc environment context 4. SSM Parameters\n/cdk-bootstrap/hnb659fds/version: Lưu trữ số phiên bản bootstrap Sử dụng để kiểm tra tính tương thích Tổng quan Infrastructure Stacks Sau khi bootstrap, dự án của chúng ta sẽ triển khai nhiều CDK stacks được định nghĩa trong D:\\Project_AWS\\everyonecook\\infrastructure\\lib\\stacks:\nauth-stack.ts: Hạ tầng Authentication và authorization (Cognito) backend-stack.ts: Core backend services và Lambda functions certificate-stack.ts: Quản lý SSL/TLS certificates core-stack.ts: Core infrastructure resources dns-stack.ts: Cấu hình Route 53 DNS observability-stack.ts: Monitoring, logging, và observability Các stacks này phụ thuộc vào hạ tầng bootstrap để triển khai thành công.\nHướng dẫn Thực hành: Bootstrap AWS Account của bạn Yêu cầu trước Trước khi bắt đầu thực hành này, đảm bảo bạn có:\nAWS CLI đã cài đặt và cấu hình (xem phần 5.1) AWS CDK CLI đã cài đặt (xem phần 5.2) AWS credentials hợp lệ đã cấu hình IAM user với quyền AdministratorAccess hoặc tương đương Quyền truy cập Terminal/PowerShell vào thư mục dự án Bước 3: Xác minh trên AWS Console Xác nhận tài nguyên trong AWS Management Console.\n3.1. Xác minh CloudFormation Stack\nMở CloudFormation Console Tìm stack tên CDKToolkit Status phải là CREATE_COMPLETE Click vào tab Resources để xem các tài nguyên đã tạo ** Yêu cầu Screenshot:** 3.2. Xác minh S3 Bucket\nMở S3 Console Tìm bucket: cdk-hnb659fds-assets-{ACCOUNT-ID}-us-east-1 Xác minh thuộc tính bucket: Versioning: Enabled ** Yêu cầu Screenshot:** 3.3. Xác minh IAM Roles\nMở IAM Roles Console Tìm kiếm: cdk-hnb659fds Xác minh các roles sau tồn tại: cdk-hnb659fds-cfn-exec-role-{ACCOUNT-ID}-us-east-1 cdk-hnb659fds-deploy-role-{ACCOUNT-ID}-us-east-1 cdk-hnb659fds-file-publishing-role-{ACCOUNT-ID}-us-east-1 cdk-hnb659fds-lookup-role-{ACCOUNT-ID}-us-east-1 Hiểu về Bootstrap Resources Chi tiết S3 Bucket CDK assets bucket đóng vai trò là kho lưu trữ trung tâm cho tất cả deployment artifacts:\nMục đích: Lưu trữ CloudFormation templates, Lambda deployment packages, và static assets Vòng đời: Tồn tại qua các deployments, cho phép khả năng rollback Bảo mật: Mã hóa at rest, bucket policies hạn chế truy cập cho các roles được ủy quyền Đặt tên: Đặt tên xác định dựa trên account ID và region Chi tiết IAM Roles 1. CloudFormation Execution Role (cfn-exec-role)\nĐược CloudFormation sử dụng để create/update/delete stack resources Có quyền rộng để quản lý AWS resources Trust relationship với CloudFormation service 2. Deploy Role (deploy-role)\nĐược CDK CLI sử dụng trong các thao tác cdk deploy Có thể assume CloudFormation execution role Có quyền upload assets và khởi tạo deployments 3. File Publishing Role (file-publishing-role)\nUpload file assets lên S3 bucket 4. Image Publishing Role (image-publishing-role)\nPublish Docker images lên ECR 5. Lookup Role (lookup-role)\nĐọc environment context (VPCs, subnets, etc.) Quyền read-only cho resource lookups Sử dụng trong quá trình synthesis cho context queries Phân tích Chi phí Chi phí Bootstrap Resources Thiết lập Một lần:\nTạo CloudFormation stack: Miễn phí Tạo IAM roles: Miễn phí SSM parameters: Miễn phí Chi phí Hàng tháng Liên tục:\nResource Sử dụng Chi phí (Ước tính) S3 Storage \u0026lt; 1 GB (thông thường) $0.023/GB = ~$0.02/tháng S3 Requests Tối thiểu (GET/PUT) ~$0.01/tháng IAM Roles Không tính phí $0.00 Tổng Chi phí Ước tính: ~$0.03/tháng (không đáng kể)\nLưu ý: Đối với serverless applications, chi phí vẫn tối thiểu vì chúng ta chỉ lưu trữ Lambda deployment packages trong S3.\nChecklist Hoàn thành Thực hành Đảm bảo bạn đã hoàn thành tất cả các bước và chụp screenshots yêu cầu:\nBước 1: Thực thi lệnh bootstrap và thành công - [IMAGE HERE: bootstrap-success.png] Bước 2: Kết quả xác minh CLI - [IMAGE HERE: bootstrap-verification-cli.png] Bước 3.1: CloudFormation console - [IMAGE HERE: cloudformation-cdktoolkit.png] Bước 3.2: S3 bucket console - [IMAGE HERE: s3-bucket-console.png] Bước 3.3: IAM roles console - [IMAGE HERE: iam-roles-console.png] Xác minh trạng thái bootstrap AWS account Lấy AWS account ID của bạn Thực thi lệnh CDK bootstrap Tạo CDKToolkit CloudFormation stack Cung cấp CDK assets S3 bucket Tạo các IAM roles cần thiết cho CDK deployments Xác minh phiên bản bootstrap trong SSM Parameter Store Hiểu mục đích và chi phí của mỗi bootstrap resource Trong thực hành này, bạn đã thành công:\nThực thi lệnh CDK bootstrap cho AWS account của bạn Tạo CDKToolkit CloudFormation stack Cung cấp CDK assets S3 bucket để lưu trữ Lambda packages Tạo các IAM roles cần thiết cho CDK deployments Xác minh tất cả resources qua CLI và AWS Console AWS account của bạn giờ đã sẵn sàng để triển khai các ứng dụng CDK serverless, bao gồm các infrastructure stacks cho dự án EveryoneCook.\nChuẩn bị cho infrastructure deployment "
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/4-eventparticipated/4.3-event3/",
	"title": "Event 3",
	"tags": [],
	"description": "",
	"content": "Báo Cáo Sau Sự Kiện: AWS Cloud Mastery Series #2 — DevOps on AWS Mục đích Sự kiện Củng cố tư duy và văn hóa DevOps. Giới thiệu các dịch vụ AWS hỗ trợ quy trình CI/CD: CodeCommit, CodeBuild, CodeDeploy, CodePipeline. Đào sâu về mô hình Hạ tầng như Mã (IaC) với CloudFormation và AWS CDK. Tìm hiểu các dịch vụ container (ECS, EKS, App Runner) và công cụ quan sát hệ thống (CloudWatch, X-Ray). Nội dung Nổi bật Phiên sáng: CI/CD Pipeline \u0026amp; Infrastructure as Code (08:30 – 12:00) Ôn tập tư duy DevOps, tập trung vào các chỉ số DORA như Deployment Frequency, MTTR. Các thành phần CI/CD: CodeCommit: quản lý mã nguồn và phân tích chiến lược Git (GitFlow vs. trunk-based). CodeBuild: tự động hóa xây dựng và kiểm thử. CodeDeploy: các chiến lược triển khai (Blue/Green, Canary, Rolling). CodePipeline: tự động hóa toàn bộ pipeline. Demo thực hành: chạy thử một pipeline CI/CD hoàn chỉnh. IaC: CloudFormation: template, stack và drift detection. AWS CDK: constructs, reusable patterns và hỗ trợ đa ngôn ngữ. Demo \u0026amp; thảo luận: triển khai với CloudFormation và CDK; phân tích lý do lựa chọn từng công cụ. Phiên chiều: Containers, Observability \u0026amp; Best Practices (13:00 – 17:00) Tổng quan dịch vụ container: Kiến thức nền tảng về Docker. Amazon ECR: lưu trữ image, quét bảo mật và quản lý vòng đời. ECS \u0026amp; EKS: chiến lược triển khai, scaling và orchestration. App Runner: cách triển khai container kiểu PaaS đơn giản. Giám sát \u0026amp; quan sát hệ thống: CloudWatch: metrics, logs, alarms, dashboards. AWS X-Ray: phân tích truy vết trong kiến trúc microservices. Best practices: Feature flags và A/B testing. Quản lý sự cố và viết postmortem hiệu quả. Demo \u0026amp; case study: so sánh các chiến lược triển khai microservices. Kiến thức Rút ra Hiểu rõ hơn về văn hóa DevOps, các chỉ số DORA và tư duy tự động hóa. Nắm được cách tích hợp các dịch vụ AWS Code để tạo thành pipeline CI/CD hoàn chỉnh cùng các chiến lược triển khai nâng cao. Có nền tảng vững chắc về CloudFormation và AWS CDK, hỗ trợ tối ưu template và xây dựng kiến trúc đa stack. Nhận thức tầm quan trọng của quan sát hệ thống toàn diện với CloudWatch và X-Ray để xử lý lỗi và theo dõi hoạt động. Các dịch vụ container (ECS/EKS) mở ra định hướng thiết kế kiến trúc linh hoạt và mở rộng cho các dự án tương lai. Các demo thực tế giúp hiểu rõ hơn quy trình xây dựng CI/CD và IaC trong môi trường thực tế. Trải nghiệm Sự kiện Buổi workshop kéo dài cả ngày nhưng được tổ chức rất logic và thực tiễn, giúp việc tiếp thu kiến thức trở nên dễ dàng. Các phần demo và case study hỗ trợ tốt cho việc áp dụng vào dự án hiện tại. Sự kiện cũng là cơ hội tốt để trao đổi và kết nối với cộng đồng cũng như các chuyên gia trong lĩnh vực Cloud. "
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/1-worklog/1.3-week3/",
	"title": "Nhật ký Tuần 3",
	"tags": [],
	"description": "",
	"content": "Mục tiêu Tuần 3: Triển khai các chiến lược giám sát và quan sát toàn diện sử dụng Amazon CloudWatch (Chỉ số, Nhật ký, Cảnh báo, Bảng điều khiển). Thiết lập kiến trúc DNS Lai để tích hợp mạng tại chỗ với AWS sử dụng Route 53 Resolver và Microsoft Active Directory. Đạt được sự thành thạo trong AWS CLI để quản lý tài nguyên nâng cao (Cơ bản về Hạ tầng dưới dạng Mã) và tự động hóa trên các dịch vụ Lưu trữ, Mạng, Danh tính và Điện toán. Nhiệm vụ cần thực hiện trong tuần này: Ngày Nhiệm vụ Ngày Bắt đầu Ngày Hoàn thành Tài liệu Tham khảo 2 Giám sát \u0026amp; Quan sát (CloudWatch) - Cấu hình Chỉ số CloudWatch: Xem, Biểu thức tìm kiếm, Biểu thức toán học - Phân tích nhật ký với CloudWatch Logs Insights \u0026amp; Bộ lọc Chỉ số - Thiết lập Cảnh báo CloudWatch để giám sát chủ động - Tạo Bảng điều khiển CloudWatch thống nhất - Thực hành: Trực quan hóa hiệu suất EC2 và thiết lập cảnh báo cho mức sử dụng CPU cao. 22/09/2025 22/09/2025 https://000008.awsstudygroup.com/ 3 Kết nối Lai \u0026amp; DNS - Triển khai Microsoft Active Directory (AD) - Cấu hình Cổng Truy cập từ xa (RDGW) để truy cập an toàn - Thiết lập DNS Lai với Route 53 Resolver: + Tạo Điểm cuối Đi ra/Đi vào + Cấu hình Quy tắc Resolver - Kiểm tra phân giải DNS giữa môi trường mô phỏng tại chỗ và AWS. 23/09/2025 23/09/2025 https://000010.awsstudygroup.com/ 4 Làm chủ AWS CLI - Phần 1 (Thiết lập \u0026amp; Lưu trữ) - Cài đặt và Cấu hình AWS CLI v2 - Tự động hóa S3: Quản lý bucket, thực hiện tải lên nhiều phần qua CLI - Nhắn tin: Quản lý chủ đề và đăng ký Amazon SNS qua CLI - Khám phá các định dạng đầu ra CLI (json, table, text) và bộ lọc. 24/09/2025 24/09/2025 https://000011.awsstudygroup.com/ https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-troubleshooting.html 5 Làm chủ AWS CLI - Phần 2 (Điện toán \u0026amp; Mạng) - Bảo mật IAM: Quản lý người dùng, vai trò và giả định vai trò qua CLI + Xử lý mã thông báo MFA với CLI - Hạ tầng Mạng: Triển khai VPC, Subnet và Internet Gateway qua CLI - Điện toán: Khởi chạy và cấu hình phiên bản EC2 hoàn toàn qua dòng lệnh. 25/09/2025 25/09/2025 https://000011.awsstudygroup.com/ Tìm hiểu sâu: Giao diện Dòng lệnh AWS 6 Làm chủ AWS CLI - Phần 3 (Khắc phục sự cố \u0026amp; Dọn dẹp) - Khắc phục sự cố: Chẩn đoán các lỗi CLI phổ biến (thông tin xác thực, quyền, định dạng) - Xác thực Nâng cao: Lưu trữ thông tin xác thực SAML - Thực hiện dọn dẹp tài nguyên đầy đủ bằng các lệnh CLI để đảm bảo không có chi phí kéo dài. 26/09/2025 26/09/2025 https://000011.awsstudygroup.com/ AWS re:Invent 2019: Giới thiệu về AWS CLI v2 Thành tựu Tuần 3 Quan sát \u0026amp; Giám sát Triển khai thành công ngăn xếp giám sát sử dụng Amazon CloudWatch. Tạo Bảng điều khiển tùy chỉnh để trực quan hóa các chỉ số quan trọng (CPU, Bộ nhớ, I/O Đĩa) theo thời gian thực. Cấu hình Cảnh báo CloudWatch để kích hoạt thông báo tự động qua SNS khi vượt ngưỡng. Thành thạo Logs Insights để truy vấn và phân tích dữ liệu nhật ký ứng dụng một cách hiệu quả. Mạng Lai Thiết kế và triển khai giải pháp DNS Lai kết nối môi trường tại chỗ và đám mây. Triển khai Microsoft Active Directory trên AWS và tích hợp với Route 53. Cấu hình Điểm cuối Route 53 Resolver (Đi vào/Đi ra) và Quy tắc Chuyển tiếp để phân giải tên miền trên mạng lai. Xác minh kết nối an toàn bằng Cổng Truy cập từ xa (RDGW). Quản lý Hạ tầng Nâng cao (CLI) Chuyển đổi từ quản lý dựa trên Console sang các hoạt động Giao diện Dòng lệnh (CLI). Tự động hóa việc cung cấp tài nguyên: Lưu trữ: Tạo bucket S3 và quản lý vòng đời/tải lên đối tượng. Bảo mật: Quản lý người dùng IAM, chính sách và thực hành Giả định Vai trò cho quyền truy cập giữa các tài khoản. Mạng: Xây dựng ngăn xếp VPC đầy đủ (VPC, Subnet, IGW, Bảng Định tuyến) bằng các lệnh CLI. Điện toán: Khởi chạy phiên bản EC2 với các tập lệnh user-data qua CLI. Đạt được kỹ năng khắc phục sự cố cho cấu hình CLI, quản lý thông tin xác thực (MFA/SAML) và xử lý lỗi API. "
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/3-blogstranslated/3.3-blog3/",
	"title": "Blog 3: Quản lý Chính sách Tường lửa AWS Tập trung với AlgoSec",
	"tags": [],
	"description": "",
	"content": "Tổng quan: Thách thức của Môi trường Hybrid Khi các doanh nghiệp di chuyển workloads từ on-premise lên AWS, việc duy trì một chính sách bảo mật nhất quán trở thành thách thức lớn. AWS Firewall Manager giúp quản lý tập trung các quy tắc bảo mật trên cloud, nhưng các tổ chức thường gặp khó khăn trong việc đồng bộ hóa các quy tắc này với hạ tầng firewall truyền thống (on-premise).\nGiải pháp mới từ AlgoSec (có sẵn trên AWS Marketplace) tích hợp trực tiếp với AWS Firewall Manager, mang lại khả năng hiển thị (visibility) và quản lý thống nhất cho toàn bộ môi trường Hybrid Cloud.\n1. Giới thiệu AlgoSec Horizon và ACE Giải pháp của AlgoSec bao gồm hai thành phần chính được tích hợp:\nAlgoSec Horizon: Tập trung vào việc hiển thị, ánh xạ ứng dụng và cung cấp ngữ cảnh kinh doanh cho các luồng mạng. AlgoSec Cloud Enterprise (ACE): Quản lý chính sách bảo mật, phân tích rủi ro và tự động hóa thay đổi. Lợi ích khi triển khai qua AWS Marketplace:\nMua sắm đơn giản: Tích hợp trực tiếp vào hóa đơn AWS (Unified billing). Triển khai nhanh: Onboarding được sắp xếp hợp lý để có kết quả ngay lập tức (Time-to-value). Mở rộng: Dễ dàng mở rộng quyền kiểm soát chính sách trên mọi môi trường. 2. Hiển thị Chính sách Firewall Hợp nhất Sau khi đăng nhập vào ACE console, tab AWS Firewall Policies sẽ hiển thị toàn bộ các tường lửa AWS đã triển khai cùng các chính sách liên quan. Người dùng có thể xem chi tiết từng firewall, bao gồm VPC, Availability Zones, và Subnets.\n[Figure 1] Trang chính hiển thị danh sách các Firewall, bộ chính sách (Policy Sets) và các quy tắc (Rules).\nKhả năng hiển thị ngữ cảnh là điểm mạnh của giải pháp. Khi di chuột qua tên một firewall, hệ thống sẽ hiển thị ngay ngữ cảnh VPC và các ứng dụng liên quan.\n[Figure 2] Ngữ cảnh VPC hiển thị khi di chuột qua tên Firewall, giúp người quản trị hiểu ngay vị trí và phạm vi ảnh hưởng.\n3. Phân tích Chi tiết Rule và Ứng dụng Các chính sách AWS Firewall thường bao gồm hai nhóm quy tắc: Stateless (không trạng thái) và Stateful (có trạng thái). AlgoSec cho phép mở rộng (expand) để xem chi tiết từng nhóm quy tắc này.\n[Figure 3] Chế độ xem mở rộng hiển thị chi tiết các nhóm quy tắc Stateless và Stateful bên trong một bộ chính sách.\nQuan trọng hơn, AlgoSec Horizon liên kết các thông tin kỹ thuật này với ngữ cảnh kinh doanh. Người dùng có thể xem sơ đồ ứng dụng (Application Diagram), chủ sở hữu ứng dụng (Application Owners), và trạng thái kết nối từ on-premise lên cloud.\n[Figure 4] Chế độ xem ứng dụng (Application View) hiển thị sơ đồ kết nối, thông tin liên hệ và trạng thái tuân thủ của ứng dụng kinh doanh.\nKết luận Sự kết hợp giữa AWS Firewall Manager và AlgoSec mang lại một \u0026ldquo;tầm nhìn duy nhất\u0026rdquo; (single pane of glass) cho đội ngũ bảo mật. Thay vì quản lý rời rạc, giờ đây họ có thể:\nPhân tích cấu hình AWS giống như firewall truyền thống. Mô phỏng thay đổi (Change simulation) trước khi áp dụng để tránh gián đoạn kinh doanh. Đảm bảo tuân thủ (Compliance) liên tục trên toàn bộ môi trường Hybrid. Tác giả Joseph Hallman\rJoseph is a Product Marketing Manager at AlgoSec with over 20 years of experience in networking and data center markets. He has worked at both startups and global enterprises, bringing expertise in sales, product management, and marketing strategy.\nAmit Gaur\rAmit is a Cloud Infrastructure Architect at AWS, specializing in network architecture design. He helps customers build highly scalable and resilient environments on AWS.\nSrivalsan Mannoor Sudhagar\rSrivalsan is a Sr. Cloud Infrastructure Architect at Amazon Web Services, Professional Services who brings expertise in Cloud Infrastructure and MLOps platforms.\nSaleem Muhammad\rSaleem is a Senior Manager of Product Management in AWS Network \u0026 Application Protection. He is passionate about building solutions that help customers to secure mission critical workloads.\n"
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/3-blogstranslated/",
	"title": "Blog Dịch Sang Tiếng Việt",
	"tags": [],
	"description": "",
	"content": "Blog 1 - AWS được vinh danh là Nhà lãnh đạo trong Báo cáo Magic Quadrant Gartner 2025 cho Dịch vụ Nền tảng Đám mây Chiến lược trong 15 năm liên tiếp Bài viết này nhấn mạnh việc AWS một lần nữa được công nhận là Nhà lãnh đạo (Leader) trong Báo cáo Magic Quadrant Gartner 2025 về Dịch vụ Nền tảng Đám mây Chiến lược, đánh dấu 15 năm liên tiếp dẫn đầu. Bài viết giải thích lý do AWS đạt được danh hiệu này nhờ khả năng thực thi mạnh mẽ, tầm nhìn chiến lược toàn diện, và danh mục dịch vụ đám mây phong phú nhất. Ngoài ra, bài viết cũng đề cập đến việc AWS tiếp tục đầu tư vào AI/ML, phân tích dữ liệu, bảo mật, và hạ tầng toàn cầu để hỗ trợ khách hàng từ doanh nghiệp khởi nghiệp đến tổ chức công xây dựng và đổi mới trên nền tảng đám mây.\nBlog 2 - Mô hình Qwen hiện đã có sẵn trong Amazon Bedrock Bài viết thông báo rằng các mô hình Qwen, được phát triển bởi Alibaba Cloud, hiện đã có sẵn trong Amazon Bedrock, cho phép khách hàng xây dựng và mở rộng các ứng dụng AI sinh (Generative AI) với khả năng xử lý ngôn ngữ tự nhiên (NLP) nâng cao, hỗ trợ đa ngôn ngữ, lý luận mạnh mẽ, và tích hợp liền mạch với các dịch vụ AWS — tất cả mà không cần quản lý hạ tầng.\nBlog 3 - Quản lý Chính sách Tường lửa AWS Tập trung với AlgoSec Bài viết này giới thiệu giải pháp từ AlgoSec (có sẵn trên AWS Marketplace) tích hợp với AWS Firewall Manager để cung cấp khả năng quản lý và hiển thị thống nhất trên môi trường Hybrid Cloud. Giải pháp kết hợp AlgoSec Horizon (tập trung vào khả năng hiển thị và ánh xạ ứng dụng) và AlgoSec Cloud Enterprise (ACE) (quản lý chính sách bảo mật và phân tích rủi ro). Các lợi ích chính bao gồm khả năng hiển thị chính sách tường lửa tập trung trên cả AWS và hạ tầng on-premise, ánh xạ ứng dụng kinh doanh theo ngữ cảnh, phân tích chi tiết các rule groups Stateless và Stateful, và khả năng mô phỏng thay đổi trước khi áp dụng để tránh gián đoạn kinh doanh—mang đến cho đội ngũ bảo mật một \u0026ldquo;bảng điều khiển duy nhất\u0026rdquo; để quản trị tường lửa toàn diện.\nBlog 4 - Hướng dẫn cốt lõi về Quản trị Đám mây tại AWS re:Invent 2025 Bài viết này giới thiệu tổng quan về chủ đề Cloud Governance trong sự kiện AWS re:Invent 2025, thể hiện cách quản trị đám mây đang chuyển từ nghĩa vụ tuân thủ sang động lực chiến lược cho đổi mới kinh doanh. Bài viết tập trung vào bốn chủ đề chính gồm AI sinh và quản trị thông minh, hiệu quả vận hành và tối ưu chi phí, bảo mật và tự động hóa, và đa đám mây cùng chủ quyền dữ liệu. Ngoài ra, bài viết cũng giới thiệu các phiên học quan trọng về policy-as-code, tự động hóa tuân thủ bằng AI, và chiến lược quản trị toàn cầu, giúp tổ chức nâng cao năng lực quản trị hiện đại, mở rộng và tự động hóa trên môi trường đám mây phức tạp.\nBlog 5 - Chiến lược Mua sắm Theo Giải pháp trên AWS Marketplace Bài viết này công bố sự chuyển đổi chiến lược của AWS Marketplace sang mua sắm theo giải pháp (solution-centric procurement), giới thiệu Multi-product solutions cho phép các Đối tác đóng gói phần mềm, dịch vụ và dữ liệu từ nhiều nhà cung cấp thành một gói giải pháp toàn diện. Sự chuyển đổi này giúp doanh nghiệp mua các kết quả kinh doanh hoàn chỉnh (như giải pháp Trung tâm Vận hành Bảo mật đầy đủ) thay vì phải mua từng công cụ riêng lẻ. Lợi ích chính bao gồm điểm đàm phán duy nhất, tùy chỉnh linh hoạt từng thành phần, quản trị tập trung và quy trình mua sắm đơn giản hóa. Tính năng này hỗ trợ ISV, Channel Partners và System Integrators tạo các gói sản phẩm kết hợp, trong khi tìm kiếm được tăng cường bằng Generative AI giúp khách hàng khám phá giải pháp dựa trên use case và ngành công nghiệp thay vì chỉ tên sản phẩm.\nBlog 6 - 10 Công bố Hàng đầu về AWS Cloud Operations 2025 Bài viết này tổng hợp 10 công bố quan trọng nhất về AWS Cloud Operations tại re:Invent 2025, tập trung vào việc ứng dụng Generative AI để cải thiện quan sát và xử lý sự cố, đồng thời đơn giản hóa quản lý dữ liệu vận hành quy mô lớn. Các tính năng nổi bật bao gồm quan sát Generative AI trên CloudWatch, phân tích nguyên nhân gốc rễ tự động (5 Whys), tích hợp GitHub Actions, tập trung hóa log và database đa tài khoản/đa vùng, Real User Monitoring cho Mobile, và CloudTrail Event Aggregation. Những cải tiến này giúp người vận hành chuyển từ trạng thái bị động sang chủ động kiểm soát hệ thống bằng AI và tự động hóa.\n"
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/5-workshop/5.04-configure-stacks/5.4.3-core-stack/",
	"title": "5.4.3 Core Stack",
	"tags": [],
	"description": "",
	"content": " Core Stack - Hạ Tầng Data Layer Tổng Quan Core Stack là tầng nền tảng dữ liệu Phase 2 của dự án EveryoneCook. Nó tạo ra hạ tầng cốt lõi cho lưu trữ dữ liệu, phân phối nội dung và mã hóa mà tất cả các dịch vụ khác phụ thuộc vào.\nThứ Tự Triển Khai: Stack này BẮT BUỘC phải được triển khai sau Certificate Stack và trước Auth Stack và Backend Stack.\nTrách Nhiệm Chính Tạo DynamoDB Single Table với 5 GSI indexes cho truy vấn dựa trên username Tạo S3 buckets với Intelligent-Tiering để tối ưu chi phí (tiết kiệm 57%) Tạo CloudFront CDN distribution với nén và caching Tạo KMS encryption keys cho DynamoDB và S3 Cấu hình Origin Access Control (OAC) cho bảo mật S3 Thiết lập custom domain với chứng chỉ SSL cho CDN Những Gì Stack Này Bao Gồm Storage:\nDynamoDB Single Table với mã hóa at rest S3 Content Bucket (avatars, posts, recipes, backgrounds) S3 CDN Logs Bucket cho CloudFront access logs CDN \u0026amp; Caching:\nCloudFront Distribution với custom domain Compression được bật (Gzip + Brotli, giảm 70-80% kích thước) Cache policies (24h mặc định, tối đa 7 ngày) Origin Access Control (OAC) cho bảo mật S3 Security:\nKMS Customer Managed Keys cho mã hóa Automatic key rotation (hàng năm) Security headers (HSTS, X-Frame-Options, v.v.) Tối Ưu Chi Phí:\nS3 Intelligent-Tiering (giảm 57% chi phí) CloudFront Price Class 200 (giảm 45% chi phí) Pay-per-request billing cho dev environment Kiến Trúc ┌─────────────────────────────────────────────────────────────────┐\r│ Core Stack (Phase 2) │\r│ │\r│ ┌──────────────────────────────────────────────────────────┐ │\r│ │ KMS Encryption Layer │ │\r│ │ ├─ DynamoDB Key (automatic rotation) │ │\r│ │ └─ S3 Key (automatic rotation) │ │\r│ └──────────────────────────────────────────────────────────┘ │\r│ │ │\r│ ▼ │\r│ ┌──────────────────────────────────────────────────────────┐ │\r│ │ DynamoDB Single Table │ │\r│ │ ├─ PK: USER#{username} │ │\r│ │ ├─ SK: PROFILE|RECIPE#{id}|POST#{id} │ │\r│ │ ├─ 5 GSI indexes cho truy vấn │ │\r│ │ ├─ Billing: PAY_PER_REQUEST (dev) │ │\r│ │ ├─ Encryption: Customer Managed KMS │ │\r│ │ └─ Streams: Enabled (NEW_AND_OLD_IMAGES) │ │\r│ └──────────────────────────────────────────────────────────┘ │\r│ │ │\r│ ▼ │\r│ ┌──────────────────────────────────────────────────────────┐ │\r│ │ S3 Content Bucket │ │\r│ │ ├─ Folders: avatars/, posts/, recipes/, backgrounds/ │ │\r│ │ ├─ Intelligent-Tiering (tiết kiệm 57%) │ │\r│ │ │ └─ Archive: 90 ngày, Deep Archive: 180 ngày │ │\r│ │ ├─ Encryption: S3 Managed Keys │ │\r│ │ ├─ Versioning: Enabled (prod) │ │\r│ │ ├─ CORS: Cấu hình cho frontend │ │\r│ │ └─ OAC: Chỉ CloudFront access │ │\r│ └──────────────────────────────────────────────────────────┘ │\r│ │ │\r│ ▼ │\r│ ┌──────────────────────────────────────────────────────────┐ │\r│ │ CloudFront CDN Distribution │ │\r│ │ ├─ Custom Domain: cdn.everyonecook.cloud │ │\r│ │ ├─ Certificate: ACM (us-east-1) │ │\r│ │ ├─ Compression: Gzip + Brotli (giảm 70-80%) │ │\r│ │ ├─ Cache TTL: 24h mặc định, tối đa 7 ngày │ │\r│ │ ├─ Price Class: 200 (US, EU, Asia - tiết kiệm 45%) │ │\r│ │ ├─ Security: HTTPS redirect, Security headers │ │\r│ │ ├─ Protection: Shield Standard (DDoS miễn phí) │ │\r│ │ └─ Logs: S3 CDN Logs Bucket │ │\r│ └──────────────────────────────────────────────────────────┘ │\r│ │ │\r│ ▼ │\r│ ┌──────────────────────────────────────────────────────────┐ │\r│ │ Route 53 DNS Record (từ DNS Stack) │ │\r│ │ cdn.everyonecook.cloud → CloudFront (A + AAAA Alias) │ │\r│ └──────────────────────────────────────────────────────────┘ │\r└─────────────────────────────────────────────────────────────────┘\r│\r│ Exports\r▼\r┌─────────────────┴────────────────┐\r▼ ▼\rAuth Stack Backend Stack\r(Cognito) (API Gateway, Lambda) Cấu Hình Stack Cấu Trúc File infrastructure/lib/stacks/\r└── core-stack.ts # Core Stack implementation (1545 dòng) Điểm Nổi Bật Trong Triển Khai Code File: infrastructure/lib/stacks/core-stack.ts\n1. Tạo KMS Keys /** * Tạo KMS key cho DynamoDB encryption */ private createDynamoDBKey(): cdk.aws_kms.Key { const key = new cdk.aws_kms.Key(this, \u0026#39;DynamoDBKey\u0026#39;, { alias: `everyonecook-dynamodb-${this.config.environment}`, description: `KMS key cho DynamoDB encryption trong ${this.config.environment} environment`, // Bật automatic key rotation (hàng năm) enableKeyRotation: true, // Deletion protection cho production pendingWindow: this.config.environment === \u0026#39;prod\u0026#39; ? cdk.Duration.days(30) : cdk.Duration.days(7), // Removal policy: RETAIN cho prod, DESTROY cho dev/staging removalPolicy: this.config.environment === \u0026#39;prod\u0026#39; ? cdk.RemovalPolicy.RETAIN : cdk.RemovalPolicy.DESTROY, }); // Thêm key policy cho DynamoDB service key.addToResourcePolicy( new cdk.aws_iam.PolicyStatement({ sid: \u0026#39;Allow DynamoDB to use the key\u0026#39;, effect: cdk.aws_iam.Effect.ALLOW, principals: [new cdk.aws_iam.ServicePrincipal(\u0026#39;dynamodb.amazonaws.com\u0026#39;)], actions: [\u0026#39;kms:Decrypt\u0026#39;, \u0026#39;kms:DescribeKey\u0026#39;, \u0026#39;kms:CreateGrant\u0026#39;], resources: [\u0026#39;*\u0026#39;], conditions: { StringEquals: { \u0026#39;kms:ViaService\u0026#39;: `dynamodb.${this.region}.amazonaws.com`, }, }, }) ); return key; } 2. DynamoDB Single Table /** * Tạo DynamoDB Single Table với tối ưu chi phí */ private createDynamoDBTable(): cdk.aws_dynamodb.Table { const tableName = `EveryoneCook-${this.config.environment}-v2`; const dbConfig = this.config.dynamodb; const table = new cdk.aws_dynamodb.Table(this, \u0026#39;EveryoneCookTable\u0026#39;, { tableName, partitionKey: { name: \u0026#39;PK\u0026#39;, type: cdk.aws_dynamodb.AttributeType.STRING }, sortKey: { name: \u0026#39;SK\u0026#39;, type: cdk.aws_dynamodb.AttributeType.STRING }, // Billing mode: PROVISIONED cho prod/staging, PAY_PER_REQUEST cho dev billingMode: dbConfig.billingMode === \u0026#39;PROVISIONED\u0026#39; ? cdk.aws_dynamodb.BillingMode.PROVISIONED : cdk.aws_dynamodb.BillingMode.PAY_PER_REQUEST, // Point-in-time recovery cho prod/staging pointInTimeRecoverySpecification: { pointInTimeRecoveryEnabled: dbConfig.pointInTimeRecovery, }, // Deletion protection cho production deletionProtection: dbConfig.deletionProtection, // Bật DynamoDB Streams stream: dbConfig.streamEnabled ? cdk.aws_dynamodb.StreamViewType.NEW_AND_OLD_IMAGES : undefined, // TTL attribute cho automatic cleanup timeToLiveAttribute: \u0026#39;ttl\u0026#39;, // Encryption với customer managed KMS key encryption: cdk.aws_dynamodb.TableEncryption.CUSTOMER_MANAGED, encryptionKey: this.dynamoDbKey, // Removal policy removalPolicy: this.config.environment === \u0026#39;prod\u0026#39; ? cdk.RemovalPolicy.RETAIN : cdk.RemovalPolicy.DESTROY, }); // Thêm 5 GSI indexes (code tiếp tục...) return table; } 3. S3 Bucket với Intelligent-Tiering /** * Tạo S3 bucket với Intelligent-Tiering để tiết kiệm 57% chi phí */ private createContentBucket(): cdk.aws_s3.Bucket { const bucketName = `everyonecook-content-${this.config.environment}`; const s3Config = this.config.s3; const bucket = new cdk.aws_s3.Bucket(this, \u0026#39;ContentBucket\u0026#39;, { bucketName, // Block ALL public access (private bucket) blockPublicAccess: cdk.aws_s3.BlockPublicAccess.BLOCK_ALL, // Bật versioning cho production versioned: s3Config.versioning, // S3-managed encryption encryption: cdk.aws_s3.BucketEncryption.S3_MANAGED, // Cấu hình Intelligent-Tiering intelligentTieringConfigurations: [{ name: \u0026#39;EntireBucket\u0026#39;, archiveAccessTierTime: cdk.Duration.days(90), // Archive tier deepArchiveAccessTierTime: cdk.Duration.days(180), // Deep Archive }], // Lifecycle rules lifecycleRules: [ { id: \u0026#39;DeleteOldVersions\u0026#39;, enabled: s3Config.versioning, noncurrentVersionExpiration: cdk.Duration.days(30), }, { id: \u0026#39;DeleteTempUploads\u0026#39;, enabled: true, prefix: \u0026#39;posts/temp/\u0026#39;, expiration: cdk.Duration.days(1), // Dọn dẹp temp files sau 24h }, ], // CORS cho frontend access cors: [{ allowedOrigins: [ `https://${this.config.domain.frontend}`, ...(this.config.environment === \u0026#39;dev\u0026#39; ? [\u0026#39;http://localhost:3000\u0026#39;] : []), ], allowedMethods: [ cdk.aws_s3.HttpMethods.GET, cdk.aws_s3.HttpMethods.PUT, cdk.aws_s3.HttpMethods.POST, cdk.aws_s3.HttpMethods.DELETE, ], allowedHeaders: [\u0026#39;*\u0026#39;], exposedHeaders: [\u0026#39;ETag\u0026#39;], maxAge: 3000, }], removalPolicy: this.config.environment === \u0026#39;prod\u0026#39; ? cdk.RemovalPolicy.RETAIN : cdk.RemovalPolicy.DESTROY, }); return bucket; } 4. CloudFront Distribution /** * Tạo CloudFront distribution với compression và caching */ private createCloudFrontDistribution(): cdk.aws_cloudfront.Distribution { // Import Route 53 Hosted Zone const hostedZone = cdk.aws_route53.HostedZone.fromHostedZoneAttributes( this, \u0026#39;HostedZone\u0026#39;, { hostedZoneId: cdk.Fn.importValue(this.exportName(\u0026#39;HostedZoneId\u0026#39;)), zoneName: \u0026#39;everyonecook.cloud\u0026#39;, } ); // Import ACM certificate từ Certificate Stack (us-east-1) const certificate = cdk.aws_certificatemanager.Certificate.fromCertificateArn( this, \u0026#39;ImportedCloudFrontCertificate\u0026#39;, \u0026#39;arn:aws:acm:us-east-1:616580903213:certificate/8d53776e-0480-47d2-a6ff-4fe9b2eb6534\u0026#39; ); // Tạo cache policy với compression const publicCachePolicy = new cdk.aws_cloudfront.CachePolicy( this, \u0026#39;PublicCachePolicy\u0026#39;, { cachePolicyName: `EveryoneCook-Public-${this.config.environment}`, defaultTtl: cdk.Duration.hours(24), // 24h mặc định maxTtl: cdk.Duration.days(7), // tối đa 7 ngày minTtl: cdk.Duration.seconds(0), // Bật compression (Gzip + Brotli) enableAcceptEncodingGzip: true, enableAcceptEncodingBrotli: true, queryStringBehavior: cdk.aws_cloudfront.CacheQueryStringBehavior.all(), headerBehavior: cdk.aws_cloudfront.CacheHeaderBehavior.allowList( \u0026#39;CloudFront-Viewer-Country\u0026#39; ), cookieBehavior: cdk.aws_cloudfront.CacheCookieBehavior.none(), } ); // Tạo CloudFront distribution const distribution = new cdk.aws_cloudfront.Distribution( this, \u0026#39;CDNDistribution\u0026#39;, { comment: `Everyone Cook CDN - ${this.config.environment}`, // Default behavior với OAC defaultBehavior: { origin: origins.S3BucketOrigin.withOriginAccessControl(this.contentBucket), viewerProtocolPolicy: cdk.aws_cloudfront.ViewerProtocolPolicy.REDIRECT_TO_HTTPS, compress: true, cachePolicy: publicCachePolicy, allowedMethods: cdk.aws_cloudfront.AllowedMethods.ALLOW_GET_HEAD_OPTIONS, }, // Price Class 200 (US, Europe, Asia - tiết kiệm 45% chi phí) priceClass: cdk.aws_cloudfront.PriceClass.PRICE_CLASS_200, // Custom domain với SSL domainNames: [this.config.domains.cdn], certificate: certificate, // CloudFront access logs enableLogging: true, logBucket: this.cdnLogsBucket, logFilePrefix: \u0026#39;cdn-access-logs/\u0026#39;, // Bật IPv6 enableIpv6: true, // HTTP/2 + HTTP/3 httpVersion: cdk.aws_cloudfront.HttpVersion.HTTP2_AND_3, // TLS 1.2 tối thiểu minimumProtocolVersion: cdk.aws_cloudfront.SecurityPolicyProtocol.TLS_V1_2_2021, } ); // Tạo Route 53 A record (Alias đến CloudFront) new cdk.aws_route53.ARecord(this, \u0026#39;CloudFrontAliasRecord\u0026#39;, { zone: hostedZone, recordName: this.config.domains.cdn, target: cdk.aws_route53.RecordTarget.fromAlias( new targets.CloudFrontTarget(distribution) ), }); return distribution; } Chi Tiết Cấu Hình Chính 1. DynamoDB Single Table Design Cấu Trúc Table:\nPK: USER#{username}\rSK: PROFILE | RECIPE#{recipeId} | POST#{postId} | COMMENT#{commentId}\rGSI1: username-recipeDate (recipes của user theo ngày)\rGSI2: username-postDate (posts của user theo ngày)\rGSI3: recipeId-index (tìm kiếm recipe)\rGSI4: postId-index (tìm kiếm post)\rGSI5: email-index (tìm kiếm email) Billing Modes:\nDev: PAY_PER_REQUEST (không provisioned capacity, trả tiền theo request) Staging: PROVISIONED (5 RCU, 5 WCU với auto-scaling) Prod: PROVISIONED (10 RCU, 10 WCU với auto-scaling) 2. Tiết Kiệm Chi Phí với S3 Intelligent-Tiering So Sánh Chi Phí (100GB nội dung):\nTier Chi phí/GB Chi phí 100GB Timeline Frequent Access $0.023 $2.30/tháng Mặc định Infrequent Access $0.0125 $1.25/tháng Sau 30 ngày Archive Instant $0.004 $0.40/tháng Sau 90 ngày Archive $0.0036 $0.36/tháng Sau 90 ngày Deep Archive $0.00099 $0.099/tháng Sau 180 ngày Tiết Kiệm: $2.30 → $0.099 = giảm 57% chi phí sau 12 tháng\n3. CloudFront Compression Giảm Kích Thước File:\nText files (HTML, CSS, JS, JSON): giảm 70-80% Images (đã nén sẵn): Không nén thêm Videos (đã nén sẵn): Không nén thêm Ví dụ:\nJS bundle gốc: 1MB → Nén: 200KB (giảm 80%) 1000 requests/ngày: 1GB/ngày → 200MB/ngày (tiết kiệm 800MB bandwidth) 4. CloudFront Price Class 200 So Sánh Chi Phí:\nPrice Class Regions Chi phí/GB Tiết kiệm All Tất cả regions $0.085 Baseline 200 US, EU, Asia $0.047 tiết kiệm 45% 100 Chỉ US, EU $0.025 tiết kiệm 71% (nhưng phạm vi hạn chế) Quyết Định: Price Class 200 cân bằng chi phí (tiết kiệm 45%) với phạm vi toàn cầu.\nStack Outputs Sau khi triển khai, stack export các giá trị sau:\nOutput Name Value Được sử dụng bởi DynamoDBTableName EveryoneCook-dev-v2 Auth Stack, Backend Stack DynamoDBTableArn arn:aws:dynamodb:... Lambda IAM policies DynamoDBTableStreamArn arn:aws:dynamodb:... Event-driven processing DynamoDBKeyId KMS Key ID Encryption references DynamoDBKeyArn arn:aws:kms:... Lambda permissions S3KeyId KMS Key ID S3 encryption ContentBucketName everyonecook-content-dev Backend Stack, Lambda ContentBucketArn arn:aws:s3:... IAM policies CloudFrontDistributionId E1234567890ABC Backend Stack (WAF) CloudFrontDomainName d1234567890.cloudfront.net DNS verification Các Bước Triển Khai Bước 1: Xác Minh Điều Kiện Tiên Quyết Trước khi triển khai Core Stack, hãy đảm bảo:\nDNS Stack đã triển khai thành công Certificate Stack đã triển khai thành công (us-east-1) Trạng thái CloudFront certificate là Issued Ủy quyền DNS Route 53 đang hoạt động Bước 2: Triển Khai Core Stack Di chuyển đến thư mục infrastructure:\ncd D:\\Project_AWS\\everyonecook\\infrastructure Triển khai Core Stack đến ap-southeast-1:\n# Triển khai Core Stack npx cdk deploy EveryoneCook-dev-Core --context environment=dev Kết quả mong đợi:\n✨ Synthesis time: 8.45s\rEveryoneCook-dev-Core: deploying...\r[████████████████████████████████████████] (12/12)\rEveryoneCook-dev-Core: creating CloudFormation changeset...\rEveryoneCook-dev-Core\r✨ Deployment time: 450.23s\rOutputs:\rEveryoneCook-dev-Core.DynamoDBTableName = EveryoneCook-dev-v2\rEveryoneCook-dev-Core.ContentBucketName = everyonecook-content-dev\rEveryoneCook-dev-Core.CloudFrontDistributionId = E2ABCDEFGHIJKL\rEveryoneCook-dev-Core.CloudFrontDomainName = d1a2b3c4d5e6f7.cloudfront.net\rEveryoneCook-dev-Core.StackInfo = Core Stack cho dev environment\rStack ARN:\rarn:aws:cloudformation:ap-southeast-1:616580903213:stack/EveryoneCook-dev-Core/... Bước 3: Chờ CloudFront Distribution Triển khai CloudFront distribution mất 15-20 phút. Bạn có thể theo dõi tiến trình:\n# Kiểm tra trạng thái CloudFront distribution aws cloudfront get-distribution --id E2ABCDEFGHIJKL --query \u0026#39;Distribution.Status\u0026#39; Tiến trình trạng thái:\nInProgress (0-15 phút) Deployed (sẵn sàng sử dụng) Bước 4: Xác Minh trong AWS Console Điều hướng đến DynamoDB Mở AWS Console → region ap-southeast-1 Đi đến DynamoDB \u0026gt; Tables Tìm table EveryoneCook-dev-v2 DynamoDB table hiển thị partitionKey (PK), sortKey (SK), 5 GSI indexes, billing mode (PAY_PER_REQUEST), encryption (KMS), và streams enabled\nXác minh:\nPartition key: PK (String) Sort key: SK (String) 5 GSI indexes hiển thị Billing mode: PAY_PER_REQUEST (dev) Encryption: Customer managed KMS Streams: Enabled (NEW_AND_OLD_IMAGES) Điều hướng đến S3 Đi đến S3 \u0026gt; Buckets Tìm buckets: everyonecook-content-dev everyonecook-cdn-logs-dev S3 content bucket hiển thị cấu trúc thư mục (avatars/, posts/, recipes/, backgrounds/), cấu hình Intelligent-Tiering, versioning, CORS, và encryption settings\nXác minh Content Bucket:\nBlock all public access: On Versioning: Enabled (prod) / Disabled (dev) Intelligent-Tiering: Đã cấu hình Encryption: S3-managed keys CORS: Đã cấu hình Lifecycle rules: 2 rules Cấu hình S3 Intelligent-Tiering hiển thị Archive Access Tier (90 ngày) và Deep Archive Access Tier (180 ngày)\nĐiều hướng đến CloudFront Đi đến CloudFront \u0026gt; Distributions Tìm distribution với domain cdn-dev.everyonecook.cloud CloudFront distribution hiển thị custom domain, origin (S3 với OAC), cache behaviors, compression enabled, Price Class 200, SSL certificate, và status (Deployed)\nXác minh:\nStatus: Deployed Domain: cdn-dev.everyonecook.cloud Origin: S3 bucket với OAC Compression: Enabled Price Class: 200 SSL Certificate: Valid HTTPS: Redirect Cấu hình CloudFront Origin Access Control (OAC) hiển thị S3 origin với OAC policy tự động được tạo\nĐiều hướng đến KMS Đi đến KMS \u0026gt; Customer managed keys Tìm keys: everyonecook-dynamodb-dev everyonecook-s3-dev KMS customer managed keys hiển thị key aliases, key rotation enabled (hàng năm), key policies, và sử dụng bởi DynamoDB và S3\nXác minh:\nKey rotation: Enabled Key state: Enabled Deletion protection: Đã cấu hình Key policy: DynamoDB/S3 service access Xác Minh Route 53 DNS Record Đi đến Route 53 \u0026gt; Hosted zones Chọn everyonecook.cloud Xác minh A record cho cdn-dev.everyonecook.cloud Route 53 A record (Alias) trỏ cdn-dev.everyonecook.cloud đến CloudFront distribution\nMong đợi:\ncdn-dev.everyonecook.cloud A Alias d1a2b3c4d5e6f7.cloudfront.net Chi Tiết Chi Phí Chi Phí Hàng Tháng (Dev Environment) Tài nguyên Cấu hình Chi phí hàng tháng Ghi chú DynamoDB PAY_PER_REQUEST $1-5 Lưu lượng thấp S3 Content 10GB, Intelligent-Tiering $0.23 Chuyển sang Deep Archive S3 Logs 5GB $0.12 Access logs CloudFront 100GB transfer, Price Class 200 $4.70 Tiết kiệm 45% vs All KMS 2 keys $2.00 $1/key/tháng Route 53 1 hosted zone, DNS queries $0.50 Từ DNS Stack Tổng (Ước tính) ~$8-13/tháng Kịch bản lưu lượng thấp Chiến Lược Tối Ưu Chi Phí S3 Intelligent-Tiering: tiết kiệm 57% cho storage CloudFront Price Class 200: tiết kiệm 45% cho bandwidth DynamoDB PAY_PER_REQUEST (dev): Chỉ trả tiền cho sử dụng thực tế CloudFront WAF removed: tiết kiệm $9/tháng Compression enabled: giảm 70-80% bandwidth Tổng Tiết Kiệm Tiềm Năng: ~$20-30/tháng so với thiết lập không tối ưu\nCross-Stack Dependencies Import từ Các Stack Trước Từ DNS Stack:\nhostedZoneId: cdk.Fn.importValue(\u0026#39;EveryoneCook-dev-HostedZoneId\u0026#39;) zoneName: \u0026#39;everyonecook.cloud\u0026#39; Từ Certificate Stack:\ncertificateArn: \u0026#39;arn:aws:acm:us-east-1:616580903213:certificate/8d53776e-...\u0026#39; Export Được Sử Dụng Bởi Các Stack Khác Auth Stack import:\nDynamoDB table (cho user profiles) DynamoDB key (cho Lambda permissions) Backend Stack import:\nDynamoDB table (cho tất cả data operations) S3 content bucket (cho file uploads) CloudFront distribution (cho WAF association) KMS keys (cho encryption) Luồng Dependency DNS Stack → Hosted Zone ID\r│\r▼\rCertificate Stack (us-east-1) → Certificate ARN\r│\r▼\rCore Stack (ap-southeast-1)\r│\r├─► DynamoDB Table → Auth Stack, Backend Stack\r├─► S3 Buckets → Backend Stack\r├─► CloudFront → Backend Stack (WAF)\r└─► KMS Keys → Auth Stack, Backend Stack Danh Sách Kiểm Tra Xác Thực Trước khi tiến hành triển khai Auth Stack:\nCore Stack đã triển khai thành công đến ap-southeast-1 DynamoDB table tồn tại với 5 GSI indexes S3 content bucket đã cấu hình Intelligent-Tiering S3 CORS đã cấu hình cho frontend domain Trạng thái CloudFront distribution là Deployed CloudFront custom domain phân giải: cdn-dev.everyonecook.cloud CloudFront OAC đã cấu hình cho S3 access KMS keys đã tạo với rotation enabled Route 53 A record đã tạo cho CloudFront Tất cả stack outputs đã export thành công Kiểm Tra Kiểm Tra CloudFront Distribution Kiểm tra custom domain:\ncurl -I https://cdn-dev.everyonecook.cloud Phản hồi mong đợi:\nHTTP/2 403\rserver: CloudFront\rx-cache: Error from cloudfront (403 là mong đợi - bucket trống)\nKiểm tra compression:\ncurl -H \u0026#34;Accept-Encoding: gzip, br\u0026#34; -I https://cdn-dev.everyonecook.cloud Kiểm tra HTTPS redirect:\ncurl -I http://cdn-dev.everyonecook.cloud Mong đợi: Redirect sang HTTPS\nKiểm Tra DynamoDB Table # Liệt kê tables aws dynamodb list-tables --region ap-southeast-1 # Mô tả table aws dynamodb describe-table --table-name EveryoneCook-dev-v2 --region ap-southeast-1 Kiểm Tra S3 Bucket Access # Thử truy cập S3 trực tiếp (nên bị chặn) curl -I https://everyonecook-content-dev.s3.ap-southeast-1.amazonaws.com # Mong đợi: 403 Forbidden (OAC protection hoạt động) Các Bước Tiếp Theo Sau khi triển khai thành công Core Stack:\n➡️ 5.4.4 Auth Stack - Tạo Cognito User Pool và authentication\nAuth Stack sẽ:\nTạo Cognito User Pool với bảo mật nâng cao Cấu hình user attributes và password policy Thiết lập Cognito triggers (Lambda functions) Tạo SES email identity cho verification emails Import DynamoDB table từ Core Stack Tài Liệu Tham Khảo Mã nguồn: infrastructure/lib/stacks/core-stack.ts Base Stack: infrastructure/lib/base-stack.ts Environment Config: infrastructure/config/environment.ts Tài liệu AWS: DynamoDB Single Table Design S3 Intelligent-Tiering CloudFront Origin Access Control KMS Key Rotation "
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/5-workshop/5.04-configure-stacks/",
	"title": "Cấu hình các Infrastructure Stack",
	"tags": [],
	"description": "",
	"content": "Cấu hình các Infrastructure Stack Tổng quan dự án EveryoneCook Giới thiệu EveryoneCook là một nền tảng mạng xã hội chia sẻ công thức nấu ăn, được xây dựng hoàn toàn trên AWS Cloud. Dự án sử dụng kiến trúc serverless, tận dụng các dịch vụ quản lý của AWS để đảm bảo khả năng mở rộng, bảo mật và tối ưu hóa chi phí.\nKiến trúc hệ thống Dự án được thiết kế với Kiến trúc 5-Stack với các lớp rõ ràng:\n┌─────────────────────────────────────────────────────────────┐\r│ EveryoneCook Platform │\r├─────────────────────────────────────────────────────────────┤\r│ Layer 1: DNS \u0026amp; Certificate (Foundation) │\r│ ├─ DNS Stack: Route 53 Hosted Zone │\r│ └─ Certificate Stack: ACM Certificates (us-east-1) │\r├─────────────────────────────────────────────────────────────┤\r│ Layer 2: Data \u0026amp; Storage (Core Infrastructure) │\r│ └─ Core Stack: DynamoDB, S3, CloudFront, KMS │\r├─────────────────────────────────────────────────────────────┤\r│ Layer 3: Authentication \u0026amp; Security │\r│ └─ Auth Stack: Cognito, Lambda Triggers, SES │\r├─────────────────────────────────────────────────────────────┤\r│ Layer 4: Application \u0026amp; Business Logic │\r│ └─ Backend Stack: API Gateway, Lambda, SQS, WAF │\r├─────────────────────────────────────────────────────────────┤\r│ Layer 5: Monitoring \u0026amp; Observability │\r│ └─ Observability Stack: CloudWatch, Alarms, Dashboards │\r└─────────────────────────────────────────────────────────────┘ Công nghệ sử dụng Infrastructure as Code AWS CDK (TypeScript): Quản lý hạ tầng bằng code CloudFormation: Engine template cơ sở cho CDK Git: Quản lý phiên bản cho infrastructure code Backend Services API Gateway REST API: RESTful API endpoint với custom domain Lambda Functions: Serverless compute cho business logic (6 hàm chính + 1 worker) Lambda Layers: Lớp shared dependencies (giảm kích thước deployment 90%) DynamoDB: NoSQL database với Single Table Design + 5 GSI indexes S3: Object storage cho user content (avatars, posts, recipes, backgrounds) SQS: Message queue cho async processing (4 queues + 4 DLQs) Security \u0026amp; Authentication Cognito User Pool: User authentication \u0026amp; management Cognito User Pool Client: Frontend authentication config WAF (Web Application Firewall): API Gateway protection với rate limiting KMS (Key Management Service): 2 customer-managed keys (DynamoDB, S3) IAM Roles \u0026amp; Policies: Fine-grained access control cho tất cả services Content Delivery \u0026amp; Networking CloudFront: CDN với Origin Access Control (OAC) + Shield Standard Route 53: DNS management với Hosted Zone ACM (Certificate Manager): SSL/TLS certificates (2 certificates) Monitoring \u0026amp; Operations CloudWatch Logs: Centralized logging cho Lambda functions CloudWatch Metrics: Performance metrics tracking CloudWatch Dashboards: 4 dashboards (Core, Auth, Backend, Overview) CloudWatch Alarms: Real-time monitoring (10+ alarms) + Composite Alarm SNS (Simple Notification Service): Email notifications cho alarms Cấu trúc thư mục dự án everyonecook/\r├── infrastructure/ # AWS CDK Infrastructure\r│ ├── bin/\r│ │ └── app.ts # CDK app entry point - tạo tất cả stacks\r│ ├── lib/\r│ │ ├── base-stack.ts # Base class cho tất cả stacks\r│ │ ├── stacks/ # Stack definitions\r│ │ │ ├── dns-stack.ts # Route 53 Hosted Zone\r│ │ │ ├── certificate-stack.ts # ACM Certificates\r│ │ │ ├── core-stack.ts # DynamoDB, S3, CloudFront\r│ │ │ ├── auth-stack.ts # Cognito, Lambda triggers\r│ │ │ ├── backend-stack.ts # API Gateway, Lambda, SQS\r│ │ │ └── observability-stack.ts # CloudWatch, Alarms\r│ │ └── constructs/ # Reusable CDK constructs\r│ │ └── shared-layer.ts # Lambda Layer với dependencies\r│ ├── config/\r│ │ └── environment.ts # Environment configuration (dev/staging/prod)\r│ ├── cdk.json # CDK configuration\r│ ├── package.json # Node.js dependencies\r│ └── tsconfig.json # TypeScript configuration\r├── services/ # Lambda function source code\r│ ├── api-router/ # API request routing\r│ ├── auth-user/ # Authentication endpoints\r│ ├── social/ # Social features (posts, comments)\r│ ├── recipe-ai/ # Recipe \u0026amp; AI endpoints\r│ ├── admin/ # Admin management\r│ └── upload/ # File upload handler\r├── shared/ # Shared code \u0026amp; utilities\r│ ├── utils/ # Common utilities\r│ ├── models/ # Data models\r│ └── middleware/ # Lambda middleware\r├── frontend/ # Next.js frontend (deployed separately)\r│ └── ...\r└── layers/ # Lambda layers\r└── shared-dependencies/ # Common npm packages Tổng quan kiến trúc Stack 1. DNS Stack (Phase 1) Mục đích: Tạo nền tảng cho DNS management\nTài nguyên chính:\nRoute 53 Hosted Zone cho domain everyonecook.cloud Export nameservers để cấu hình tại domain registrar Thứ tự triển khai: Stack này phải được triển khai đầu tiên\nChi phí ước tính: ~$0.50/tháng\nLưu ý: Sau khi triển khai stack này, cập nhật nameservers tại Hostinger để trỏ về Route 53.\n2. Certificate Stack (Phase 1.5) Mục đích: Tạo SSL/TLS certificates cho CloudFront và API Gateway\nTài nguyên chính:\nACM Certificate cho CloudFront: cdn.everyonecook.cloud ACM Wildcard Certificate cho API Gateway: *.everyonecook.cloud DNS validation records trong Route 53 Region đặc biệt: BẮT BUỘC triển khai tại us-east-1 (yêu cầu của CloudFront)\nPhụ thuộc: DNS Stack (cần Hosted Zone cho DNS validation)\nChi phí ước tính: Miễn phí (ACM certificates miễn phí)\nLưu ý quan trọng: CloudFront chỉ chấp nhận certificates từ region us-east-1.\n3. Core Stack (Phase 2) Mục đích: Tạo lớp dữ liệu và storage infrastructure\nTài nguyên chính:\nDynamoDB Table: Single Table Design với 5 GSI indexes PK: USER#{username}, SK: PROFILE|RECIPE#{id}|POST#{id}|COMMENT#{id} Username-based primary key (immutable) GSI1-GSI5 cho các query patterns khác nhau: GSI1: User recipes theo date GSI2: User posts theo date GSI3: Post comments GSI4: Recipe search theo cuisine/difficulty GSI5: Social interactions (likes, follows) Billing mode: Pay-per-request (on-demand) Encryption: Customer-managed KMS key với auto-rotation S3 Buckets (2 buckets): Content Bucket: User uploads (avatars, posts, recipes, backgrounds) Intelligent-Tiering enabled (tự động tối ưu chi phí) Versioning enabled Lifecycle rules: Xóa incomplete multipart uploads sau 7 ngày Encryption: Customer-managed KMS key CDN Logs Bucket: CloudFront access logs Intelligent-Tiering enabled Tự động xóa logs sau 90 ngày (tối ưu chi phí) CloudFront Distribution: Origin: S3 Content Bucket Origin Access Control (OAC) để bảo mật S3 access (thay thế OAI) Custom domain: cdn.everyonecook.cloud SSL Certificate: ACM certificate từ Certificate Stack Cache behaviors: Tối ưu cho images \u0026amp; static content Compression: Gzip \u0026amp; Brotli enabled Shield Standard: DDoS protection (miễn phí, tự động bật) LƯU Ý: CloudFront WAF đã được gỡ bỏ để tiết kiệm $9/tháng KMS Keys (2 customer-managed keys): DynamoDB Encryption Key: Auto-rotation enabled (hàng năm) Sử dụng bởi: DynamoDB table, CloudWatch Logs S3 Encryption Key: Auto-rotation enabled (hàng năm) Sử dụng bởi: S3 buckets, CloudFront signed URLs IAM Roles: CloudFront Origin Access Control role Lambda execution roles với DynamoDB \u0026amp; S3 access Phụ thuộc: Certificate Stack (cần certificate cho CloudFront)\nChi phí ước tính: ~$8-15/tháng\nTối ưu chi phí:\nS3 Intelligent-Tiering tự động chuyển objects sang storage rẻ hơn CloudFront WAF đã gỡ bỏ (Shield Standard cung cấp DDoS protection) CloudWatch Logs tự động xóa sau retention period 4. Auth Stack (Phase 3) Mục đích: Authentication và user management\nTài nguyên chính:\nCognito User Pool: Phương thức đăng nhập: Username HOẶC Email + Password KHÔNG yêu cầu MFA (chỉ email + password) Password policy: Min 12 ký tự cho prod (8 ký tự cho dev) Yêu cầu uppercase, lowercase, digits, symbols Standard attributes: email, given_name (fullName), birthdate, gender Custom attributes: account_status (cho admin ban), country (ISO 3166-1) Device tracking: Enabled (KHÔNG yêu cầu challenge) Email verification: Bắt buộc trước khi sử dụng Account recovery: Dựa trên Email LƯU Ý: Advanced Security Mode TẮT để tiết kiệm ~$5/tháng Lambda Triggers (5 functions với CloudWatch Logs): Pre-signup: Validate username uniqueness Kiểm tra profanity/banned words Runtime: Node.js 20.x Post-confirmation: Tạo user profile trong DynamoDB Initialize user stats Pre-authentication: Kiểm tra account status (active/banned) Log login attempts Post-authentication: Cập nhật last login timestamp Track user activity Custom message: Customize verification emails Branded email templates Cognito User Pool Client: OAuth flows: Authorization code grant Token validity: Access token: 1 giờ Refresh token: 30 ngày Read/Write attributes được cấu hình CloudWatch Log Groups: Mỗi Lambda trigger có dedicated log group Retention: 7 ngày Encryption: KMS DynamoDB key IAM Roles: Lambda execution roles Permissions: DynamoDB read/write, Cognito admin, Logs write Phụ thuộc: Core Stack (Lambda triggers cần access DynamoDB)\nChi phí ước tính: ~$0-2/tháng (Cognito free tier: 50,000 MAU)\nBảo mật:\nAdvanced Security Mode không bật để tối ưu chi phí (sẽ tốn thêm ~$5/tháng) Device tracking enabled nhưng KHÔNG MFA để cải thiện user experience Tất cả Lambda triggers có CloudWatch logging 5. Backend Stack (Phase 4) Mục đích: Application layer và business logic\nTài nguyên chính:\nAPI Gateway REST API: Custom domain: api.everyonecook.cloud SSL Certificate: Wildcard ACM certificate (*.everyonecook.cloud) Cognito Authorizer: Validate JWT tokens Request validators: Body validator: Validate request body Params validator: Validate query params \u0026amp; path params Full validator: Validate cả body \u0026amp; params Deployment stage: dev/staging/prod CloudWatch Logs: Access logs + execution logs WAF Web ACL attached (API protection) Lambda Functions (6 main modules + CloudWatch Logs): API Router: Route requests tới appropriate handlers Memory: 256 MB, Timeout: 30s Auth User: Login, register, forgot-password, verify-email Cognito integration Memory: 512 MB, Timeout: 30s Social: Create/edit/delete posts, comments, likes Follow/unfollow users Memory: 512 MB, Timeout: 30s Recipe AI: CRUD operations cho recipes AI recipe generation (Bedrock integration) Recipe search \u0026amp; recommendations Memory: 1024 MB, Timeout: 60s Admin: User management, ban/unban Content moderation Analytics dashboard Memory: 512 MB, Timeout: 30s Upload: File upload lên S3 Generate pre-signed URLs Image validation Memory: 512 MB, Timeout: 30s Runtime: Node.js 20.x Environment variables: DynamoDB table, S3 bucket, SQS queues Lambda Layer - Shared Dependencies: AWS SDK v3 clients: DynamoDB, S3, SQS, Cognito, Bedrock, Lambda Utilities: uuid, jsonwebtoken, jwks-rsa Lợi ích: Giảm kích thước deployment từ 8MB → 200KB per function (giảm 90%) Compatible runtimes: Node.js 18.x, 20.x SQS Queues (4 main queues + 4 DLQs): AI Queue: AI recipe generation requests Visibility timeout: 120s (2 phút) Message retention: 4 ngày Max receive count: 3 (sau đó chuyển sang DLQ) Image Processing Queue: Image optimization, thumbnails Visibility timeout: 60s Message retention: 4 ngày Analytics Queue: User activity tracking Visibility timeout: 30s Message retention: 4 ngày Notification Queue: Push notifications, emails Visibility timeout: 30s Message retention: 4 ngày Encryption: AWS managed KMS keys Worker Lambda (1 active): AI Worker: Process AI Queue messages Call Amazon Bedrock cho recipe generation Store results trong DynamoDB Memory: 1024 MB, Timeout: 120s Event source: AI Queue (batch size: 10) Lưu ý: Các workers khác chưa được implement WAF Web ACL (chỉ API Gateway): Rate limiting: 2000 requests / 5 phút per IP AWS Managed Rules: AWSManagedRulesCommonRuleSet (OWASP Top 10) AWSManagedRulesKnownBadInputsRuleSet Custom rules: Block specific patterns LƯU Ý: CloudFront WAF đã gỡ bỏ để tiết kiệm $9/tháng Shield Standard: Tự động bật (DDoS protection - miễn phí) CloudWatch Log Groups: API Gateway access logs + execution logs Lambda function logs (per function) Retention: 7 ngày (tối ưu chi phí) Encryption: KMS DynamoDB key IAM Roles \u0026amp; Policies: API Gateway execution role Lambda execution roles (per function) Permissions: DynamoDB, S3, SQS, Cognito, Bedrock, Logs, KMS Shared Lambda Layer:\nAWS SDK v3 clients (DynamoDB, S3, SQS, Cognito, Bedrock) Common utilities (uuid, jsonwebtoken, jwks-rsa) Giảm deployment size: 8MB → 200KB per function Phụ thuộc: Auth Stack (cần Cognito User Pool)\nChi phí ước tính: ~$10-25/tháng\nTối ưu chi phí:\nCloudFront WAF đã gỡ bỏ (Shield Standard cung cấp DDoS protection) WAF chỉ enabled cho API Gateway (main attack surface) Lambda Layer giảm deployment size 90% CloudWatch Logs tự động xóa sau 7 ngày 6. Observability Stack (Phase 7) Mục đích: Monitoring, logging và alerting\nTài nguyên chính:\nCloudWatch Dashboards (4 dashboards): Core Dashboard: DynamoDB metrics: Read/write capacity, throttling, latency S3 metrics: Request count, 4xx/5xx errors, bytes downloaded CloudFront metrics: Request count, cache hit rate, error rate KMS metrics: Key usage, encryption/decryption operations Auth Dashboard: Cognito metrics: Sign-ups, sign-ins, failed authentications Lambda trigger metrics: Invocations, errors, duration User pool analytics Backend Dashboard: API Gateway metrics: Request count, 4xx/5xx errors, latency Lambda metrics: Invocations, errors, duration, throttles, concurrent executions SQS metrics: Messages sent, received, deleted, DLQ depth WAF metrics: Blocked requests, allowed requests, rule matches Overview Dashboard: System health summary Cost tracking Composite alarm status Key metrics từ tất cả stacks CloudWatch Alarms (15+ alarms): Critical Alarms (notify ngay lập tức): API Gateway 5xx errors \u0026gt; 5% (system errors) Lambda error rate \u0026gt; 10% DynamoDB read/write throttling SQS DLQ có messages (failed processing) S3 5xx errors Cost \u0026gt; $50/tháng (vượt ngân sách) Warning Alarms (notify nhưng không khẩn cấp): API Gateway 4xx errors \u0026gt; 10% (client errors) Lambda duration \u0026gt; 25s (sắp timeout) Lambda throttling (đạt concurrent limit) DynamoDB latency cao (\u0026gt; 100ms) S3 4xx errors SQS queue age \u0026gt; 15 phút (processing lag) Cost \u0026gt; $35/tháng (cảnh báo ngân sách) Tất cả alarms: Evaluation periods: 1-2 periods Datapoints to alarm: Có thể cấu hình Treatment of missing data: NOT_BREACHING Composite Alarm: Name: \u0026ldquo;SystemHealth\u0026rdquo; Kết hợp tất cả critical alarms Alarm rule: OR logic (bất kỳ critical alarm nào trigger) Actions: Gửi SNS notification Mục đích: Một alarm duy nhất cho overall system health SNS Topic: Topic name: EveryoneCook-{env}-Alarms Email subscription: Admin email từ config Delivery status logging enabled Encryption: AWS managed key CloudWatch Logs: Retention: 7 ngày (tối ưu chi phí) Encryption: KMS DynamoDB key Log groups: API Gateway, Lambda functions (tất cả đều có logs) Cost Tracking: CloudWatch metric: EstimatedCharges Alarms: Warning ($35) + Critical ($50) Daily cost monitoring Phụ thuộc: Tất cả stacks khác (monitor toàn bộ infrastructure)\nChi phí ước tính: ~$3-8/tháng\nBest practice:\nDeploy stack này cuối cùng để có visibility hoàn chỉnh Composite alarm giúp giảm alarm fatigue 7-day log retention cân bằng debugging needs và cost Cost alarms ngăn ngừa hóa đơn bất ngờ Luồng phụ thuộc Stack DNS Stack (Route 53)\r↓\rCertificate Stack (ACM in us-east-1)\r↓\rCore Stack (DynamoDB, S3, CloudFront, KMS)\r↓\rAuth Stack (Cognito, Lambda Triggers)\r↓\rBackend Stack (API Gateway, Lambda, SQS, WAF)\r↓\rObservability Stack (CloudWatch, Alarms) Giải thích phụ thuộc:\nCertificate Stack cần DNS Stack để validate certificates qua Route 53 DNS Core Stack cần Certificate Stack để attach certificate vào CloudFront Auth Stack cần Core Stack để Lambda triggers có thể access DynamoDB Backend Stack cần Auth Stack để integrate Cognito Authorizer vào API Gateway Observability Stack cần tất cả stacks để monitor tất cả resources Tổng chi phí ước tính Development Environment:\nService Chi phí/tháng Ghi chú Route 53 Hosted Zone $0.50 1 hosted zone + DNS queries ACM Certificates $0 Miễn phí cho public certificates DynamoDB (Pay-per-request) $3-5 Phụ thuộc usage, có free tier S3 (Intelligent-Tiering) $1-3 2 buckets, auto-tiering tiết kiệm chi phí CloudFront $2-5 CDN distribution + data transfer Lambda $0-3 7 functions + 1 worker, free tier 1M requests Lambda Layer $0 Không tính phí thêm API Gateway $0-3 REST API, free tier 1M requests Cognito (Free tier) $0 Lên đến 50,000 MAU SQS $0-1 4 queues + 4 DLQs, free tier 1M requests WAF (chỉ API Gateway) $5-8 Web ACL + rules + requests processed CloudWatch Logs $1-2 7-day retention, tất cả services CloudWatch Dashboards $0-1 4 dashboards, 3 đầu tiên miễn phí CloudWatch Alarms $0.50-1 15+ alarms, $0.10/alarm SNS $0 Email notifications, volume thấp KMS $2 2 customer-managed keys @ $1 mỗi cái IAM $0 Roles \u0026amp; policies miễn phí TỔNG CỘNG $15-35/tháng Development với traffic thấp Lưu ý:\nĐây là ước tính cho development environment với traffic thấp Production environment với high traffic sẽ có chi phí cao hơn đáng kể Free tier: Cognito (50K MAU), Lambda (1M requests), API Gateway (1M requests), SQS (1M requests) Các tối ưu chi phí đã áp dụng: CloudFront WAF đã gỡ bỏ (-$9/tháng) S3 Intelligent-Tiering (tự động giảm chi phí) CloudWatch Logs 7-day retention Lambda Layer giảm deployment costs authStack.addDependency(coreStack); backendStack.addDependency(authStack); observabilityStack.addDependency(backendStack);\nHướng dẫn cấu hình Bước 1: Chuẩn bị thư mục Infrastructure 1. Di chuyển đến thư mục infrastructure\ncd D:\\Project_AWS\\everyonecook\\infrastructure 2. Cài đặt dependencies\nnpm install TODO: Chụp screenshot terminal với output của lệnh npm install\nBước 2: Cấu hình Environment Settings 1. Xem lại cấu hình environment\nMở file config/environment.ts để xem lại cấu hình:\ncode config\\environment.ts File này chứa cấu hình cho các environments (dev, staging, prod):\n// Ví dụ cấu hình Dev environment dev: { environment: \u0026#39;dev\u0026#39;, account: \u0026#39;123456789012\u0026#39;, // Cập nhật với AWS Account ID của bạn region: \u0026#39;ap-southeast-1\u0026#39;, // Singapore region domains: { frontend: \u0026#39;dev.everyonecook.cloud\u0026#39;, api: \u0026#39;api-dev.everyonecook.cloud\u0026#39;, cdn: \u0026#39;cdn-dev.everyonecook.cloud\u0026#39;, }, cognito: { passwordPolicy: { minLength: 8, // Dev: 8 ký tự, Prod: 12 ký tự } } } 2. Xác minh AWS Account ID\n# Kiểm tra AWS Account ID hiện tại aws sts get-caller-identity Output sẽ hiển thị:\n{ \u0026#34;UserId\u0026#34;: \u0026#34;AIDAXXXXXXXXXXXXXXXXX\u0026#34;, \u0026#34;Account\u0026#34;: \u0026#34;123456789012\u0026#34;, \u0026#34;Arn\u0026#34;: \u0026#34;arn:aws:iam::123456789012:user/your-username\u0026#34; } 3. Cập nhật account ID trong config (nếu cần)\nNếu account ID không khớp, cập nhật trong config/environment.ts:\ndev: { account: \u0026#39;YOUR_ACTUAL_ACCOUNT_ID\u0026#39;, // Cập nhật tại đây // ... các configs khác } Bước 3: Xem lại cấu trúc CDK App 1. Xem lại file CDK app chính\ncode bin\\app.ts File bin/app.ts là entry point của CDK application. Nội dung chính:\n#!/usr/bin/env node import * as cdk from \u0026#39;aws-cdk-lib\u0026#39;; import { getConfig } from \u0026#39;../config/environment\u0026#39;; const app = new cdk.App(); // Lấy environment từ context (mặc định: \u0026#39;dev\u0026#39;) const environment = app.node.tryGetContext(\u0026#39;environment\u0026#39;) || \u0026#39;dev\u0026#39;; const config = getConfig(environment); console.log(`🚀 Deploying Everyone Cook infrastructure for environment: ${environment}`); // Tạo stacks theo thứ tự phụ thuộc const dnsStack = new DnsStack(app, `EveryoneCook-${environment}-DNS`, {...}); const certificateStack = new CertificateStack(app, `EveryoneCook-${environment}-Certificate`, {...}); const coreStack = new CoreStack(app, `EveryoneCook-${environment}-Core`, {...}); const authStack = new AuthStack(app, `EveryoneCook-${environment}-Auth`, {...}); const backendStack = new BackendStack(app, `EveryoneCook-${environment}-Backend`, {...}); const observabilityStack = new ObservabilityStack(app, `EveryoneCook-${environment}-Observability`, {...}); // Thêm dependencies certificateStack.addDependency(dnsStack); coreStack.addDependency(certificateStack); authStack.addDependency(coreStack); backendStack.addDependency(authStack); observabilityStack.addDependency(backendStack); // Thêm tags cho tất cả stacks cdk.Tags.of(app).add(\u0026#39;Project\u0026#39;, \u0026#39;EveryoneCook\u0026#39;); cdk.Tags.of(app).add(\u0026#39;Environment\u0026#39;, config.environment); cdk.Tags.of(app).add(\u0026#39;ManagedBy\u0026#39;, \u0026#39;CDK\u0026#39;); 2. Hiểu về stack dependencies\nStacks được tạo theo thứ tự và có explicit dependencies:\nCertificate Stack phụ thuộc vào DNS Stack Core Stack phụ thuộc vào Certificate Stack Auth Stack phụ thuộc vào Core Stack Backend Stack phụ thuộc vào Auth Stack Observability Stack phụ thuộc vào tất cả stacks khác Bước 4: Validate cấu hình 1. Compile TypeScript\n# Di chuyển đến thư mục infrastructure cd D:\\Project_AWS\\everyonecook\\infrastructure # Compile TypeScript npm run build Output thành công:\n\u0026gt; everyonecook-infrastructure@1.0.0 build\r\u0026gt; tsc\r# Không có lỗi - compilation thành công 2. Liệt kê tất cả CDK stacks\n# Liệt kê tất cả stacks cho dev environment npx cdk list --context environment=dev Output:\nEveryoneCook-dev-DNS\rEveryoneCook-dev-Certificate\rEveryoneCook-dev-Core\rEveryoneCook-dev-Auth\rEveryoneCook-dev-Backend\rEveryoneCook-dev-Observability 3. Synthesize CloudFormation templates\n# Generate CloudFormation templates npx cdk synth --context environment=dev Output:\nSuccessfully synthesized to D:\\Project_AWS\\everyonecook\\infrastructure\\cdk.out\rSupply a stack id (EveryoneCook-dev-DNS, EveryoneCook-dev-Certificate, ...) to display its template. Thư mục cdk.out/ được tạo với CloudFormation templates:\ncdk.out/\r├── EveryoneCook-dev-DNS.template.json\r├── EveryoneCook-dev-Certificate.template.json\r├── EveryoneCook-dev-Core.template.json\r├── EveryoneCook-dev-Auth.template.json\r├── EveryoneCook-dev-Backend.template.json\r└── EveryoneCook-dev-Observability.template.json Bước 5: Xem lại tài nguyên Stack (Tùy chọn) Nếu bạn muốn xem chi tiết resources trong mỗi stack:\n1. Tài nguyên DNS Stack\n# Xem DNS stack template Get-Content cdk.out\\EveryoneCook-dev-DNS.template.json | ConvertFrom-Json | Select-Object -ExpandProperty Resources Resources:\nHostedZone: Route 53 Hosted Zone Outputs: Nameservers, Hosted Zone ID 2. Tài nguyên Certificate Stack\n# Xem Certificate stack template Get-Content cdk.out\\EveryoneCook-dev-Certificate.template.json | ConvertFrom-Json | Select-Object -ExpandProperty Resources Resources:\nCloudFrontCertificate: ACM Certificate cho CloudFront (cdn.everyonecook.cloud) ApiGatewayCertificate: Wildcard ACM Certificate (*.everyonecook.cloud) ValidationRecords: Route 53 DNS validation records 3. Tài nguyên Core Stack\nResources (30+ resources):\nDynamoDB Table với 5 GSI indexes S3 Buckets (2 buckets: content, cdn-logs) CloudFront Distribution với OAC KMS Keys (2 keys: DynamoDB, S3) IAM Roles và Policies 4. Tài nguyên Auth Stack\nResources (20+ resources):\nCognito User Pool với password policy Cognito User Pool Client Lambda Functions (5 triggers) IAM Roles cho Lambda functions 5. Tài nguyên Backend Stack\nResources (50+ resources):\nAPI Gateway REST API với custom domain Lambda Functions (6 modules + 1 worker) SQS Queues (4 queues + 4 DLQs) WAF Web ACL cho API Gateway Lambda Layer (shared dependencies) IAM Roles và Policies 6. Tài nguyên Observability Stack\nResources (15+ resources):\nCloudWatch Dashboards (4 dashboards) CloudWatch Alarms (10+ alarms) Composite Alarm cho overall health SNS Topic cho notifications Bước 6: Cấu hình chi tiết cho từng Stack Để tìm hiểu thêm về cấu hình và resources của từng stack, xem các phần sau:\n5.4.1 DNS Stack: Cấu hình Route 53 Hosted Zone 5.4.2 Certificate Stack: Cấu hình ACM Certificates 5.4.3 Core Stack: Cấu hình DynamoDB, S3, CloudFront 5.4.4 Auth Stack: Cấu hình Cognito, Lambda Triggers 5.4.5 Backend Stack: Cấu hình API Gateway, Lambda, SQS 5.4.7 Observability Stack: Cấu hình CloudWatch, Alarms Checklist cấu hình Trước khi triển khai, kiểm tra các mục sau:\nCấu hình Environment\nAWS Account ID đã được xác minh và cập nhật trong config/environment.ts Region được set đúng (ap-southeast-1 cho dev) Domain names được cấu hình đúng Dependencies\nNode.js và npm đã được cài đặt AWS CLI đã được cấu hình với credentials AWS CDK CLI đã được cài đặt globally npm dependencies đã được cài đặt (npm install) Validation\nTypeScript compilation thành công (npm run build) CDK list hiển thị tất cả 6 stacks CDK synth tạo CloudFormation templates thành công Không có lỗi syntax trong stack code Chuẩn bị Deployment\nCDK bootstrap đã được chạy (xem 5.03 CDK Bootstrap) AWS account có đủ permissions để tạo resources Domain đã được đăng ký (hoặc sẵn sàng đăng ký) Bước tiếp theo Sau khi hoàn thành cấu hình và validation, tiếp tục đến:\n5.05 Deploy Infrastructure - Triển khai tất cả stacks lên AWS\nTrong bước tiếp theo, bạn sẽ:\nDeploy DNS Stack và cấu hình nameservers Deploy Certificate Stack và validate certificates Deploy Core Stack (DynamoDB, S3, CloudFront) Deploy Auth Stack (Cognito, Lambda Triggers) Deploy Backend Stack (API Gateway, Lambda Functions) Deploy Observability Stack (CloudWatch Dashboards) "
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/1-worklog/1.4-week4/",
	"title": "Nhật ký Tuần 4",
	"tags": [],
	"description": "",
	"content": "Mục tiêu Tuần 4: Triển khai kiến trúc WordPress cấp độ sản xuất đảm bảo Tính khả dụng Cao (HA) và Khả năng Mở rộng bằng cách sử dụng Nhóm Tự động Mở rộng và CloudFront. Làm chủ quy trình Di chuyển Máy chủ bằng cách nhập/xuất Máy ảo (VM) giữa môi trường tại chỗ và AWS. Thực hiện Di chuyển Cơ sở dữ liệu toàn diện cho các nguồn không đồng nhất bằng cách sử dụng Công cụ Chuyển đổi Lược đồ AWS (SCT) và Dịch vụ Di chuyển Cơ sở dữ liệu (DMS). Nghiên cứu các chiến lược và công cụ di chuyển đám mây nâng cao (DataSync, MGN, Outposts). Nhiệm vụ cần thực hiện trong tuần này: Ngày Nhiệm vụ Ngày Bắt đầu Ngày Hoàn thành Tài liệu Tham khảo 2 WordPress trên AWS - Phần 1 (Triển khai) - Chuẩn bị Hạ tầng: VPC, Subnet, Nhóm Bảo mật cho Web \u0026amp; DB - Khởi chạy RDS Đa-AZ để đảm bảo tính khả dụng cao của cơ sở dữ liệu - Triển khai EC2 và cài đặt ứng dụng WordPress - Kết nối WordPress với phiên bản RDS 29/09/2025 29/09/2025 https://000021.awsstudygroup.com/ 3 WordPress trên AWS - Phần 2 (Mở rộng \u0026amp; CDN) - Tạo AMI từ phiên bản WordPress đã cấu hình - Thiết lập Nhóm Tự động Mở rộng (ASG) với Bộ Cân bằng Tải Ứng dụng - Tăng tốc phân phối nội dung bằng Amazon CloudFront - Thực hiện các thao tác Sao lưu (Snapshot) \u0026amp; Khôi phục Cơ sở dữ liệu - Dọn dẹp tài nguyên 30/09/2025 30/09/2025 https://000021.awsstudygroup.com/ 4 Di chuyển Máy chủ (Nhập/Xuất VM) - Triển khai Máy chủ Ứng dụng cục bộ (Mô phỏng Tại chỗ) - Nhập VM vào AWS: Xuất VM cục bộ, tải lên S3 và chuyển đổi thành AMI/EC2 - Xuất VM từ AWS: Xuất phiên bản EC2 trở lại S3 để sử dụng tại chỗ - Quản lý ACL S3 và vai trò CLI cho các tác vụ di chuyển 01/10/2025 01/10/2025 https://000014.awsstudygroup.com/ 5 Di chuyển Cơ sở dữ liệu (DMS \u0026amp; SCT) - Thiết lập Môi trường Di chuyển: Nguồn (Oracle/SQL Server) \u0026amp; Đích (Aurora/RDS) - Sử dụng Công cụ Chuyển đổi Lược đồ (SCT) để chuyển đổi lược đồ cơ sở dữ liệu - Cấu hình AWS DMS: + Tạo Phiên bản Sao chép \u0026amp; Điểm cuối + Chạy Tác vụ Di chuyển (Tải đầy đủ + CDC) - Khám phá DMS Serverless để tự động mở rộng sao chép 02/10/2025 02/10/2025 https://000043.awsstudygroup.com/ 6 Giám sát \u0026amp; Chiến lược Di chuyển Nâng cao - Giám sát DMS: Phân tích chỉ số CloudWatch, Thống kê Bảng và Nhật ký Tác vụ - Khắc phục sự cố: Chẩn đoán áp lực bộ nhớ và lỗi bảng trong quá trình di chuyển - Nghiên cứu: Khám phá các mẫu di chuyển sắp tới: + Dịch vụ Di chuyển Ứng dụng AWS (MGN) + AWS DataSync \u0026amp; Migration Hub + Di chuyển Container sang EKS 03/10/2025 03/10/2025 https://000043.awsstudygroup.com/ Tự học về AWS Migration Hub Thành tựu Tuần 4 Kiến trúc Web Có thể Mở rộng Triển khai thành công trang web WordPress có tính khả dụng cao bằng cách sử dụng RDS Đa-AZ và Nhóm Tự động Mở rộng. Cấu hình Bộ Cân bằng Tải Ứng dụng (ALB) để phân phối lưu lượng một cách động trên các phiên bản khỏe mạnh. Tối ưu hóa tốc độ phân phối nội dung toàn cầu bằng cách tích hợp Amazon CloudFront như một CDN. Triển khai các quy trình khôi phục thảm họa bằng cách sử dụng Ảnh chụp nhanh RDS và kỹ thuật khôi phục. Chuyên môn Di chuyển Máy chủ Có được kinh nghiệm thực hành với các phương pháp Nhập/Xuất VM. Di chuyển thành công máy ảo từ môi trường mô phỏng tại chỗ (VMware) sang AWS EC2. Thành thạo quy trình ngược lại để xuất phiên bản AWS EC2 đang hoạt động trở lại thành ảnh VM di động được lưu trữ trong S3. Cấu hình các vai trò IAM và quyền S3 cần thiết để tạo điều kiện truyền ảnh an toàn. Di chuyển \u0026amp; Hiện đại hóa Cơ sở dữ liệu Thực hiện di chuyển cơ sở dữ liệu không đồng nhất (ví dụ: SQL Server/Oracle sang Aurora) bằng AWS DMS. Sử dụng Công cụ Chuyển đổi Lược đồ AWS (SCT) để tự động hóa việc chuyển đổi lược đồ giữa các công cụ cơ sở dữ liệu khác nhau. Cấu hình Sao chép Dữ liệu Liên tục (CDC) để giữ cho cơ sở dữ liệu nguồn và đích đồng bộ với thời gian ngừng hoạt động tối thiểu. Thử nghiệm với DMS Serverless để xử lý khối lượng công việc di chuyển thay đổi tự động. Học cách giám sát tình trạng di chuyển bằng CloudWatch và khắc phục các sự cố phổ biến như áp lực bộ nhớ hoặc không khớp kiểu dữ liệu. "
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/3-blogstranslated/3.4-blog4/",
	"title": "Blog 4: Hướng dẫn cốt lõi về Quản trị Cloud tại AWS re:Invent 2025",
	"tags": [],
	"description": "",
	"content": "Tổng quan: Quản trị là Bệ phóng cho Đổi mới Tại AWS re:Invent 2025, chủ đề Quản trị đám mây (Cloud Governance) không còn bị xem là gánh nặng tuân thủ mà đã trở thành yếu tố chiến lược để thúc đẩy đổi mới. Track (nhóm chủ đề) về Cloud Governance năm nay tập trung vào việc thu hẹp khoảng cách giữa vận hành xuất sắc và đổi mới kinh doanh.\nBài viết này tổng hợp hướng dẫn tham gia các phiên quan trọng nhất, được chia thành 4 chủ đề chính phản ánh những thách thức cấp bách nhất hiện nay.\nCác Chủ đề Chính (Key Themes) Chương trình năm nay được tổ chức xoay quanh 4 trụ cột chính:\nGenerative AI \u0026amp; Intelligent Governance: Sử dụng AI để phân tích log, tự động hóa kiểm soát và chuyển từ quản trị phản ứng (reactive) sang chủ động (proactive). Operational Efficiency \u0026amp; Cost Optimization: Cân bằng giữa kiểm soát chặt chẽ và hiệu quả vận hành, tối ưu hóa chi phí giám sát. Secure Operations \u0026amp; Automation: Chuyển dịch từ tuân thủ dạng \u0026ldquo;checkbox\u0026rdquo; sang bảo vệ tự động, liên tục thông qua Policy-as-Code. Multicloud \u0026amp; Sovereign Cloud: Quản trị nhất quán trên nhiều môi trường cloud và đáp ứng các yêu cầu về chủ quyền dữ liệu (data sovereignty). Chi tiết các Phiên nổi bật (Featured Sessions) Dưới đây là danh sách các phiên \u0026ldquo;must-attend\u0026rdquo; (phải tham dự) được phân loại theo chủ đề để bạn dễ dàng lên lịch trình học tập.\n1. Generative AI \u0026amp; Quản trị Thông minh Cách mạng hóa quy trình quản trị bằng AI để giảm thiểu thao tác thủ công.\nCOP350 | Building and validating cloud controls with generative AI: (Breakout) Hướng dẫn kỹ thuật về cách dùng GenAI để tùy chỉnh AWS Control Tower, viết rule cho AWS Config và phân tích log CloudTrail. COP411 | Intelligent automation for managing cloud governance: (Builders session) Thực hành xây dựng workflow thông minh phân tích dữ liệu từ Config, Security Hub để đưa ra các insights dựa trên ngữ cảnh. 2. Hiệu quả Vận hành \u0026amp; Tối ưu Chi phí Xây dựng khung quản trị giúp doanh nghiệp linh hoạt (agile) nhưng vẫn tiết kiệm.\nCOP355 | A practical guide to implement cost-effective governance controls: (Chalk talk) Chiến lược giảm chi phí giám sát (monitoring costs) mà vẫn đảm bảo an toàn, sử dụng Config và CloudTrail. COP351 | Innovation Sandbox on AWS: (Lightning Talk) Tự động hóa việc tạo và hủy các môi trường sandbox tạm thời để kiểm soát chi phí và bảo mật. COP324 | Moving AWS Accounts seamlessly at scale: (Chalk talk) Hướng dẫn di chuyển tài khoản AWS an toàn trong các trường hợp sáp nhập, mua lại doanh nghiệp (M\u0026amp;A). 3. Vận hành An toàn \u0026amp; Tự động hóa Áp dụng Policy-as-Code và kiểm tra tuân thủ liên tục.\nCOP347 | Actionable controls for improving governance and compliance: (Breakout) Biến các khung tuân thủ thành các AWS controls thực tế bằng Control Tower và Audit Manager. COP352 | From Reactive to Proactive: Infrastructure governance by design: (Code talk) Sử dụng CloudFormation Guard và Hooks để chặn các deployment không tuân thủ ngay từ đầu. COP406 | Build and automate policy as code: (Builders session) Thực hành xây dựng pipeline Policy-as-Code với các bước kiểm tra bảo mật tự động (shift-left security). 4. Multicloud \u0026amp; Sovereign Cloud Giải quyết các yêu cầu phức tạp về chủ quyền dữ liệu và đa đám mây.\nCOP409 | Building Sovereign Cloud Environments: (Code talk) Cách Control Tower hỗ trợ các yêu cầu chủ quyền dữ liệu, kiểm soát di chuyển dữ liệu qua biên giới. COP349 | Balancing agility and compliance feat. The Japan Digital Agency: (Breakout) Case study về Chính phủ Nhật Bản quản lý quản trị tập trung cho 30 bộ ngành và 5,000 tài khoản AWS. COP346 | Governance that Enables Innovation at Scale feat. Eli Lilly: (Breakout) Case study về hãng dược Eli Lilly hiện đại hóa quản trị với Control Tower mà không gây gián đoạn hoạt động (zero downtime). Kết luận Các phiên họp năm nay nhấn mạnh sự chuyển dịch cơ bản trong vận hành cloud:\nTích hợp Generative AI vào quy trình quản trị. Nhấn mạnh vào Policy-as-Code. Chuyển từ kiểm soát phản ứng (reactive) sang chủ động (proactive). Tham gia các phiên này sẽ giúp bạn trang bị kiến thức để dẫn dắt quá trình chuyển đổi số an toàn và hiệu quả cho tổ chức.\nTác giả David Sokolik\rDavid Sokolik is an Enterprise Support Technical Account Manager at Amazon Web Services based out of Tel Aviv, Israel. With over a decade of IT and cloud experience, David is a dedicated team member and advocate for his customers for building scalable, resilient and cost-effective solutions. David enjoys spending time with his family and friends traveling the world and exploring local cuisines.\n"
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/4-eventparticipated/",
	"title": "Các events đã tham gia",
	"tags": [],
	"description": "",
	"content": "Trong thời gian thực tập, tôi có cơ hội tham gia ba sự kiện khác nhau, mỗi sự kiện đều mang đến những kiến thức giá trị, trải nghiệm thú vị và những khoảnh khắc đáng nhớ. Những hoạt động này không chỉ làm phong phú thêm quá trình học tập của tôi mà còn kèm theo những món quà ý nghĩa, góp phần khiến hành trình trở nên trọn vẹn hơn.\nEvent 1 Tên sự kiện: The First Cloud Journey (FCJ) Program Kick-off\nThời gian: 08:30 ngày 06/09/2025\nĐịa điểm: Tầng 26, tòa nhà Bitexco, số 02 đường Hải Triều, phường Sài Gòn, thành phố Hồ Chí Minh\nVai trò trong sự kiện: Người tham dự\nEvent 2 Tên sự kiện: AWS Cloud Mastery Series #1 — AI/ML/GenAI on AWS\nThời gian: 08:30 ngày 15/11/2025\nĐịa điểm: Tầng 26, tòa nhà Bitexco, số 02 đường Hải Triều, phường Sài Gòn, thành phố Hồ Chí Minh\nVai trò trong sự kiện: Người tham dự\nEvent 3 Tên sự kiện: AWS Cloud Mastery Series #2: DevOps on AWS\nThời gian: 08:30 ngày 17/11/2025\nĐịa điểm: Tầng 26, tòa nhà Bitexco, số 02 đường Hải Triều, phường Sài Gòn, thành phố Hồ Chí Minh\nVai trò trong sự kiện: Người tham dự\n"
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/5-workshop/5.04-configure-stacks/5.4.4-auth-stack/",
	"title": "5.4.4 Auth Stack",
	"tags": [],
	"description": "",
	"content": " Auth Stack - Xác Thực \u0026amp; Quản Lý Người Dùng Tổng Quan Auth Stack là tầng xác thực Phase 3 của dự án EveryoneCook. Nó quản lý xác thực người dùng, đăng ký và bảo mật tài khoản bằng AWS Cognito với các Lambda trigger tùy chỉnh để nâng cao trải nghiệm người dùng.\nThứ Tự Triển Khai: Stack này BẮT BUỘC phải được triển khai sau Core Stack và trước Backend Stack.\nTrách Nhiệm Chính Tạo Cognito User Pool với các thiết lập bảo mật cấp production Cấu hình Cognito User Pool Client cho ứng dụng web Thiết lập 5 Lambda triggers cho các quy trình xác thực tùy chỉnh Quản lý đăng ký người dùng, xác minh email và quy trình đăng nhập Xử lý tạo hồ sơ người dùng trong DynamoDB (qua PostConfirmation trigger) Những Gì Stack Này Bao Gồm Cognito User Pool:\nĐăng nhập: Username hoặc email Chính sách mật khẩu: Tối thiểu 12 ký tự (8 cho dev), chữ hoa, chữ thường, chữ số, ký hiệu Yêu cầu xác minh email MFA: Tắt (chỉ email + mật khẩu) Device tracking: Bật (không có MFA challenge) Thuộc tính chuẩn: username, email, given_name (fullName) Thuộc tính tùy chỉnh: account_status, country Cognito User Pool Client:\nAuth flows: USER_PASSWORD_AUTH, USER_SRP_AUTH OAuth flows: Authorization code grant (social login trong tương lai) Token validity: Access/ID (1h), Refresh (30 ngày) Callback URLs: Theo từng environment Lambda Triggers (5 triggers):\nPreSignUp: Dọn dẹp người dùng chưa xác minh (hết hạn 24h) CustomMessage: Tùy chỉnh email templates PostConfirmation: Tạo hồ sơ người dùng trong DynamoDB PreAuthentication: Kiểm tra nếu người dùng bị cấm/tạm ngưng PostAuthentication: Cập nhật timestamp đăng nhập cuối cùng Kiến Trúc ┌─────────────────────────────────────────────────────────────────┐\r│ Auth Stack (Phase 3) │\r│ │\r│ ┌──────────────────────────────────────────────────────────┐ │\r│ │ Cognito User Pool │ │\r│ │ ├─ Đăng nhập: Username hoặc Email │ │\r│ │ ├─ Mật khẩu: Tối thiểu 12 ký tự, chính sách mạnh │ │\r│ │ ├─ Xác minh Email: Bắt buộc │ │\r│ │ ├─ MFA: Tắt (chỉ email + mật khẩu) │ │\r│ │ ├─ Device Tracking: Bật (không có MFA) │ │\r│ │ └─ Thuộc tính tùy chỉnh: account_status, country │ │\r│ └──────────────────────────────────────────────────────────┘ │\r│ │ │\r│ ▼ │\r│ ┌──────────────────────────────────────────────────────────┐ │\r│ │ Lambda Triggers (Quy trình tùy chỉnh) │ │\r│ │ │ │\r│ │ 1️⃣ PreSignUp │ │\r│ │ ├─ Kiểm tra username/email tồn tại │ │\r│ │ ├─ Xóa người dùng chưa xác minh hết hạn (\u0026gt;24h) │ │\r│ │ └─ Cho phép đăng ký mới │ │\r│ │ │ │\r│ │ 2️⃣ CustomMessage │ │\r│ │ ├─ Tùy chỉnh template xác minh email │ │\r│ │ ├─ Tùy chỉnh template đặt lại mật khẩu │ │\r│ │ └─ Thêm styling và branding │ │\r│ │ │ │\r│ │ 3️⃣ PostConfirmation │ │\r│ │ ├─ Tạo DynamoDB entities: │ │\r│ │ │ ├─ Core Profile (PK=USER#{userId}, SK=PROFILE) │ │\r│ │ │ ├─ Privacy Settings (SK=PRIVACY_SETTINGS) │ │\r│ │ │ └─ AI Preferences (SK=AI_PREFERENCES) │ │\r│ │ └─ Khởi tạo dữ liệu người dùng │ │\r│ │ │ │\r│ │ 4️⃣ PreAuthentication │ │\r│ │ ├─ Kiểm tra trạng thái tài khoản │ │\r│ │ ├─ Từ chối nếu bị cấm/tạm ngưng │ │\r│ │ └─ Cho phép đăng nhập nếu active │ │\r│ │ │ │\r│ │ 5️⃣ PostAuthentication │ │\r│ │ ├─ Cập nhật timestamp lastLoginAt │ │\r│ │ └─ Theo dõi hoạt động người dùng │ │\r│ └──────────────────────────────────────────────────────────┘ │\r│ │ │\r│ ▼ │\r│ ┌──────────────────────────────────────────────────────────┐ │\r│ │ Cognito User Pool Client │ │\r│ │ ├─ Client Type: Web (không có secret) │ │\r│ │ ├─ Auth Flows: Password, SRP │ │\r│ │ ├─ OAuth: Authorization code grant │ │\r│ │ ├─ Tokens: 1h access, 1h ID, 30d refresh │ │\r│ │ ├─ Callback: https://{env}.everyonecook.cloud │ │\r│ │ └─ Security: Token revocation, user enum protection │ │\r│ └──────────────────────────────────────────────────────────┘ │\r└─────────────────────────────────────────────────────────────────┘\r│\r│ Exports\r▼\rBackend Stack\r(API Gateway Cognito Authorizer) Cấu Hình Stack Cấu Trúc File infrastructure/lib/stacks/\r└── auth-stack.ts # Auth Stack (865 dòng)\rservices/auth-module/triggers/\r├── pre-signup.ts # PreSignUp trigger\r├── custom-message.ts # CustomMessage trigger\r├── post-confirmation.ts # PostConfirmation trigger\r├── pre-authentication.ts # PreAuthentication trigger\r└── post-authentication.ts # PostAuthentication trigger Điểm Nổi Bật Trong Triển Khai Code File: infrastructure/lib/stacks/auth-stack.ts\n1. Tạo Cognito User Pool /** * Tạo Cognito User Pool với bảo mật cấp production */ private createUserPool(): cdk.aws_cognito.UserPool { const cognitoConfig = this.config.cognito; const userPool = new cdk.aws_cognito.UserPool(this, \u0026#39;UserPool\u0026#39;, { userPoolName: `EveryoneCook-${this.config.environment}`, // Cấu hình đăng nhập signInAliases: { username: true, email: true, }, // Cho phép tự đăng ký selfSignUpEnabled: true, // Thuộc tính chuẩn standardAttributes: { email: { required: true, mutable: false, // Email không thể thay đổi }, givenName: { required: true, // fullName được lưu trong given_name mutable: true, }, birthdate: { required: false, mutable: true }, gender: { required: false, mutable: true }, }, // Thuộc tính tùy chỉnh customAttributes: { account_status: new cdk.aws_cognito.StringAttribute({ mutable: true, minLen: 1, maxLen: 20, }), country: new cdk.aws_cognito.StringAttribute({ mutable: true, minLen: 2, maxLen: 2, // ISO 3166-1 alpha-2 }), }, // Chính sách mật khẩu passwordPolicy: { minLength: 12, // 8 cho dev requireLowercase: true, requireUppercase: true, requireDigits: true, requireSymbols: true, tempPasswordValidity: cdk.Duration.days(7), }, // Khôi phục tài khoản accountRecovery: cdk.aws_cognito.AccountRecovery.EMAIL_ONLY, // Cấu hình email (Cognito mặc định) email: cdk.aws_cognito.UserPoolEmail.withCognito(), // Tự động xác minh email autoVerify: { email: true }, // MFA: Tắt mfa: cdk.aws_cognito.Mfa.OFF, // Device tracking (không có MFA challenge) deviceTracking: { challengeRequiredOnNewDevice: false, deviceOnlyRememberedOnUserPrompt: true, }, // Email templates userVerification: { emailSubject: \u0026#39;🍳 Xác minh tài khoản Everyone Cook của bạn\u0026#39;, emailBody: \u0026#39;Xin chào {username}, mã xác minh của bạn là: {####}\u0026#39;, emailStyle: cdk.aws_cognito.VerificationEmailStyle.CODE, }, // Deletion protection cho production deletionProtection: this.config.environment === \u0026#39;prod\u0026#39;, }); return userPool; } 2. Lambda Triggers /** * Tạo PostConfirmation Lambda Trigger * * Tạo 3 DynamoDB entities sau khi xác minh email: * 1. Core Profile (PK=USER#{userId}, SK=PROFILE) * 2. Privacy Settings (SK=PRIVACY_SETTINGS) * 3. AI Preferences (SK=AI_PREFERENCES) */ private createPostConfirmationTrigger( dynamoTable: cdk.aws_dynamodb.ITable ): cdk.aws_lambda.Function { const trigger = new cdk.aws_lambda.Function(this, \u0026#39;PostConfirmationTrigger\u0026#39;, { functionName: `EveryoneCook-${this.config.environment}-PostConfirmation`, runtime: cdk.aws_lambda.Runtime.NODEJS_20_X, handler: \u0026#39;post-confirmation.handler\u0026#39;, code: cdk.aws_lambda.Code.fromAsset( path.join(__dirname, \u0026#39;../../../services/auth-module/triggers/dist\u0026#39;) ), memorySize: 512, timeout: cdk.Duration.seconds(30), environment: { DYNAMODB_TABLE_NAME: dynamoTable.tableName, ENVIRONMENT: this.config.environment, }, }); // Cấp quyền ghi DynamoDB dynamoTable.grantReadWriteData(trigger); return trigger; } /** * Tạo PreSignUp Lambda Trigger * * Xử lý dọn dẹp người dùng chưa xác minh: * - Nếu user tồn tại và UNCONFIRMED \u0026gt;24h → xóa và cho phép đăng ký mới * - Nếu user tồn tại và UNCONFIRMED \u0026lt;24h → từ chối với thông báo \u0026#34;chờ 24h\u0026#34; * - Nếu user không tồn tại → cho phép đăng ký */ private createPreSignUpTrigger(): cdk.aws_lambda.Function { const trigger = new cdk.aws_lambda.Function(this, \u0026#39;PreSignUpTrigger\u0026#39;, { functionName: `EveryoneCook-${this.config.environment}-PreSignUp`, runtime: cdk.aws_lambda.Runtime.NODEJS_20_X, handler: \u0026#39;pre-signup.handler\u0026#39;, code: cdk.aws_lambda.Code.fromAsset( path.join(__dirname, \u0026#39;../../../services/auth-module/triggers/dist\u0026#39;) ), memorySize: 256, timeout: cdk.Duration.seconds(10), }); // Cấp quyền Cognito trigger.addToRolePolicy( new cdk.aws_iam.PolicyStatement({ effect: cdk.aws_iam.Effect.ALLOW, actions: [\u0026#39;cognito-idp:ListUsers\u0026#39;, \u0026#39;cognito-idp:AdminDeleteUser\u0026#39;], resources: [`arn:aws:cognito-idp:${this.region}:${this.account}:userpool/*`], }) ); return trigger; } 3. User Pool Client /** * Tạo Cognito User Pool Client cho ứng dụng web */ private createUserPoolClient(): cdk.aws_cognito.UserPoolClient { const callbackUrls = this.getCallbackUrls(); const logoutUrls = this.getLogoutUrls(); const userPoolClient = new cdk.aws_cognito.UserPoolClient( this, \u0026#39;UserPoolClient\u0026#39;, { userPoolClientName: `EveryoneCook-Web-Client-${this.config.environment}`, userPool: this.userPool, // Auth flows authFlows: { userPassword: true, // USER_PASSWORD_AUTH userSrp: true, // USER_SRP_AUTH (Secure Remote Password) custom: false, adminUserPassword: false, }, // Cấu hình OAuth (social login trong tương lai) oAuth: { flows: { authorizationCodeGrant: true, implicitCodeGrant: false, clientCredentials: false, }, scopes: [ cdk.aws_cognito.OAuthScope.EMAIL, cdk.aws_cognito.OAuthScope.OPENID, cdk.aws_cognito.OAuthScope.PROFILE, ], callbackUrls: callbackUrls, logoutUrls: logoutUrls, }, // Token validity accessTokenValidity: cdk.Duration.hours(1), idTokenValidity: cdk.Duration.hours(1), refreshTokenValidity: cdk.Duration.days(30), // Read attributes readAttributes: new cdk.aws_cognito.ClientAttributes() .withStandardAttributes({ email: true, emailVerified: true, givenName: true, }) .withCustomAttributes(\u0026#39;account_status\u0026#39;, \u0026#39;country\u0026#39;), // Thiết lập bảo mật preventUserExistenceErrors: true, // Ngăn enumeration attacks enableTokenRevocation: true, // Cho phép thu hồi token generateSecret: false, // Không có secret cho web apps } ); return userPoolClient; } Chi Tiết Cấu Hình Chính 1. Quy Trình Đăng Ký Người Dùng Quy Trình Đăng Ký:\n1. Người dùng đăng ký → PreSignUp trigger\r├─ Kiểm tra nếu username/email tồn tại\r├─ Nếu UNCONFIRMED \u0026gt;24h: Xóa user cũ\r├─ Nếu UNCONFIRMED \u0026lt;24h: Từ chối với \u0026#34;chờ 24h\u0026#34;\r└─ Cho phép đăng ký\r2. Người dùng nhận email xác minh → CustomMessage trigger\r├─ Tùy chỉnh email template\r└─ Gửi mã xác minh\r3. Người dùng xác minh email → PostConfirmation trigger\r├─ Tạo DynamoDB entities:\r│ ├─ Core Profile (username, email, fullName, v.v.)\r│ ├─ Privacy Settings (mặc định: private)\r│ └─ AI Preferences (thiết lập mặc định)\r└─ Tài khoản người dùng sẵn sàng\r4. Người dùng đăng nhập → PreAuthentication trigger\r├─ Kiểm tra account_status\r├─ Nếu banned/suspended: Từ chối đăng nhập\r└─ Cho phép đăng nhập\r5. Đăng nhập thành công → PostAuthentication trigger\r└─ Cập nhật timestamp lastLoginAt 2. Chính Sách Mật Khẩu Environments:\nEnvironment Độ dài tối thiểu Yêu cầu Dev 8 ký tự Chữ hoa, chữ thường, chữ số, ký hiệu Staging 12 ký tự Chữ hoa, chữ thường, chữ số, ký hiệu Prod 12 ký tự Chữ hoa, chữ thường, chữ số, ký hiệu Ví dụ Mật Khẩu Hợp Lệ:\nMyP@ssw0rd123 (12 ký tự) Str0ng!Pass (11 ký tự, không hợp lệ cho prod/staging) 3. Token Validity Loại Token Validity Mục đích Access Token 1 giờ API authorization ID Token 1 giờ User identity claims Refresh Token 30 ngày Gia hạn access/ID tokens Quy Trình Refresh Token:\nAccess token hết hạn (1h) → Dùng refresh token → Nhận access/ID tokens mới\rRefresh token hết hạn (30d) → Người dùng phải đăng nhập lại 4. Chi Tiết Lambda Trigger PreSignUp Trigger Mục đích: Ngăn lỗi \u0026ldquo;username đã được sử dụng\u0026rdquo; cho người dùng chưa xác minh\nLogic:\nif (userExists \u0026amp;\u0026amp; userStatus === \u0026#39;UNCONFIRMED\u0026#39;) { const hoursSinceCreation = (now - userCreationDate) / (1000 * 60 * 60); if (hoursSinceCreation \u0026gt; 24) { // Xóa user chưa xác minh đã hết hạn await deleteUser(username); return allowSignUp(); } else { // User vẫn còn thời gian để xác minh return rejectSignUp(`Vui lòng chờ ${24 - hoursSinceCreation}h để đăng ký lại`); } } else { return allowSignUp(); } PostConfirmation Trigger DynamoDB Entities Được Tạo:\n// 1. Core Profile { PK: \u0026#34;USER#{userId}\u0026#34;, SK: \u0026#34;PROFILE\u0026#34;, username: \u0026#34;john_doe\u0026#34;, email: \u0026#34;john@example.com\u0026#34;, fullName: \u0026#34;John Doe\u0026#34;, account_status: \u0026#34;active\u0026#34;, createdAt: \u0026#34;2025-01-01T00:00:00Z\u0026#34;, // ... các field khác } // 2. Privacy Settings { PK: \u0026#34;USER#{userId}\u0026#34;, SK: \u0026#34;PRIVACY_SETTINGS\u0026#34;, profileVisibility: \u0026#34;private\u0026#34;, showEmail: false, allowMessages: \u0026#34;friends\u0026#34;, // ... các settings khác } // 3. AI Preferences { PK: \u0026#34;USER#{userId}\u0026#34;, SK: \u0026#34;AI_PREFERENCES\u0026#34;, aiEnabled: true, preferredLanguage: \u0026#34;en\u0026#34;, dietaryRestrictions: [], // ... các preferences khác } Stack Outputs Sau khi triển khai, stack export các giá trị sau:\nOutput Name Value Được sử dụng bởi UserPoolId ap-southeast-1_XXXXXXXXX Backend Stack (Authorizer) UserPoolArn arn:aws:cognito-idp:... Lambda IAM policies UserPoolClientId 1234567890abcdef Frontend (Amplify config) CustomMessageFunctionArn arn:aws:lambda:... Monitoring PostConfirmationFunctionArn arn:aws:lambda:... Monitoring PreAuthenticationFunctionArn arn:aws:lambda:... Monitoring PostAuthenticationFunctionArn arn:aws:lambda:... Monitoring Các Bước Triển Khai Bước 1: Build Lambda Triggers Trước khi triển khai, biên dịch Lambda triggers sang JavaScript:\ncd D:\\Project_AWS\\everyonecook\\services\\auth-module\\triggers # Cài đặt dependencies npm install # Build TypeScript sang JavaScript npm run build Kết quả mong đợi:\n\u0026gt; auth-module-triggers@1.0.0 build\r\u0026gt; tsc\rCompiled successfully to dist/ Bước 2: Xác Minh Điều Kiện Tiên Quyết Core Stack đã triển khai thành công DynamoDB table tồn tại Lambda triggers đã build vào thư mục dist/ Bước 3: Triển Khai Auth Stack Di chuyển đến thư mục infrastructure:\ncd D:\\Project_AWS\\everyonecook\\infrastructure Triển khai Auth Stack đến ap-southeast-1:\n# Triển khai Auth Stack npx cdk deploy EveryoneCook-dev-Auth --context environment=dev Kết quả mong đợi:\n✨ Synthesis time: 7.23s\rEveryoneCook-dev-Auth: deploying...\r[████████████████████████████████████████] (9/9)\rEveryoneCook-dev-Auth: creating CloudFormation changeset...\rEveryoneCook-dev-Auth\r✨ Deployment time: 180.45s\rOutputs:\rEveryoneCook-dev-Auth.UserPoolId = ap-southeast-1_a1B2c3D4e\rEveryoneCook-dev-Auth.UserPoolClientId = 1a2b3c4d5e6f7g8h9i0j\rEveryoneCook-dev-Auth.UserPoolArn = arn:aws:cognito-idp:ap-southeast-1:616580903213:userpool/...\rEveryoneCook-dev-Auth.PostConfirmationFunctionArn = arn:aws:lambda:ap-southeast-1:...\rEveryoneCook-dev-Auth.PreAuthenticationFunctionArn = arn:aws:lambda:ap-southeast-1:...\rStack ARN:\rarn:aws:cloudformation:ap-southeast-1:616580903213:stack/EveryoneCook-dev-Auth/... Bước 4: Xác Minh trong AWS Console Điều hướng đến Cognito User Pool Mở AWS Console → region ap-southeast-1 Đi đến Amazon Cognito \u0026gt; User pools Tìm EveryoneCook-dev Cognito User Pool hiển thị tùy chọn đăng nhập (username/email), MFA disabled, password policy, và deletion protection\nXác minh:\nĐăng nhập: Username hoặc Email MFA: Disabled Password policy: Đã cấu hình Email verification: Required Xác Minh Cấu Hình User Pool Click vào User Pool để xem chi tiết:\nCấu hình User Pool hiển thị authentication settings, attributes, password policy, và security features\nKiểm tra:\nSign-in experience: Username và Email enabled User attributes: email, given_name (bắt buộc), birthdate, gender (tùy chọn) Custom attributes: account_status, country Password policy: Tối thiểu 12 ký tự, yêu cầu chữ hoa, chữ thường, chữ số, ký hiệu MFA: Off Device tracking: Enabled Xác Minh Lambda Triggers Đi đến User pool properties \u0026gt; Lambda triggers:\nLambda triggers được cấu hình cho Pre sign-up, Custom message, Post confirmation, Pre authentication, và Post authentication\nXác minh 5 triggers:\nPre sign-up: EveryoneCook-dev-PreSignUp Custom message: EveryoneCook-dev-CustomMessage Post confirmation: EveryoneCook-dev-PostConfirmation Pre authentication: EveryoneCook-dev-PreAuthentication Post authentication: EveryoneCook-dev-PostAuthentication Xác Minh User Pool Client Đi đến App integration \u0026gt; App clients:\nUser Pool Client hiển thị auth flows, OAuth settings, token validity, callback URLs, và security settings\nXác minh:\nClient type: Public (không có secret) Auth flows: USER_PASSWORD_AUTH, USER_SRP_AUTH OAuth flows: Authorization code grant Callback URLs: Theo environment Token validity: 1h access, 1h ID, 30d refresh Điều hướng đến Lambda Functions Đi đến Lambda \u0026gt; Functions, tìm Auth triggers:\nLambda functions hiển thị tất cả 5 Cognito triggers với runtime Node.js 20.x, memory 256-512 MB, và timeout 10-30s\nXác minh:\nTất cả 5 Lambda functions đã tạo Runtime: Node.js 20.x Environment variables đã cấu hình CloudWatch log groups đã tạo Kiểm Tra Lambda Permissions Click vào Lambda function → Configuration \u0026gt; Permissions:\nLambda execution role hiển thị permissions cho DynamoDB (PostConfirmation), Cognito (PreSignUp), và CloudWatch Logs\nQuyền mong đợi:\nPostConfirmation: DynamoDB read/write PreAuthentication: DynamoDB read PostAuthentication: DynamoDB read/write PreSignUp: Cognito ListUsers, AdminDeleteUser Tất cả triggers: CloudWatch Logs write Chi Tiết Chi Phí Chi Phí Hàng Tháng (Dev Environment) Tài nguyên Cấu hình Chi phí hàng tháng Ghi chú Cognito User Pool \u0026lt;50 MAU $0 50K MAU đầu miễn phí Lambda Triggers 5 functions, low invocations $0-1 Free tier bao phủ hầu hết CloudWatch Logs 7-day retention, 5 log groups $0.50 ~1GB logs Tổng (Ước tính) ~$0.50-1.50/tháng Rất thấp cho dev Ghi Chú Chi Phí Cognito: 50,000 MAU đầu miễn phí, sau đó $0.0055/MAU Lambda: 1M requests/tháng miễn phí, sau đó $0.20 per 1M CloudWatch Logs: $0.50/GB ingested, $0.03/GB stored Không có phí MFA: MFA tắt tiết kiệm $0.05/MAU Ước Tính Production (1000 MAU):\nCognito: 1000 MAU × $0.0055 = $5.50/tháng Lambda triggers: ~5000 invocations/tháng = $0 (free tier) CloudWatch Logs: $1-2/tháng Tổng: ~$7-8/tháng Cross-Stack Dependencies Import từ Các Stack Trước Từ Core Stack:\ndynamoTable: cdk.Fn.importValue(\u0026#39;EveryoneCook-dev-DynamoDBTableName\u0026#39;) Export Được Sử Dụng Bởi Các Stack Khác Backend Stack import:\nUser Pool ID (cho Cognito Authorizer) User Pool ARN (cho API Gateway) User Pool Client ID (cho frontend config) Luồng Dependency Core Stack → DynamoDB Table\r│\r▼\rAuth Stack (tạo Cognito + Lambda triggers)\r│\r├─► User Pool ID → Backend Stack (API Gateway Authorizer)\r├─► User Pool Client ID → Frontend (Amplify config)\r└─► Lambda triggers → Quy trình quản lý người dùng Danh Sách Kiểm Tra Xác Thực Trước khi tiến hành triển khai Backend Stack:\nAuth Stack đã triển khai thành công đến ap-southeast-1 Cognito User Pool tồn tại với các thiết lập chính xác 5 Lambda triggers đã cấu hình và gắn kết User Pool Client đã tạo với OAuth settings Lambda functions có đúng IAM permissions CloudWatch log groups đã tạo (7-day retention) Stack outputs đã export thành công Lambda trigger code đã build vào thư mục dist/ Kiểm Tra Kiểm Tra Quy Trình Đăng Ký Người Dùng Kiểm tra sign-up với Cognito console:\nĐi đến Cognito \u0026gt; User pools \u0026gt; EveryoneCook-dev \u0026gt; Users \u0026gt; Create user\nTạo test user:\nUsername: testuser01\rEmail: your-email@example.com\rFull Name: Test User\rTemporary Password: TempP@ss123 Xác minh email đã gửi:\nKiểm tra email của bạn để nhận mã xác minh.\nKiểm tra Lambda logs:\n# Xem PostConfirmation logs aws logs tail /aws/lambda/EveryoneCook-dev-PostConfirmation --follow --region ap-southeast-1 Xác minh DynamoDB entries:\n# Truy vấn user profile aws dynamodb query ` --table-name EveryoneCook-dev-v2 ` --key-condition-expression \u0026#34;PK = :pk\u0026#34; ` --expression-attribute-values \u0026#39;{\u0026#34;:pk\u0026#34;:{\u0026#34;S\u0026#34;:\u0026#34;USER#testuser01\u0026#34;}}\u0026#39; ` --region ap-southeast-1 Mong đợi: 3 items (PROFILE, PRIVACY_SETTINGS, AI_PREFERENCES)\nKiểm Tra Quy Trình Xác Thực Đăng nhập với test user:\nSử dụng AWS CLI để xác thực:\naws cognito-idp initiate-auth ` --auth-flow USER_PASSWORD_AUTH ` --client-id \u0026lt;USER_POOL_CLIENT_ID\u0026gt; ` --auth-parameters USERNAME=testuser01,PASSWORD=\u0026lt;password\u0026gt; ` --region ap-southeast-1 Kiểm tra PreAuthentication logs:\naws logs tail /aws/lambda/EveryoneCook-dev-PreAuthentication --follow --region ap-southeast-1 Kiểm tra PostAuthentication logs:\naws logs tail /aws/lambda/EveryoneCook-dev-PostAuthentication --follow --region ap-southeast-1 Kiểm Tra PreSignUp Cleanup Tạo unverified user:\nĐăng ký user nhưng không xác minh email.\nChờ 24 giờ (hoặc sửa trigger code thành 1 phút để kiểm tra)\nThử đăng ký lại với cùng username:\nPreSignUp trigger nên xóa user cũ và cho phép đăng ký mới.\nCác Bước Tiếp Theo Sau khi triển khai thành công Auth Stack:\n➡️ 5.4.5 Backend Stack - Tạo API Gateway, Lambda functions, và SQS queues\nBackend Stack sẽ:\nTạo API Gateway REST API với Cognito Authorizer Tạo 5 Lambda functions (auth, social, recipe, AI, admin) Tạo 6 SQS queues cho async processing Tạo 6 worker Lambda functions Import User Pool ID từ Auth Stack Cấu hình API Gateway custom domain Tài Liệu Tham Khảo Mã nguồn: infrastructure/lib/stacks/auth-stack.ts Lambda Triggers: services/auth-module/triggers/ Base Stack: infrastructure/lib/base-stack.ts Environment Config: infrastructure/config/environment.ts Tài liệu AWS: Cognito User Pools Cognito Lambda Triggers Cognito User Pool Client Password Policies "
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/5-workshop/5.05-deploy-infrastructure/",
	"title": "Triển khai Hạ tầng",
	"tags": [],
	"description": "",
	"content": "Tổng quan Trong bước này, bạn sẽ deploy tất cả infrastructure stacks lên AWS theo đúng thứ tự dependencies. Dự án EveryoneCook sử dụng 5-Stack Architecture với AWS CDK.\n5-Stack Architecture Phase 1: DNS Stack → Route 53 Hosted Zone\rPhase 1.5: Certificate Stack → ACM Certificates (us-east-1)\rPhase 2: Core Stack → DynamoDB, S3, CloudFront, KMS\rPhase 3: Auth Stack → Cognito, SES, Lambda Triggers\rPhase 4: Backend Stack → API Gateway, Lambda, SQS, WAF\rPhase 5: Observability Stack → CloudWatch Dashboards \u0026amp; Alarms Stack Dependencies DNS Stack (không có dependencies)\r↓\rCertificate Stack (phụ thuộc vào DNS)\r↓\rCore Stack (phụ thuộc vào Certificate)\r↓\rAuth Stack (phụ thuộc vào Core)\r↓\rBackend Stack (phụ thuộc vào Auth, Core)\r↓\rObservability Stack (phụ thuộc vào Backend) Thời gian Triển khai Stack Thời gian Tài nguyên Quan trọng DNS Stack 2-3 phút Route 53 Hosted Zone Certificate Stack 5-10 phút ACM Certificate (DNS validation) Core Stack 10-15 phút CloudFront Distribution, DynamoDB Auth Stack 5-7 phút Cognito User Pool, SES Backend Stack 8-12 phút API Gateway, 7 Lambda Functions Observability Stack 3-5 phút CloudWatch Dashboards Tổng thời gian triển khai: 35-50 phút\nYêu cầu Tiên quyết 1. Xác minh AWS Credentials # Kiểm tra AWS credentials aws sts get-caller-identity # Kết quả mong đợi: # { # \u0026#34;UserId\u0026#34;: \u0026#34;...\u0026#34;, # \u0026#34;Account\u0026#34;: \u0026#34;616580903213\u0026#34;, # \u0026#34;Arn\u0026#34;: \u0026#34;arn:aws:iam::616580903213:user/your-username\u0026#34; # } 2. Xác minh Node.js \u0026amp; CDK # Kiểm tra phiên bản Node.js (phải là 20.x+) node -v # v20.11.0 hoặc cao hơn # Kiểm tra phiên bản CDK cdk --version # 2.114.0 hoặc cao hơn 3. Di chuyển đến Infrastructure # Di chuyển đến thư mục infrastructure cd D:\\Project_AWS\\everyonecook\\infrastructure # Xác minh cdk.json tồn tại Get-Item cdk.json Phase 1: Deploy DNS Stack (Route 53) DNS Stack tạo Route 53 Hosted Zone cho domain everyonecook.cloud. Đây là stack đầu tiên và quan trọng nhất.\nBước 1.1: Deploy DNS Stack # Deploy DNS Stack npx cdk deploy EveryoneCook-dev-DNS --context environment=dev # Xem lại các thay đổi # Nhập \u0026#39;y\u0026#39; để xác nhận Kết quả mong đợi:\n✅ EveryoneCook-dev-DNS\rOutputs:\rEveryoneCook-dev-DNS.HostedZoneId = Z018823421GWCSYG5UMHV\rEveryoneCook-dev-DNS.HostedZoneName = everyonecook.cloud\rEveryoneCook-dev-DNS.NameServers = ns-1164.awsdns-17.org, ns-825.awsdns-39.net, ns-1889.awsdns-44.co.uk, ns-453.awsdns-56.com\rStack ARN:\rarn:aws:cloudformation:ap-southeast-1:616580903213:stack/EveryoneCook-dev-DNS/... Bước 1.2: Lưu Nameservers LƯU Ý QUAN TRỌNG: Lưu lại 4 nameservers từ output!\n# Lấy nameservers $nameservers = aws cloudformation describe-stacks ` --stack-name EveryoneCook-dev-DNS ` --query \u0026#39;Stacks[0].Outputs[?OutputKey==`NameServers`].OutputValue\u0026#39; ` --output text Write-Host \u0026#34;Nameservers: $nameservers\u0026#34; # ns-1164.awsdns-17.org, ns-825.awsdns-39.net, ns-1889.awsdns-44.co.uk, ns-453.awsdns-56.com Bước 1.3: Cập nhật Domain Registrar Cập nhật nameservers tại domain registrar (Hostinger, GoDaddy, Namecheap, v.v.):\nĐăng nhập vào domain registrar Tìm domain everyonecook.cloud Chọn \u0026ldquo;Custom Nameservers\u0026rdquo; hoặc \u0026ldquo;DNS Settings\u0026rdquo; Xóa nameservers cũ Nhập 4 nameservers từ AWS: ns-1164.awsdns-17.org\rns-825.awsdns-39.net\rns-1889.awsdns-44.co.uk\rns-453.awsdns-56.com Lưu thay đổi Bước 1.4: Xác minh DNS Propagation # Kiểm tra DNS propagation (có thể mất 5-30 phút) nslookup -type=NS everyonecook.cloud # Hoặc dùng dig (nếu có WSL/Git Bash) dig NS everyonecook.cloud # Mong đợi: Thấy 4 nameservers từ AWS Công cụ online để kiểm tra:\nhttps://www.whatsmydns.net/ https://dnschecker.org/ ⏳ Đợi DNS propagate trước khi tiếp tục (thường 5-15 phút)\nPhase 1.5: Deploy Certificate Stack (ACM) QUAN TRỌNG: Stack này phải deploy ở us-east-1 region vì yêu cầu của CloudFront.\nBước 1.5.1: Deploy Certificate Stack # Deploy Certificate Stack (us-east-1) npx cdk deploy EveryoneCook-dev-Certificate --context environment=dev # Nhập \u0026#39;y\u0026#39; để xác nhận Stack tạo 2 certificates:\nCloudFront Certificate (us-east-1): cdn-dev.everyonecook.cloud API Gateway Certificate (us-east-1): *.everyonecook.cloud (wildcard) Bước 1.5.2: Đợi DNS Validation ACM sẽ tự động:\nTạo CNAME records trong Route 53 để validate domain Xác thực quyền sở hữu Phát hành certificates Quá trình này mất 5-10 phút.\n# Kiểm tra trạng thái certificate aws acm list-certificates --region us-east-1 # Lấy certificate ARN $certArn = aws acm list-certificates --region us-east-1 ` --query \u0026#39;CertificateSummaryList[?DomainName==`cdn-dev.everyonecook.cloud`].CertificateArn\u0026#39; ` --output text # Kiểm tra trạng thái validation aws acm describe-certificate --certificate-arn $certArn --region us-east-1 ` --query \u0026#39;Certificate.{Status:Status,ValidationMethod:DomainValidationOptions[0].ValidationMethod}\u0026#39; Kết quả mong đợi:\n{ \u0026#34;Status\u0026#34;: \u0026#34;ISSUED\u0026#34;, \u0026#34;ValidationMethod\u0026#34;: \u0026#34;DNS\u0026#34; } Bước 1.5.3: Xác minh Certificates # Liệt kê tất cả certificates aws cloudformation describe-stacks ` --stack-name EveryoneCook-dev-Certificate ` --region us-east-1 ` --query \u0026#39;Stacks[0].Outputs\u0026#39; # Mong đợi: # CloudFrontCertificateArn = arn:aws:acm:us-east-1:...:certificate/... # ApiGatewayCertificateArn = arn:aws:acm:us-east-1:...:certificate/... ✅ Chờ đến khi cả 2 certificates có Status = ISSUED\nPhase 2: Deploy Core Stack (Foundation) Core Stack tạo foundation resources: DynamoDB, S3, CloudFront, KMS.\nBước 2.1: Deploy Core Stack # Deploy Core Stack (mất 10-15 phút) npx cdk deploy EveryoneCook-dev-Core --context environment=dev # Nhập \u0026#39;y\u0026#39; để xác nhận Stack tạo:\nDynamoDB:\nTable: EveryoneCook-dev Billing: Pay-per-request 5 GSI indexes (GSI1-GSI5) Stream enabled (cho DynamoDB Streams) Mã hóa KMS S3 Buckets (4 buckets):\neveryonecook-content-dev - Tải lên của người dùng (avatars, hình ảnh) everyonecook-logs-dev - S3 access logs everyonecook-cdn-logs-dev - CloudFront logs everyonecook-incoming-emails-dev - SES email receiving CloudFront Distribution:\nCustom domain: cdn-dev.everyonecook.cloud Origin: S3 content bucket Chỉ HTTPS (certificate từ Certificate Stack) Bật nén Price Class 200 (Mỹ, Châu Âu, Châu Á) KMS Keys (2 keys):\nDynamoDB encryption key S3 encryption key Bước 2.2: Theo dõi Deployment Deployment này mất lâu nhất (10-15 phút) do CloudFront Distribution.\n# Trong terminal khác, theo dõi CloudFormation events aws cloudformation describe-stack-events ` --stack-name EveryoneCook-dev-Core ` --max-items 10 ` --query \u0026#39;StackEvents[*].{Time:Timestamp,Status:ResourceStatus,Type:ResourceType,Resource:LogicalResourceId}\u0026#39; ` --output table Bước 2.3: Xác minh Core Resources # Kiểm tra DynamoDB table aws dynamodb describe-table --table-name EveryoneCook-dev ` --query \u0026#39;Table.{Name:TableName,Status:TableStatus,Billing:BillingModeSummary.BillingMode,Stream:StreamSpecification.StreamEnabled}\u0026#39; # Mong đợi: # { # \u0026#34;Name\u0026#34;: \u0026#34;EveryoneCook-dev\u0026#34;, # \u0026#34;Status\u0026#34;: \u0026#34;ACTIVE\u0026#34;, # \u0026#34;Billing\u0026#34;: \u0026#34;PAY_PER_REQUEST\u0026#34;, # \u0026#34;Stream\u0026#34;: true # } # Kiểm tra S3 buckets aws s3 ls | Select-String \u0026#34;everyonecook\u0026#34; # Mong đợi: # everyonecook-cdn-logs-dev # everyonecook-content-dev # everyonecook-incoming-emails-dev # everyonecook-logs-dev # Kiểm tra CloudFront distribution aws cloudfront list-distributions ` --query \u0026#39;DistributionList.Items[?Comment==`EveryoneCook CDN (dev)`].{Id:Id,Domain:DomainName,Status:Status}\u0026#39; # Mong đợi: # { # \u0026#34;Id\u0026#34;: \u0026#34;E2INNJ4XX421Q3\u0026#34;, # \u0026#34;Domain\u0026#34;: \u0026#34;d2shrpzup69rju.cloudfront.net\u0026#34;, # \u0026#34;Status\u0026#34;: \u0026#34;Deployed\u0026#34; # } Bước 2.4: Lấy Stack Outputs # Lấy tất cả Core Stack outputs aws cloudformation describe-stacks ` --stack-name EveryoneCook-dev-Core ` --query \u0026#39;Stacks[0].Outputs[*].{Key:OutputKey,Value:OutputValue}\u0026#39; ` --output table Outputs chính:\nDynamoDBTableName: EveryoneCook-dev ContentBucketName: everyonecook-content-dev CloudFrontDistributionId: E2INNJ4XX421Q3 CloudFrontDomainName: d2shrpzup69rju.cloudfront.net Phase 3: Deploy Auth Stack (Cognito \u0026amp; SES) Auth Stack tạo authentication infrastructure với Cognito và SES.\nBước 3.1: Deploy Auth Stack # Deploy Auth Stack npx cdk deploy EveryoneCook-dev-Auth --context environment=dev # Nhập \u0026#39;y\u0026#39; để xác nhận Stack tạo:\nCognito User Pool:\nUser Pool: EveryoneCook-UserPool-dev Password policy: tối thiểu 12 ký tự, yêu cầu ký tự đặc biệt MFA: Tùy chọn Xác minh email 5 Lambda Triggers:\nPre-Signup - Xác thực username/email Post-Confirmation - Tạo user profile trong DynamoDB Post-Authentication - Cập nhật lastLoginAt Pre-Authentication - Kiểm tra trạng thái cấm Custom Message - Templates email tùy chỉnh SES Email Identity:\nDomain: everyonecook.cloud Xác thực DKIM Mail FROM domain: mail.everyonecook.cloud Chế độ Production (có thể gửi đến bất kỳ email nào) IAM Roles:\nLambda execution roles Cognito SMS role (cho MFA) Bước 3.2: Xác minh Cognito User Pool # Lấy User Pool ID $userPoolId = aws cloudformation describe-stacks ` --stack-name EveryoneCook-dev-Auth ` --query \u0026#39;Stacks[0].Outputs[?OutputKey==`UserPoolId`].OutputValue\u0026#39; ` --output text Write-Host \u0026#34;User Pool ID: $userPoolId\u0026#34; # ap-southeast-1_PKoL34PF0 # Mô tả User Pool aws cognito-idp describe-user-pool --user-pool-id $userPoolId ` --query \u0026#39;UserPool.{Name:Name,Status:Status,MFA:MfaConfiguration}\u0026#39; Bước 3.3: Xác minh Lambda Triggers # Kiểm tra Lambda triggers được gắn vào User Pool aws cognito-idp describe-user-pool --user-pool-id $userPoolId ` --query \u0026#39;UserPool.LambdaConfig\u0026#39; # Mong đợi: 5 triggers được cấu hình # { # \u0026#34;PreSignUp\u0026#34;: \u0026#34;arn:aws:lambda:...:function:EveryoneCook-dev-PreSignup\u0026#34;, # \u0026#34;PostConfirmation\u0026#34;: \u0026#34;arn:aws:lambda:...:function:EveryoneCook-dev-PostConfirmation\u0026#34;, # \u0026#34;PostAuthentication\u0026#34;: \u0026#34;arn:aws:lambda:...:function:EveryoneCook-dev-PostAuthentication\u0026#34;, # \u0026#34;PreAuthentication\u0026#34;: \u0026#34;arn:aws:lambda:...:function:EveryoneCook-dev-PreAuthentication\u0026#34;, # \u0026#34;CustomMessage\u0026#34;: \u0026#34;arn:aws:lambda:...:function:EveryoneCook-dev-CustomMessage\u0026#34; # } Bước 3.4: Xác minh SES Email Identity # Kiểm tra trạng thái SES identity aws sesv2 get-email-identity --email-identity everyonecook.cloud ` --query \u0026#39;{Status:VerifiedForSendingStatus,DKIM:DkimAttributes.Status}\u0026#39; # Mong đợi: # { # \u0026#34;Status\u0026#34;: true, # \u0026#34;DKIM\u0026#34;: \u0026#34;SUCCESS\u0026#34; # } # Kiểm tra DKIM records trong Route 53 aws route53 list-resource-record-sets ` --hosted-zone-id Z018823421GWCSYG5UMHV ` --query \u0026#39;ResourceRecordSets[?Type==`CNAME` \u0026amp;\u0026amp; contains(Name, `_domainkey`)]\u0026#39; ✅ SES phải ở Production mode để gửi email đến bất kỳ địa chỉ nào\nPhase 4: Deploy Backend Stack (API \u0026amp; Lambda) Backend Stack tạo API Gateway và Lambda functions. Trước khi deploy, cần build Lambda code.\nBước 4.1: Build Lambda Code # Di chuyển đến project root cd D:\\Project_AWS\\everyonecook # Chạy deployment script để build tất cả Lambda code .\\deploy\\deploy-backend.ps1 -Environment dev -SkipBuild:$false # Hoặc build thủ công: # Build tất cả modules cd services/api-router; npm run build; cd ../.. cd services/auth-module; npm run build; cd ../.. cd services/social-module; npm run build; cd ../.. cd services/ai-module; npm run build; cd ../.. cd services/admin-module; npm run build; cd ../.. cd services/upload-module; npm run build; cd ../.. ⚠️ QUAN TRỌNG: Lambda code phải được build TRƯỚC khi deploy Backend Stack!\nBước 4.2: Deploy Backend Stack # Di chuyển về infrastructure cd D:\\Project_AWS\\everyonecook\\infrastructure # Deploy Backend Stack npx cdk deploy EveryoneCook-dev-Backend --context environment=dev # Nhập \u0026#39;y\u0026#39; để xác nhận Stack tạo:\nAPI Gateway:\nREST API: EveryoneCook-API-dev Custom domain: api-dev.everyonecook.cloud Cognito Authorizer Bảo vệ WAF Web ACL 7 Lambda Functions:\neveryonecook-dev-api-router - API routing (512 MB, 30s)\neveryonecook-dev-auth-user - Auth \u0026amp; User Management (512 MB, 30s)\neveryonecook-dev-social - Tính năng mạng xã hội (512 MB, 30s)\neveryonecook-dev-recipe-ai - Công thức \u0026amp; AI (1024 MB, 60s)\neveryonecook-dev-ai-worker - AI processing worker (1024 MB, 300s)\neveryonecook-dev-admin - Admin dashboard (512 MB, 30s)\neveryonecook-dev-upload - Tải lên file (256 MB, 15s)\nLambda Layer:\neveryonecook-shared-deps-dev - Shared dependencies (~15-20 MB) SQS Queues (4 queues + 4 DLQs):\nAI Queue + DLQ Image Processing Queue + DLQ Analytics Queue + DLQ Notification Queue + DLQ WAF Web ACL:\nBảo vệ API Gateway Giới hạn tốc độ (2000 req/5min mỗi IP) Hỗ trợ chặn theo vị trí địa lý Bước 4.3: Xác minh API Gateway # Lấy API endpoint $apiUrl = aws cloudformation describe-stacks ` --stack-name EveryoneCook-dev-Backend ` --query \u0026#39;Stacks[0].Outputs[?OutputKey==`ApiCustomDomain`].OutputValue\u0026#39; ` --output text Write-Host \u0026#34;API Endpoint: $apiUrl\u0026#34; # https://api-dev.everyonecook.cloud # Kiểm tra health endpoint $response = Invoke-RestMethod -Uri \u0026#34;$apiUrl/health\u0026#34; -Method Get $response | ConvertTo-Json # Mong đợi: # { # \u0026#34;status\u0026#34;: \u0026#34;healthy\u0026#34;, # \u0026#34;timestamp\u0026#34;: \u0026#34;2025-12-09T...\u0026#34;, # \u0026#34;service\u0026#34;: \u0026#34;EveryoneCook API\u0026#34;, # \u0026#34;environment\u0026#34;: \u0026#34;dev\u0026#34; # } Bước 4.4: Xác minh Lambda Functions # Liệt kê tất cả Lambda functions aws lambda list-functions ` --query \u0026#39;Functions[?contains(FunctionName, `everyonecook-dev`)].{Name:FunctionName,Runtime:Runtime,Memory:MemorySize,Timeout:Timeout}\u0026#39; ` --output table # Mong đợi: 7 functions + 5 Cognito triggers = 12 Lambda functions tổng cộng Bước 4.5: Xác minh SQS Queues # Liệt kê SQS queues aws sqs list-queues --queue-name-prefix everyonecook-dev # Mong đợi: 8 queues (4 main + 4 DLQ) # - everyonecook-dev-ai-queue # - everyonecook-dev-ai-queue-dlq # - everyonecook-dev-image-queue # - everyonecook-dev-image-queue-dlq # - everyonecook-dev-analytics-queue # - everyonecook-dev-analytics-queue-dlq # - everyonecook-dev-notification-queue # - everyonecook-dev-notification-queue-dlq Phase 5: Deploy Observability Stack (CloudWatch) Observability Stack tạo monitoring dashboards và alarms.\nBước 5.1: Deploy Observability Stack # Deploy Observability Stack npx cdk deploy EveryoneCook-dev-Observability --context environment=dev # Nhập \u0026#39;y\u0026#39; để xác nhận Stack tạo:\n4 CloudWatch Dashboards:\nCore Dashboard - Metrics DynamoDB, S3, CloudFront Auth Dashboard - Metrics Cognito, SES Backend Dashboard - Metrics API Gateway, Lambda Overview Dashboard - Sức khỏe hệ thống tổng quan CloudWatch Alarms:\nDynamoDB throttling Lambda errors API Gateway 5xx errors CloudFront 5xx errors SNS Topic:\nThông báo alarm Hỗ trợ đăng ký email Composite Alarm:\nAlarm sức khỏe hệ thống nghiêm trọng Tổng hợp nhiều alarms Bước 5.2: Đăng ký SNS Topic # Lấy SNS topic ARN $topicArn = aws cloudformation describe-stacks ` --stack-name EveryoneCook-dev-Observability ` --query \u0026#39;Stacks[0].Outputs[?OutputKey==`AlarmTopicArn`].OutputValue\u0026#39; ` --output text # Đăng ký email của bạn aws sns subscribe ` --topic-arn $topicArn ` --protocol email ` --notification-endpoint \u0026#34;your-email@example.com\u0026#34; Write-Host \u0026#34;Kiểm tra email của bạn và xác nhận đăng ký!\u0026#34; Bước 5.3: Xác minh Dashboards # Liệt kê CloudWatch dashboards aws cloudwatch list-dashboards ` --query \u0026#39;DashboardEntries[?contains(DashboardName, `EveryoneCook-dev`)].DashboardName\u0026#39; # Mong đợi: # - EveryoneCook-dev-CoreDashboard # - EveryoneCook-dev-AuthDashboard # - EveryoneCook-dev-BackendDashboard # - EveryoneCook-dev-OverviewDashboard # Lấy URL dashboard $region = \u0026#34;ap-southeast-1\u0026#34; $dashboardName = \u0026#34;EveryoneCook-dev-OverviewDashboard\u0026#34; Write-Host \u0026#34;Dashboard URL: https://console.aws.amazon.com/cloudwatch/home?region=$region#dashboards:name=$dashboardName\u0026#34; Xác minh Triển khai Hoàn chỉnh Bước 6.1: Liệt kê Tất cả Stacks # Liệt kê tất cả deployed stacks aws cloudformation list-stacks ` --stack-status-filter CREATE_COMPLETE UPDATE_COMPLETE ` --query \u0026#39;StackSummaries[?contains(StackName, `EveryoneCook-dev`)].{Name:StackName,Status:StackStatus,Created:CreationTime}\u0026#39; ` --output table Stacks mong đợi:\n------------------------------------------------------------\r| ListStacks |\r+--------------------------------------------------+--------+\r| Name | Status | Created|\r+--------------------------------------------------+--------+\r| EveryoneCook-dev-DNS | CREATE_COMPLETE |\r| EveryoneCook-dev-Certificate | CREATE_COMPLETE |\r| EveryoneCook-dev-Core | CREATE_COMPLETE |\r| EveryoneCook-dev-Auth | CREATE_COMPLETE |\r| EveryoneCook-dev-Backend | CREATE_COMPLETE |\r| EveryoneCook-dev-Observability | CREATE_COMPLETE |\r+--------------------------------------------------+--------+ Bước 6.2: Lấy Tất cả Stack Outputs # Tạo báo cáo outputs toàn diện $stacks = @(\u0026#34;DNS\u0026#34;, \u0026#34;Certificate\u0026#34;, \u0026#34;Core\u0026#34;, \u0026#34;Auth\u0026#34;, \u0026#34;Backend\u0026#34;, \u0026#34;Observability\u0026#34;) foreach ($stack in $stacks) { Write-Host \u0026#34;`n========================================\u0026#34; -ForegroundColor Cyan Write-Host \u0026#34;EveryoneCook-dev-$stack Outputs\u0026#34; -ForegroundColor Cyan Write-Host \u0026#34;========================================\u0026#34; -ForegroundColor Cyan aws cloudformation describe-stacks ` --stack-name \u0026#34;EveryoneCook-dev-$stack\u0026#34; ` --query \u0026#39;Stacks[0].Outputs[*].{Key:OutputKey,Value:OutputValue}\u0026#39; ` --output table } Bước 6.3: Lưu Outputs vào File # Lưu outputs vào infrastructure/outputs.json cd D:\\Project_AWS\\everyonecook\\infrastructure # Lấy outputs dưới định dạng JSON $outputs = @{} foreach ($stack in $stacks) { $stackOutputs = aws cloudformation describe-stacks ` --stack-name \u0026#34;EveryoneCook-dev-$stack\u0026#34; ` --query \u0026#39;Stacks[0].Outputs\u0026#39; | ConvertFrom-Json $stackData = @{} foreach ($output in $stackOutputs) { $stackData[$output.OutputKey] = $output.OutputValue } $outputs[\u0026#34;EveryoneCook-dev-$stack\u0026#34;] = $stackData } # Lưu vào file $outputs | ConvertTo-Json -Depth 5 | Out-File -FilePath \u0026#34;outputs.json\u0026#34; -Encoding utf8 Write-Host \u0026#34;Outputs đã được lưu vào outputs.json\u0026#34; -ForegroundColor Green Bước 6.4: Xác minh Tài nguyên Chính # Xác minh tài nguyên toàn diện Write-Host \u0026#34;`n===== XÁC MINH TÀI NGUYÊN =====\u0026#34; -ForegroundColor Yellow # DynamoDB Write-Host \u0026#34;`nDynamoDB Table:\u0026#34; -ForegroundColor Cyan aws dynamodb describe-table --table-name EveryoneCook-dev ` --query \u0026#39;Table.{Name:TableName,Status:TableStatus,ItemCount:ItemCount,Size:TableSizeBytes}\u0026#39; ` --output table # S3 Buckets Write-Host \u0026#34;`nS3 Buckets:\u0026#34; -ForegroundColor Cyan aws s3 ls | Select-String \u0026#34;everyonecook\u0026#34; # CloudFront Write-Host \u0026#34;`nCloudFront Distribution:\u0026#34; -ForegroundColor Cyan aws cloudfront list-distributions ` --query \u0026#39;DistributionList.Items[?Comment==`EveryoneCook CDN (dev)`].{Id:Id,Status:Status,Domain:DomainName}\u0026#39; ` --output table # Lambda Functions Write-Host \u0026#34;`nLambda Functions:\u0026#34; -ForegroundColor Cyan aws lambda list-functions ` --query \u0026#39;Functions[?contains(FunctionName, `everyonecook-dev`)].FunctionName\u0026#39; ` --output table # Cognito User Pool Write-Host \u0026#34;`nCognito User Pool:\u0026#34; -ForegroundColor Cyan aws cognito-idp list-user-pools --max-results 10 ` --query \u0026#39;UserPools[?Name==`EveryoneCook-UserPool-dev`].{Name:Name,Id:Id,Status:Status}\u0026#39; ` --output table # API Gateway Write-Host \u0026#34;`nAPI Gateway:\u0026#34; -ForegroundColor Cyan aws apigateway get-rest-apis ` --query \u0026#39;items[?name==`EveryoneCook-API-dev`].{Name:name,Id:id}\u0026#39; ` --output table # SQS Queues Write-Host \u0026#34;`nSQS Queues:\u0026#34; -ForegroundColor Cyan aws sqs list-queues --queue-name-prefix everyonecook-dev ` --query \u0026#39;QueueUrls\u0026#39; --output table Write-Host \u0026#34;`n===== XÁC MINH HOÀN TẤT =====\u0026#34; -ForegroundColor Green Tóm tắt Triển khai Số lượng Tài nguyên Đã triển khai Danh mục Số lượng Tài nguyên Networking 5 Route 53 Hosted Zone, 2 ACM Certificates, CloudFront Distribution, WAF Web ACL Storage 6 DynamoDB Table (5 GSI), 4 S3 Buckets, 2 KMS Keys Compute 12 7 Lambda Functions, 5 Cognito Triggers Integration 8 API Gateway, 4 SQS Queues, 4 DLQ Security 8 Cognito User Pool, SES Identity, IAM Roles (6) Monitoring 15 4 Dashboards, 10+ Alarms, SNS Topic Tổng số Tài nguyên: ~100+ tài nguyên AWS\nPhân tích theo từng Stack DNS Stack:\n✅ Route 53 Hosted Zone Certificate Stack:\n✅ 2 ACM Certificates (us-east-1) Core Stack:\n✅ DynamoDB Table + 5 GSIs + Stream ✅ 4 S3 Buckets ✅ CloudFront Distribution ✅ 2 KMS Keys Auth Stack:\n✅ Cognito User Pool + Client ✅ 5 Lambda Triggers ✅ SES Email Identity ✅ IAM Roles Backend Stack:\n✅ API Gateway REST API ✅ 7 Lambda Functions ✅ Lambda Layer ✅ 4 SQS Queues + 4 DLQs ✅ WAF Web ACL Observability Stack:\n✅ 4 CloudWatch Dashboards ✅ 10+ CloudWatch Alarms ✅ SNS Topic ✅ Composite Alarm Xử lý Sự cố Vấn đề 1: Stack Deployment Thất bại # Kiểm tra CloudFormation events để tìm lỗi aws cloudformation describe-stack-events ` --stack-name EveryoneCook-dev-STACKNAME ` --max-items 20 ` --query \u0026#39;StackEvents[?ResourceStatus==`CREATE_FAILED` || ResourceStatus==`ROLLBACK_IN_PROGRESS`].{Time:Timestamp,Status:ResourceStatus,Reason:ResourceStatusReason,Resource:LogicalResourceId}\u0026#39; ` --output table # Nguyên nhân thường gặp: # - Thiếu dependencies (kiểm tra thứ tự dependency) # - Quyền không đủ # - Vượt quá giới hạn tài nguyên # - Xung đột tên Vấn đề 2: Certificate Validation Bị Treo # Kiểm tra trạng thái certificate $certArn = \u0026#34;arn:aws:acm:us-east-1:...:certificate/...\u0026#34; aws acm describe-certificate --certificate-arn $certArn --region us-east-1 ` --query \u0026#39;Certificate.DomainValidationOptions[0].{Domain:DomainName,Status:ValidationStatus,Method:ValidationMethod}\u0026#39; # Kiểm tra DNS records aws route53 list-resource-record-sets ` --hosted-zone-id Z018823421GWCSYG5UMHV ` --query \u0026#39;ResourceRecordSets[?Type==`CNAME`]\u0026#39; # Giải pháp: # - Xác minh nameservers đã cập nhật tại registrar # - Đợi DNS propagation (lên đến 48 giờ, thường là 15 phút) # - Kiểm tra validation CNAME records tồn tại trong Route 53 Vấn đề 3: Lambda Deployment Thất bại # Kiểm tra nếu thư mục dist tồn tại Get-ChildItem D:\\Project_AWS\\everyonecook\\services\\*\\dist # Nếu thiếu, rebuild cd D:\\Project_AWS\\everyonecook .\\deploy\\deploy-backend.ps1 -Environment dev # Kiểm tra kích thước Lambda package Get-ChildItem D:\\Project_AWS\\everyonecook\\services\\*\\lambda.zip | Select-Object Name, @{Name=\u0026#34;Size(MB)\u0026#34;;Expression={[math]::Round($_.Length/1MB,2)}} # Giới hạn Lambda: # - Deployment package: 50 MB (đã nén) # - Giải nén: 250 MB Vấn đề 4: CloudFront Distribution Thất bại # Kiểm tra region của certificate (phải là us-east-1) aws acm list-certificates --region us-east-1 ` --query \u0026#39;CertificateSummaryList[?DomainName==`cdn-dev.everyonecook.cloud`]\u0026#39; # Kiểm tra S3 bucket tồn tại aws s3 ls everyonecook-content-dev # Giải pháp: # - Đảm bảo Certificate Stack được deploy trước # - Certificate phải ở us-east-1 # - S3 bucket phải tồn tại trước CloudFront Vấn đề 5: Quyền IAM Không đủ # Kiểm tra user/role hiện tại aws sts get-caller-identity # Quyền cần thiết: # - cloudformation:* (tất cả CloudFormation operations) # - iam:* (tạo roles, policies) # - lambda:* (tạo functions) # - apigateway:* (tạo API) # - cognito-idp:* (tạo user pools) # - s3:* (tạo buckets) # - dynamodb:* (tạo tables) # - route53:* (tạo hosted zones) # - acm:* (tạo certificates) # - cloudfront:* (tạo distributions) # - wafv2:* (tạo web ACLs) # - logs:* (tạo log groups) # - sns:* (tạo topics) # - sqs:* (tạo queues) # Khuyến nghị: AdministratorAccess policy (cho lần deploy đầu tiên) Vấn đề 6: Stack Rollback # Nếu stack rollback, kiểm tra lý do aws cloudformation describe-stack-events ` --stack-name EveryoneCook-dev-STACKNAME ` --query \u0026#39;StackEvents[?ResourceStatus==`CREATE_FAILED`].[Timestamp,ResourceStatusReason]\u0026#39; ` --output table # Xóa failed stack trước khi thử lại aws cloudformation delete-stack --stack-name EveryoneCook-dev-STACKNAME # Đợi xóa hoàn tất aws cloudformation wait stack-delete-complete --stack-name EveryoneCook-dev-STACKNAME # Redeploy npx cdk deploy EveryoneCook-dev-STACKNAME --context environment=dev Ước tính Chi phí Phân tích Chi phí Hàng tháng (Môi trường Dev) Dịch vụ Sử dụng Chi phí DynamoDB Pay-per-request, sử dụng thấp $2-5 S3 10 GB lưu trữ + requests $1-2 CloudFront 10 GB truyền tải $1-2 Lambda 1M requests, 512 MB $3-5 API Gateway 100K requests $0.35 Cognito 100 MAU $0-5 SES 100 emails $0.01 CloudWatch Logs + metrics $2-3 WAF Quy tắc cơ bản $5 Route 53 1 hosted zone $0.50 SQS 100K requests $0.04 KMS 2 keys $2 Tổng Chi phí Ước tính Hàng tháng: $20-35 (không có OpenSearch)\nVới OpenSearch (nếu được bật): $70-135/tháng\nTheo dõi Chi phí # Kiểm tra chi phí tháng hiện tại $startDate = (Get-Date -Day 1).ToString(\u0026#34;yyyy-MM-dd\u0026#34;) $endDate = (Get-Date).AddDays(1).ToString(\u0026#34;yyyy-MM-dd\u0026#34;) aws ce get-cost-and-usage ` --time-period Start=$startDate,End=$endDate ` --granularity DAILY ` --metrics BlendedCost ` --group-by Type=SERVICE ` --output table Các Bước Tiếp theo Infrastructure deployment hoàn thành! Tiếp theo:\n✅ Xác minh Tất cả Stacks: Tất cả 6 stacks đã được deploy thành công 🔧 Cấu hình API: Thiết lập API routes và Lambda integration → 5.06 - Cấu hình API \u0026amp; Lambda 🚀 Deploy Backend Code: Build và deploy Lambda code → 5.07 - Deploy Backend ✅ Kiểm tra Endpoints: Xác minh chức năng API → 5.08 - Kiểm tra Endpoints Trạng thái Hiện tại:\nInfrastructure: ✅ Hoàn thành Lambda Code: ⏳ Cần deploy Testing: ⏳ Đang chờ Tiếp tục đến: 5.06 - Cấu hình API \u0026amp; Lambda\n"
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/5-workshop/",
	"title": "Workshop",
	"tags": [],
	"description": "",
	"content": "Xây dựng EveryoneCook: Workshop Hạ tầng AWS Full-Stack Tổng quan Trong workshop toàn diện này, bạn sẽ học cách xây dựng hạ tầng ứng dụng mạng xã hội nấu ăn sẵn sàng cho production trên AWS bằng cách sử dụng Infrastructure as Code (IaC) với AWS CDK. Nền tảng EveryoneCook thể hiện các mô hình kiến trúc cloud hiện đại, bao gồm serverless computing, phân phối nội dung, tính năng hỗ trợ AI, tìm kiếm nâng cao với OpenSearch, và khả năng giám sát toàn diện.\nBạn sẽ triển khai bảy CDK stack liên kết với nhau để tạo ra một ứng dụng có khả năng mở rộng, bảo mật và tối ưu chi phí:\nDNS Stack - Route 53 hosted zone để quản lý domain Certificate Stack - ACM certificates cho CloudFront và API Gateway (us-east-1) CoreStack - DynamoDB Single Table, S3 buckets, CloudFront CDN, KMS encryption, và OpenSearch AuthStack - Cognito User Pool với Lambda triggers và tích hợp SES email BackendStack - API Gateway, Lambda functions (6 modules), SQS queues, và WAF protection FrontendStack - AWS Amplify hosting cho ứng dụng Next.js 15 (tùy chọn) ObservabilityStack - CloudWatch dashboards, alarms, và X-Ray distributed tracing Nội dung Tổng quan Workshop Thiết lập Môi trường CDK Bootstrap Cấu hình Infrastructure Stacks Triển khai Infrastructure Cấu hình API \u0026amp; Lambda Triển khai Backend Services Kiểm tra Endpoints End-to-End Push lên GitLab Triển khai lên Amplify Dọn dẹp tài nguyên "
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/1-worklog/1.5-week5/",
	"title": "Nhật ký Tuần 5",
	"tags": [],
	"description": "",
	"content": "Mục tiêu Tuần 5: Xuất sắc Vận hành: Tự động hóa các tác vụ vận hành (khởi động/dừng máy chủ) bằng AWS Lambda và tích hợp với các công cụ truyền thông (Slack). Giám sát \u0026amp; Quan sát: Xây dựng bảng điều khiển nâng cao sử dụng Grafana tích hợp với Amazon CloudWatch để có cái nhìn sâu sắc về hệ thống. Quản trị \u0026amp; Gắn thẻ: Triển khai các chiến lược tổ chức tài nguyên bằng cách sử dụng Thẻ, Nhóm Tài nguyên và thực thi Kiểm soát Truy cập Dựa trên Thuộc tính (ABAC) thông qua IAM. Quản lý Hệ thống (SSM): Khám phá quản lý máy chủ mà không cần SSH bằng Session Manager và hiểu quy trình vá tự động (Patch Manager). Hạ tầng dưới dạng Mã (IaC): Bắt đầu tự động hóa triển khai hạ tầng bằng AWS CloudFormation. Nhiệm vụ cần thực hiện trong tuần này: Ngày Nhiệm vụ Ngày Bắt đầu Ngày Hoàn thành Tài liệu Tham khảo 2 Tối ưu Chi phí \u0026amp; Tự động hóa - Tạo hàm Lambda (Python boto3) để tự động Khởi động/Dừng các phiên bản EC2 dựa trên lịch trình. - Tích hợp Lambda với Slack Webhooks để thông báo vận hành. - Cấu hình trình kích hoạt EventBridge (CloudWatch Events). 06/10/2025 06/10/2025 https://000022.awsstudygroup.com/ 3 Giám sát Nâng cao (Grafana) - Khởi chạy EC2 để lưu trữ Grafana (Mã nguồn Mở). - Kết nối Grafana với nguồn dữ liệu Amazon CloudWatch. - Tạo bảng điều khiển tùy chỉnh trực quan hóa các chỉ số CPU, Mạng và Đĩa từ EC2. 07/10/2025 07/10/2025 https://000029.awsstudygroup.com/ 4 Quản trị \u0026amp; Bảo mật (Thẻ \u0026amp; IAM) - Chiến lược Gắn thẻ: Áp dụng các thẻ nhất quán cho tài nguyên (Env, Owner, CostCenter). - Tạo Nhóm Tài nguyên để quản lý tài nguyên theo thẻ. - Triển khai ABAC: Cấu hình Chính sách IAM để kiểm soát quyền truy cập EC2 dựa trên thẻ khớp giữa Người dùng và Tài nguyên. 08/10/2025 08/10/2025 https://000027.awsstudygroup.com/ https://000028.awsstudygroup.com/ 5 Quản lý Hệ thống (SSM) - Session Manager: Kết nối với các phiên bản riêng tư/công khai mà không cần mở cổng SSH (Chuyển tiếp Cổng, Nhật ký Kiểm tra sang S3). - Run Command: Thực thi lệnh từ xa trên nhiều phiên bản. - Lý thuyết/Xem xét: Quy trình Patch Manager (quét \u0026amp; tuân thủ) do giới hạn quyền Free Tier/Lab tiềm ẩn. 09/10/2025 09/10/2025 https://000058.awsstudygroup.com/ https://000031.awsstudygroup.com/ 6 Hạ tầng dưới dạng Mã (CloudFormation) - Viết mẫu CloudFormation cơ bản (YAML/JSON) để triển khai VPC và EC2. - Hiểu về Stack, Tham số, Ánh xạ và Đầu ra. - Khám phá Phát hiện Lệch để xác định các thay đổi thủ công đối với hạ tầng. 10/10/2025 10/10/2025 https://000037.awsstudygroup.com/ Thành tựu Tuần 5 Tự động hóa \u0026amp; Quản lý Chi phí Triển khai thành công cơ chế tiết kiệm chi phí tự động bằng cách lên lịch các phiên bản EC2 không sản xuất dừng lại trong giờ nghỉ bằng AWS Lambda. Triển khai hệ thống thông báo nơi các sự kiện vận hành kích hoạt tin nhắn đến kênh Slack, cải thiện khả năng hiển thị của nhóm. Giảm can thiệp thủ công bằng cách tận dụng Quy tắc EventBridge để kích hoạt quy trình tự động hóa. Trực quan hóa Giám sát Triển khai phiên bản Grafana tự lưu trữ trên EC2. Tích hợp thành công Amazon CloudWatch làm nguồn dữ liệu cho Grafana, cho phép trực quan hóa các chỉ số AWS trong giao diện thống nhất, có thể tùy chỉnh. Tạo bảng điều khiển cụ thể để giám sát tình trạng EC2, vượt qua các giới hạn của chế độ xem CloudWatch mặc định. Quản trị Tài nguyên \u0026amp; Bảo mật Thành thạo chiến lược Gắn thẻ để tổ chức tài nguyên theo môi trường (Dev/Prod) và dự án. Triển khai Nhóm Tài nguyên để quản lý hàng loạt tài nguyên chia sẻ các thẻ chung. Tăng cường bảo mật bằng cách sử dụng Kiểm soát Truy cập Dựa trên Thuộc tính (ABAC): Cấu hình các chính sách IAM cho phép người dùng chỉ quản lý các phiên bản EC2 khớp với thẻ phòng ban cụ thể của họ, cách ly hiệu quả các môi trường. Vận hành Hệ thống (SysOps) Loại bỏ nhu cầu về Bastion Host/khóa SSH bằng cách sử dụng AWS Systems Manager Session Manager để truy cập phiên bản an toàn. Cấu hình Ghi nhật ký Phiên sang S3 cho mục đích kiểm tra và tuân thủ. Nghiên cứu và mô phỏng quy trình Patch Manager để tự động hóa cập nhật hệ điều hành và duy trì tuân thủ trên toàn bộ các phiên bản. Sử dụng Run Command để thực thi các tập lệnh quản trị trên nhiều máy chủ đồng thời mà không cần đăng nhập vào từng máy. Hạ tầng dưới dạng Mã (IaC) Chuyển đổi từ các thao tác thủ công trên console sang định nghĩa hạ tầng bằng mã sử dụng AWS CloudFormation. Tạo và triển khai Stack để cung cấp VPC và các phiên bản EC2, đảm bảo triển khai nhất quán và có thể lặp lại. Học cách phát hiện \u0026ldquo;Lệch Cấu hình\u0026rdquo; để xác định nơi trạng thái hạ tầng thực tế lệch khỏi các mẫu CloudFormation đã định nghĩa. "
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/3-blogstranslated/3.5-blog5/",
	"title": "Blog 5: Chiến lược Mua sắm Tập trung vào Giải pháp trên AWS Marketplace",
	"tags": [],
	"description": "",
	"content": "Tổng quan: Từ Sản phẩm Đơn lẻ đến Giải pháp Toàn diện Tại re:Invent lần này, AWS Marketplace đã công bố một sự thay đổi chiến lược trong cách thức mua sắm phần mềm: chuyển dịch từ việc mua các công cụ rời rạc sang \u0026ldquo;Solution-centric procurement\u0026rdquo; (Mua sắm tập trung vào giải pháp).\nNhu cầu của khách hàng doanh nghiệp ngày nay không chỉ dừng lại ở việc tìm kiếm một phần mềm cụ thể. Họ tìm kiếm những kết quả kinh doanh (business outcomes) trọn vẹn – ví dụ như một giải pháp bảo mật toàn diện cho dữ liệu y tế, hay một hệ thống phân tích dữ liệu sản xuất thông minh. Để đáp ứng điều này, AWS Marketplace giới thiệu khả năng hỗ trợ Multi-product solutions (Các giải pháp đa sản phẩm), cho phép các đối tác (Partners) đóng gói phần mềm, dịch vụ và dữ liệu thành một đơn hàng duy nhất.\n1. Giới thiệu Multi-product Solutions (Giải pháp Đa sản phẩm) Đây là tính năng cốt lõi mới nhất. Multi-product solutions cho phép các Đối tác AWS (ISVs, Channel Partners, System Integrators) kết hợp nhiều sản phẩm và dịch vụ từ các nhà cung cấp khác nhau vào một gói giải pháp duy nhất.\nThay vì khách hàng phải tự mình tìm kiếm, đánh giá và mua lẻ tẻ từng thành phần (ví dụ: mua phần mềm SIEM từ hãng A, mua dịch vụ tư vấn triển khai từ hãng B, và mua data set từ hãng C), giờ đây họ có thể mua trọn gói một \u0026ldquo;Giải pháp Trung tâm điều hành an ninh (SOC)\u0026rdquo; bao gồm tất cả các thành phần trên.\n[Figure 1] Giao diện hiển thị giải pháp của Accenture, bao gồm cả phần mềm và dịch vụ.\nKhách hàng có thể cuộn xuống trang chi tiết để xem từng thành phần trong gói giải pháp này:\n[Figure 2] Chi tiết từng thành phần (Software, Services) trong một gói giải pháp đa sản phẩm.\n2. Quy trình mua sắm đơn giản hóa (Streamlined Procurement) Một trong những rào cản lớn nhất khi triển khai các giải pháp phức tạp là quy trình thủ tục. Tính năng mới giúp đơn giản hóa đáng kể việc này:\nMột điểm thương lượng: Khách hàng đàm phán giá cả và điều khoản cho toàn bộ gói giải pháp với một đối tác duy nhất. Linh hoạt thành phần: Mặc dù mua theo gói, khách hàng vẫn có thể tùy chỉnh thời hạn (terms) và gia hạn (renewals) cho từng thành phần bên trong gói đó một cách độc lập nếu cần. Quản trị tập trung: Tất cả chi tiêu, hóa đơn và giấy phép sử dụng (licenses) đều được quản lý tập trung trên AWS, giúp dễ dàng theo dõi ngân sách và tuân thủ (compliance). [Figure 3] Trang mua sắm hiển thị thông tin chi tiết về gói giải pháp.\nKhách hàng có thể quản lý hợp đồng cho từng thành phần riêng biệt trong khi vẫn hưởng lợi từ một quy trình phê duyệt duy nhất:\n[Figure 4] Bảng chào giá chi tiết cho từng thành phần trong gói giải pháp.\n3. Lợi ích cho Hệ sinh thái Đối tác (Partners) Sự thay đổi này mở ra cơ hội lớn cho các đối tác AWS:\nISV (Independent Software Vendors): Có thể kết hợp phần mềm của họ với dịch vụ triển khai chuyên nghiệp trong một listing duy nhất (Ví dụ: Okta kết hợp phần mềm và dịch vụ triển khai). Channel Partners: Có thể kết hợp dịch vụ riêng của họ với các sản phẩm ISV mà họ được ủy quyền bán lại (Ví dụ: SCC kết hợp dịch vụ với sản phẩm CrowdStrike). System Integrators (SI): Có thể kết hợp phần mềm và dịch vụ từ nhiều đối tác khác nhau để tạo ra giải pháp trọn gói (Ví dụ: Accenture kết hợp dịch vụ của họ với Elastic). 4. Trải nghiệm khám phá (Discovery) Để hỗ trợ tư duy \u0026ldquo;mua giải pháp\u0026rdquo;, AWS Marketplace cũng đã cải tiến công cụ tìm kiếm với Generative AI. Khách hàng có thể tìm kiếm dựa trên Use Case (Trường hợp sử dụng) hoặc Industry (Ngành nghề) thay vì chỉ tên sản phẩm, giúp việc tìm kiếm giải pháp phù hợp trở nên nhanh chóng hơn.\nKết luận Việc chuyển hướng sang Solution-centric procurement là bước đi chiến lược của AWS nhằm giảm thiểu sự phức tạp trong mua sắm CNTT. Nó giúp doanh nghiệp đi nhanh hơn từ khâu \u0026ldquo;có vấn đề\u0026rdquo; đến khâu \u0026ldquo;có giải pháp\u0026rdquo;, loại bỏ gánh nặng phải tự lắp ghép các mảnh ghép công nghệ rời rạc.\nTác giả Tuan Vo\rTuan Vo is a Marketplace Specialist Solutions Architect who focuses on supporting sellers to list their products on AWS Marketplace. He supports large enterprises and public sector customers. Outside of work, Tuan enjoys traveling, trying out new food, and going on walks.\nAlex Hodges\rAlex Hodges is a Seattle-based product marketer for AWS Marketplace. Alex is passionate about launching new products and enjoys developing crisp messaging that customers can easily understand. In his free time, he enjoys backpacking, cycling, watching documentaries, and spending time with friends and family.\n"
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/5-workshop/5.04-configure-stacks/5.4.5-backend-stack/",
	"title": "5.4.5 Backend Stack",
	"tags": [],
	"description": "",
	"content": " Backend Stack - Application Layer Tổng Quan Backend Stack là tầng ứng dụng Phase 4 của hạ tầng EveryoneCook. Nó tổng hợp API Gateway, Lambda functions, SQS queues và bảo mật WAF thành một kiến trúc backend thống nhất.\nThứ Tự Triển Khai: Stack này BẮT BUỘC phải được triển khai sau Core Stack và Auth Stack.\n⚠️ Lưu Ý Environment: Hướng dẫn này tập trung vào triển khai môi trường Development (dev). Để triển khai staging/production, xem phần Sự Khác Biệt Giữa Các Environment.\nTrách Nhiệm Chính Tạo API Gateway REST API với custom domain Triển khai 6 Lambda functions (API Router + 5 business modules) Cấu hình 2 SQS queues hoạt động cho async processing (AI, Image queues với DLQs) Triển khai 2 worker Lambda functions cho event processing (AI Worker, Image Worker) Thiết lập WAF Web ACL để bảo vệ API Gateway Cấu hình CloudWatch monitoring và alarms Những Gì Thực Sự Đang Chạy:\n8 Lambda Functions (6 business + 2 workers) 4 SQS Queues được triển khai (AI + Image queues với DLQs của chúng) 1 WAF Web ACL với 5 quy tắc bảo mật CloudWatch Logs và Alarms Những Gì Stack Này Bao Gồm API Gateway (Dev Environment):\nCustom domain: api-dev.everyonecook.cloud ACM certificate cho HTTPS (Regional - ap-southeast-1) Cognito authorizer cho JWT validation Caching: Tắt (chỉ bật trong production) Compression: Bật (gzip/deflate cho responses \u0026gt;1KB) Rate limiting: 10K req/sec, burst 5K Request validation: Body, parameters, headers Data trace logging: Bật (tắt trong production) Lambda Functions (6 functions - Dev Environment):\nAPI Router (everyonecook-dev-api-router): Định tuyến requests đến target Lambda functions Auth \u0026amp; User (everyonecook-dev-auth-user): Xác thực, user profiles, privacy settings Social (everyonecook-dev-social): Posts, comments, reactions, friends, notifications Recipe \u0026amp; AI (everyonecook-dev-recipe-ai): Recipe CRUD, AI generation, search, trending Admin (everyonecook-dev-admin): Content moderation, user management, appeals Upload (everyonecook-dev-upload): S3 presigned URLs, file uploads Source Code: Tất cả functions nằm trong thư mục services/\nSQS Queues (2 queues hoạt động + 2 DLQs):\nAI Queue (everyonecook-dev-ai-queue): Bedrock AI recipe generation (2-minute timeout) → AI Worker Image Queue (everyonecook-dev-image-queue): S3 image optimization (60-second timeout) → Image Worker Lưu ý: Analytics và Notification queues được định nghĩa trong code nhưng KHÔNG được triển khai. Notifications được xử lý trực tiếp trong Social Module.\nWorker Lambda Functions (2 workers được triển khai hoạt động):\nAI Worker (ai-module/workers/): Xử lý các công việc AI generation từ AI Queue sử dụng Bedrock Claude 3 Haiku Image Worker (image-worker/): Xử lý tối ưu hóa hình ảnh từ Image Queue (resize, compress, watermark) WAF Web ACL:\nRate limiting: 2000 req/5min mỗi IP SQL injection protection (AWS Managed) XSS protection (AWS Managed) Known bad inputs (AWS Managed) Request size limit: 10MB tối đa Kiến Trúc ┌──────────────────────────────────────────────────────────────────────┐\r│ Backend Stack (Phase 4 - Dev Environment) │\r│ │\r│ ┌─────────────────────────────────────────────────────────────────┐ │\r│ │ WAF Web ACL (REGIONAL) - Bảo vệ API Gateway │ │\r│ │ ├─ Rate Limiting: 2000 req/5min mỗi IP │ │\r│ │ ├─ SQL Injection Protection (AWS Managed) │ │\r│ │ ├─ XSS Protection (AWS Managed) │ │\r│ │ ├─ Known Bad Inputs (AWS Managed) │ │\r│ │ └─ Request Size Limit: 10MB tối đa │ │\r│ └─────────────────────────────────────────────────────────────────┘ │\r│ │ │\r│ ▼ │\r│ ┌─────────────────────────────────────────────────────────────────┐ │\r│ │ API Gateway REST API │ │\r│ │ ├─ Custom Domain: api.everyonecook.cloud │ │\r│ │ ├─ ACM Certificate (Regional - ap-southeast-1) │ │\r│ │ ├─ Cognito Authorizer (JWT validation) │ │\r│ │ ├─ Caching: 0.5GB, 5-min TTL (chỉ prod) │ │\r│ │ ├─ Compression: gzip/deflate (\u0026gt;1KB) │ │\r│ │ ├─ Rate Limiting: 10K req/sec, burst 5K │ │\r│ │ └─ Request Validation: Body, params, headers │ │\r│ └─────────────────────────────────────────────────────────────────┘ │\r│ │ │\r│ ▼ │\r│ ┌─────────────────────────────────────────────────────────────────┐ │\r│ │ Lambda Function: API Router (512MB, 30s timeout) │ │\r│ │ ├─ JWT Validation \u0026amp; User Context Extraction │ │\r│ │ ├─ Request Routing đến Target Lambda Functions │ │\r│ │ └─ Error Handling \u0026amp; Response Formatting │ │\r│ └─────────────────────────────────────────────────────────────────┘ │\r│ │ │\r│ ┌────────────────┼────────────────┬──────────────────┐ │\r│ ▼ ▼ ▼ ▼ │\r│ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ │\r│ │ Auth \u0026amp; │ │ Social │ │ Recipe │ │ Admin │ │\r│ │ User │ │ Module │ │ \u0026amp; AI │ │ Module │ │\r│ │ Lambda │ │ Lambda │ │ Lambda │ │ Lambda │ │\r│ │ (512MB) │ │ (512MB) │ │ (512MB) │ │ (512MB) │ │\r│ └─────────┘ └─────────┘ └─────────┘ └─────────┘ │\r│ │ │ │\r│ ▼ ▼ │\r│ ┌─────────────────────────────────────────────────────────────────┐ │\r│ │ SQS Queues + Worker Lambdas │ │\r│ │ │ │\r│ │ 1️⃣ AI Queue → AI Worker (1024MB, 60s) │ │\r│ │ ├─ Bedrock Claude 3 Haiku (us-east-1) │ │\r│ │ ├─ Tạo recipe từ ingredients │ │\r│ │ └─ Visibility timeout: 2 phút │ │\r│ │ │ │\r│ │ 2️⃣ Image Queue → Image Worker (512MB, 60s) │ │\r│ │ ├─ Tối ưu hóa hình ảnh S3 │ │\r│ │ ├─ Resize, compress, watermark │ │\r│ │ └─ Visibility timeout: 60 giây │ │\r│ │ │ │\r│ │ 📌 Chỉ 2 queues được sử dụng tích cực (AI \u0026amp; Image) │ │\r│ │ 📌 Analytics \u0026amp; Notification queues tồn tại nhưng không có workers │ │\r│ │ 📌 Tất cả queues có DLQ (14-day retention) │ │\r│ └─────────────────────────────────────────────────────────────────┘ │\r│ │\r│ Dependencies từ Các Stack Khác: │\r│ ├─ DynamoDB Table (Core Stack) │\r│ ├─ S3 Content Bucket (Core Stack) │\r│ ├─ CloudFront Distribution (Core Stack) │\r│ ├─ Cognito User Pool (Auth Stack) │\r│ └─ Cognito User Pool Client (Auth Stack) │\r└──────────────────────────────────────────────────────────────────────┘ Cấu Hình Stack Cấu Trúc File infrastructure/lib/stacks/\r└── backend-stack.ts # Backend Stack implementation (2965 dòng)\r├─ API Gateway configuration\r├─ Lambda function definitions (6 functions)\r├─ SQS queue configuration (4 queues + 4 DLQs)\r├─ Worker Lambda definitions (2 workers hoạt động)\r└─ WAF Web ACL configuration\rservices/ # Lambda function source code\r├── api-router/ # API Router Lambda\r├── auth-module/ # Auth \u0026amp; User Lambda\r├── social-module/ # Social Lambda\r├── recipe-module/ # Recipe \u0026amp; AI Lambda\r├── admin-module/ # Admin Lambda\r├── upload-module/ # Upload Lambda\r├── ai-module/ # AI Worker Lambda\r│ └── workers/\r├── image-worker/ # Image Worker Lambda\r├── websocket-module/ # WebSocket (stack riêng, không trong Backend)\r└── shared/ # Shared utilities Triển Khai Code File: infrastructure/lib/stacks/backend-stack.ts\n1. Stack Interface \u0026amp; Constructor export interface BackendStackProps extends BaseStackProps { dynamoTable: cdk.aws_dynamodb.ITable; contentBucket: cdk.aws_s3.IBucket; distribution: cdk.aws_cloudfront.IDistribution; userPool: cdk.aws_cognito.IUserPool; userPoolClient: cdk.aws_cognito.IUserPoolClient; } export class BackendStack extends BaseStack { // Lambda Layer public readonly sharedLayer: SharedDependenciesLayer; // API Gateway public readonly api: cdk.aws_apigateway.RestApi; public readonly cognitoAuthorizer: cdk.aws_apigateway.CognitoUserPoolsAuthorizer; public readonly apiDomainName: cdk.aws_apigateway.DomainName; // Request Validators public readonly bodyValidator: cdk.aws_apigateway.RequestValidator; public readonly paramsValidator: cdk.aws_apigateway.RequestValidator; public readonly fullValidator: cdk.aws_apigateway.RequestValidator; // Lambda Functions (6 business functions) public readonly apiRouterFunction: cdk.aws_lambda.Function; // services/api-router public readonly authUserFunction: cdk.aws_lambda.Function; // services/auth-module public readonly socialFunction: cdk.aws_lambda.Function; // services/social-module public readonly recipeAIFunction: cdk.aws_lambda.Function; // services/recipe-module public readonly adminFunction: cdk.aws_lambda.Function; // services/admin-module public readonly uploadFunction: cdk.aws_lambda.Function; // services/upload-module // SQS Queues (4 queues + 4 DLQs) public readonly aiQueue: cdk.aws_sqs.Queue; public readonly imageProcessingQueue: cdk.aws_sqs.Queue; public readonly analyticsQueue: cdk.aws_sqs.Queue; public readonly notificationQueue: cdk.aws_sqs.Queue; // Worker Lambdas (2 workers hoạt động) public readonly aiWorker: cdk.aws_lambda.Function; // services/ai-module/workers public readonly imageWorker?: cdk.aws_lambda.Function; // services/image-worker // Lưu ý: analyticsWorker \u0026amp; notificationWorker tồn tại trong code nhưng KHÔNG triển khai // public readonly analyticsWorker?: cdk.aws_lambda.Function; // Đã comment out // public readonly notificationWorker?: cdk.aws_lambda.Function; // Không được tạo // WAF WebACL public readonly apiGatewayWebAcl?: cdk.aws_wafv2.CfnWebACL; constructor(scope: Construct, id: string, props: BackendStackProps) { super(scope, id, props); // Thêm các tag đặc thù cho stack cdk.Tags.of(this).add(\u0026#39;StackType\u0026#39;, \u0026#39;Backend\u0026#39;); cdk.Tags.of(this).add(\u0026#39;Layer\u0026#39;, \u0026#39;Application\u0026#39;); cdk.Tags.of(this).add(\u0026#39;CostCenter\u0026#39;, `Backend-${this.config.environment}`); // Tạo resources (xem implementation bên dưới) // 1. Shared Dependencies Layer // 2. SQS Queues và DLQs // 3. API Gateway // 4. Lambda Functions // 5. Worker Lambdas // 6. WAF Web ACL // 7. Export outputs } } 2. Cấu Hình API Gateway private createAPIGateway(): cdk.aws_apigateway.RestApi { const cachingEnabled = this.config.apiGateway.caching.enabled; const compressionEnabled = this.config.apiGateway.compression; const api = new cdk.aws_apigateway.RestApi(this, \u0026#39;EveryoneCookAPI\u0026#39;, { restApiName: `EveryoneCook-API-${this.config.environment}`, description: `Everyone Cook REST API - ${this.config.environment}`, // Compression cho responses \u0026gt;1KB minCompressionSize: compressionEnabled ? cdk.Size.kibibytes(1) : undefined, deployOptions: { stageName: \u0026#39;api\u0026#39;, // Cấu hình caching (chỉ production) cachingEnabled: cachingEnabled, cacheClusterEnabled: cachingEnabled, cacheClusterSize: cachingEnabled ? this.config.apiGateway.caching.cacheSize : undefined, cacheTtl: cachingEnabled ? cdk.Duration.seconds(this.config.apiGateway.caching.ttl) : undefined, cacheDataEncrypted: cachingEnabled, // Throttling settings throttlingRateLimit: this.config.apiGateway.throttling.rateLimit, throttlingBurstLimit: this.config.apiGateway.throttling.burstLimit, // X-Ray Tracing - Tắt (CloudWatch Logs đủ dùng) tracingEnabled: false, // Cấu hình logging loggingLevel: cdk.aws_apigateway.MethodLoggingLevel.INFO, dataTraceEnabled: this.config.environment !== \u0026#39;prod\u0026#39;, metricsEnabled: true, // Access logging accessLogDestination: new cdk.aws_apigateway.LogGroupLogDestination( new cdk.aws_logs.LogGroup(this, \u0026#39;APIGatewayAccessLogs\u0026#39;, { logGroupName: `/aws/apigateway/everyonecook-${this.config.environment}`, retention: this.config.cloudwatch.logRetentionDays, }) ), }, // Cấu hình CORS defaultCorsPreflightOptions: { allowOrigins: [ `https://${this.config.domains.frontend}`, `https://www.${this.config.domains.frontend}`, ...(this.config.environment !== \u0026#39;prod\u0026#39; ? [\u0026#39;http://localhost:3000\u0026#39;] : []), ], allowMethods: [\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;, \u0026#39;PUT\u0026#39;, \u0026#39;DELETE\u0026#39;, \u0026#39;PATCH\u0026#39;, \u0026#39;OPTIONS\u0026#39;], allowHeaders: [ \u0026#39;Content-Type\u0026#39;, \u0026#39;Authorization\u0026#39;, \u0026#39;X-Amz-Date\u0026#39;, \u0026#39;X-Api-Key\u0026#39;, \u0026#39;X-Amz-Security-Token\u0026#39;, \u0026#39;X-Correlation-Id\u0026#39;, \u0026#39;Cache-Control\u0026#39;, \u0026#39;Accept-Encoding\u0026#39;, ], allowCredentials: false, maxAge: cdk.Duration.hours(1), }, // Cấu hình endpoint endpointConfiguration: { types: [cdk.aws_apigateway.EndpointType.REGIONAL], }, // Binary media types binaryMediaTypes: [\u0026#39;image/*\u0026#39;, \u0026#39;application/octet-stream\u0026#39;], }); // Thêm Gateway Responses với CORS headers const corsHeaders = { \u0026#39;gatewayresponse.header.Access-Control-Allow-Origin\u0026#39;: \u0026#34;\u0026#39;*\u0026#39;\u0026#34;, \u0026#39;gatewayresponse.header.Access-Control-Allow-Headers\u0026#39;: \u0026#34;\u0026#39;Content-Type,Authorization,...\u0026#39;\u0026#34;, \u0026#39;gatewayresponse.header.Access-Control-Allow-Methods\u0026#39;: \u0026#34;\u0026#39;GET,POST,PUT,DELETE,PATCH,OPTIONS\u0026#39;\u0026#34;, }; api.addGatewayResponse(\u0026#39;Unauthorized\u0026#39;, { type: cdk.aws_apigateway.ResponseType.UNAUTHORIZED, statusCode: \u0026#39;401\u0026#39;, responseHeaders: corsHeaders, }); return api; } 3. Cấu Hình SQS Queue private createAIQueue(): cdk.aws_sqs.Queue { const queue = new cdk.aws_sqs.Queue(this, \u0026#39;AIQueue\u0026#39;, { queueName: `everyonecook-${this.config.environment}-ai-queue`, visibilityTimeout: cdk.Duration.seconds(120), // 2 phút cho AI processing retentionPeriod: cdk.Duration.days(4), deadLetterQueue: { queue: this.aiDLQ, maxReceiveCount: 3, }, encryption: cdk.aws_sqs.QueueEncryption.KMS_MANAGED, }); // CloudWatch alarm cho queue depth if (this.config.cloudwatch.alarms.enabled) { new cdk.aws_cloudwatch.Alarm(this, \u0026#39;AIQueueDepthAlarm\u0026#39;, { alarmName: `EveryoneCook-${this.config.environment}-AI-Queue-Depth`, metric: queue.metricApproximateNumberOfMessagesVisible(), threshold: 100, evaluationPeriods: 2, }); } return queue; } 4. Cấu Hình Lambda Function private createAuthUserLambda(props: BackendStackProps): cdk.aws_lambda.Function { const logGroup = new cdk.aws_logs.LogGroup(this, \u0026#39;AuthUserLogGroup\u0026#39;, { logGroupName: `/aws/lambda/everyonecook-${this.config.environment}-auth-user`, retention: this.config.cloudwatch.logRetentionDays, }); const authUserFunction = new cdk.aws_lambda.Function(this, \u0026#39;AuthUserFunction\u0026#39;, { functionName: `everyonecook-${this.config.environment}-auth-user`, runtime: cdk.aws_lambda.Runtime.NODEJS_20_X, handler: \u0026#39;services/auth-module/index.handler\u0026#39;, code: this.createLambdaCode(\u0026#39;services/auth-module/deployment\u0026#39;), layers: [this.sharedLayer.layer], memorySize: 512, timeout: cdk.Duration.seconds(30), tracing: cdk.aws_lambda.Tracing.DISABLED, environment: { DYNAMODB_TABLE: props.dynamoTable.tableName, USER_POOL_ID: props.userPool.userPoolId, USER_POOL_CLIENT_ID: props.userPoolClient.userPoolClientId, CONTENT_BUCKET: props.contentBucket.bucketName, LOG_LEVEL: this.config.environment === \u0026#39;prod\u0026#39; ? \u0026#39;INFO\u0026#39; : \u0026#39;DEBUG\u0026#39;, }, logGroup: logGroup, }); // Cấp permissions props.dynamoTable.grantReadWriteData(authUserFunction); props.contentBucket.grantReadWrite(authUserFunction); props.userPool.grant(authUserFunction, \u0026#39;cognito-idp:AdminGetUser\u0026#39;, \u0026#39;cognito-idp:ListUsers\u0026#39;); return authUserFunction; } 5. Cấu Hình WAF Web ACL private createApiGatewayWebAcl(): cdk.aws_wafv2.CfnWebACL { const webAcl = new cdk.aws_wafv2.CfnWebACL(this, \u0026#39;ApiGatewayWebACL\u0026#39;, { name: `EveryoneCook-API-WAF-${this.config.environment}`, scope: \u0026#39;REGIONAL\u0026#39;, defaultAction: { allow: {} }, visibilityConfig: { sampledRequestsEnabled: true, cloudWatchMetricsEnabled: true, metricName: `EveryoneCook-API-WAF-${this.config.environment}`, }, rules: [ // Rule 1: Rate Limiting { name: \u0026#39;RateLimitRule\u0026#39;, priority: 0, statement: { rateBasedStatement: { limit: 2000, // 2000 requests mỗi 5 phút aggregateKeyType: \u0026#39;IP\u0026#39;, }, }, action: { block: {} }, visibilityConfig: { sampledRequestsEnabled: true, cloudWatchMetricsEnabled: true, metricName: \u0026#39;RateLimitRule\u0026#39;, }, }, // Rule 2-5: AWS Managed Rules (SQL injection, XSS, v.v.) // ... xem full implementation ], }); return webAcl; } Chi Tiết Cấu Hình Chính 1. Shared Dependencies Layer Backend Stack sử dụng Lambda Layer để chia sẻ common dependencies giữa tất cả Lambda functions:\n// Tạo Shared Dependencies Layer this.sharedLayer = new SharedDependenciesLayer(this, \u0026#39;SharedDependenciesLayer\u0026#39;); // Lợi ích: // - Giảm 90% kích thước deployment (8MB → 200KB mỗi Lambda) // - Triển khai nhanh hơn // - Phiên bản dependency nhất quán // - Chi phí lưu trữ thấp hơn // Dependencies bao gồm: // - AWS SDK v3 clients (DynamoDB, Lambda, Cognito, S3, SQS, Bedrock) // - uuid, jsonwebtoken, jwks-rsa 2. API Gateway Custom Domain Stack tạo custom domain cho API Gateway với ACM certificate:\n// Cấu hình custom domain const domainName = this.config.domains.api; // api.everyonecook.cloud // Tạo ACM certificate trong ap-southeast-1 (Regional endpoint) const certificate = new acm.Certificate(this, \u0026#39;ApiGatewayCertificate\u0026#39;, { domainName: \u0026#39;*.everyonecook.cloud\u0026#39;, validation: acm.CertificateValidation.fromDns(hostedZone), }); // Tạo API Gateway DomainName const apiDomainName = new cdk.aws_apigateway.DomainName(this, \u0026#39;ApiDomain\u0026#39;, { domainName: this.config.domains.api, certificate: certificate, endpointType: cdk.aws_apigateway.EndpointType.REGIONAL, securityPolicy: cdk.aws_apigateway.SecurityPolicy.TLS_1_2, }); // Tạo Route 53 A record (Alias) new cdk.aws_route53.ARecord(this, \u0026#39;ApiAliasRecord\u0026#39;, { zone: hostedZone, recordName: this.config.domains.api, target: cdk.aws_route53.RecordTarget.fromAlias( new cdk.aws_route53_targets.ApiGatewayDomain(apiDomainName) ), }); Environments:\nDev: api-dev.everyonecook.cloud Staging: api-staging.everyonecook.cloud Prod: api.everyonecook.cloud 3. Request Validation Stack triển khai ba cấp độ request validation:\n// 1. Body Validator - Chỉ validate request body this.bodyValidator = new cdk.aws_apigateway.RequestValidator(this, \u0026#39;BodyValidator\u0026#39;, { restApi: api, validateRequestBody: true, validateRequestParameters: false, }); // 2. Params Validator - Chỉ validate query strings và headers this.paramsValidator = new cdk.aws_apigateway.RequestValidator(this, \u0026#39;ParamsValidator\u0026#39;, { restApi: api, validateRequestBody: false, validateRequestParameters: true, }); // 3. Full Validator - Validate cả body và parameters this.fullValidator = new cdk.aws_apigateway.RequestValidator(this, \u0026#39;FullValidator\u0026#39;, { restApi: api, validateRequestBody: true, validateRequestParameters: true, }); // Lợi ích: // - Từ chối sớm các request không hợp lệ (trước khi invoke Lambda) // - Tối ưu chi phí: Không tính phí Lambda cho invalid requests // - Bảo mật: Ngăn chặn malformed requests // - Hiệu năng: Phản hồi lỗi nhanh hơn 4. Quy Ước Đặt Tên Resource Tất cả resources tuân theo pattern đặt tên nhất quán:\n// Lambda function format: everyonecook-{env}-{function} functionName: `everyonecook-${this.config.environment}-auth-user` // SQS queue format: everyonecook-{env}-{queue} queueName: `everyonecook-${this.config.environment}-ai-queue` // API Gateway format: EveryoneCook-API-{env} restApiName: `EveryoneCook-API-${this.config.environment}` // WAF format: EveryoneCook-API-WAF-{env} name: `EveryoneCook-API-WAF-${this.config.environment}` Ví dụ:\nStack name: EveryoneCook-dev-Backend API: EveryoneCook-API-dev Lambda: everyonecook-dev-auth-user Queue: everyonecook-dev-ai-queue 5. Resource Tags Mỗi resource được tag để theo dõi chi phí và quản lý:\n{ Stack: \u0026#39;EveryoneCook-dev-Backend\u0026#39;, Environment: \u0026#39;dev\u0026#39;, StackType: \u0026#39;Backend\u0026#39;, Layer: \u0026#39;Application\u0026#39;, CostCenter: \u0026#39;Backend-dev\u0026#39;, Component: \u0026#39;API\u0026#39; | \u0026#39;EventProcessing\u0026#39; | \u0026#39;Security\u0026#39;, Module: \u0026#39;AuthUser\u0026#39; | \u0026#39;Social\u0026#39; | \u0026#39;RecipeAI\u0026#39; | \u0026#39;Admin\u0026#39; | \u0026#39;Upload\u0026#39;, Purpose: \u0026#39;REST-API\u0026#39; | \u0026#39;RequestRouting\u0026#39; | \u0026#39;AI-Processing\u0026#39;, Project: \u0026#39;EveryoneCook\u0026#39; } Stack Outputs Sau khi triển khai, stack export các giá trị sau:\nOutput Name Value Sử dụng ApiUrl https://api.everyonecook.cloud Frontend API endpoint ApiId abc123xyz API Gateway REST API ID ApiStage api API Gateway stage name ApiDomainName api.everyonecook.cloud Custom domain name AIQueueUrl https://sqs.ap-southeast-1... AI Queue URL để gửi messages ImageQueueUrl https://sqs.ap-southeast-1... Image Queue URL WafWebAclArn arn:aws:wafv2:... WAF Web ACL ARN Các Bước Triển Khai Bước 1: Xem Lại Cấu Hình Di chuyển đến thư mục infrastructure:\ncd D:\\Project_AWS\\everyonecook\\infrastructure Xác minh cấu hình môi trường Development trong config/environment.ts:\ndev: { environment: \u0026#39;dev\u0026#39;, account: \u0026#39;YOUR_AWS_ACCOUNT_ID\u0026#39;, region: \u0026#39;ap-southeast-1\u0026#39;, domains: { frontend: \u0026#39;dev.everyonecook.cloud\u0026#39;, api: \u0026#39;api-dev.everyonecook.cloud\u0026#39;, cdn: \u0026#39;cdn-dev.everyonecook.cloud\u0026#39;, }, apiGateway: { caching: { enabled: false, // Tắt trong dev (bật trong prod) cacheSize: \u0026#39;0.5\u0026#39;, // 0.5GB cache (chỉ prod) ttl: 300, // 5 phút (chỉ prod) }, compression: true, // Bật trong tất cả environments throttling: { rateLimit: 10000, burstLimit: 5000, }, }, cloudwatch: { logRetentionDays: 7, // Dev: 7 ngày, Staging: 30 ngày, Prod: 90 ngày alarms: { enabled: true, }, }, // ... các configs khác } Cho Staging/Production: Cập nhật tham số --context environment= trong các lệnh triển khai.\nBước 2: Chuẩn Bị Lambda Deployment Packages Trước khi triển khai, chuẩn bị Lambda deployment packages cho 8 Lambda functions + 1 Layer:\n# 1. Chuẩn bị Shared Layer TRƯỚC TIÊN (bắt buộc cho tất cả Lambdas) cd D:\\Project_AWS\\everyonecook\\layers\\shared-dependencies .\\prepare-layer.ps1 # 2. Chuẩn bị Business Lambda Functions (6 functions) cd D:\\Project_AWS\\everyonecook\\services\\api-router .\\prepare-deployment-layer.ps1 # hoặc prepare-deployment.ps1 cd D:\\Project_AWS\\everyonecook\\services\\auth-module .\\prepare-deployment-layer.ps1 cd D:\\Project_AWS\\everyonecook\\services\\social-module .\\prepare-deployment-layer.ps1 cd D:\\Project_AWS\\everyonecook\\services\\recipe-module .\\prepare-deployment-layer.ps1 cd D:\\Project_AWS\\everyonecook\\services\\admin-module .\\prepare-deployment-layer.ps1 cd D:\\Project_AWS\\everyonecook\\services\\upload-module .\\prepare-deployment-layer.ps1 # 3. Chuẩn bị Worker Lambda Functions (2 workers) cd D:\\Project_AWS\\everyonecook\\services\\ai-module .\\prepare-deployment.ps1 # AI Worker sử dụng prepare-deployment.ps1 cd D:\\Project_AWS\\everyonecook\\services\\image-worker .\\prepare-deployment-layer.ps1 Lưu Ý Quan Trọng:\nMỗi service phải có thư mục deployment/ sau khi chạy prepare script Shared Layer phải được build TRƯỚC TIÊN vì tất cả Lambdas phụ thuộc vào nó Kiểm tra prepare-deployment.ps1 hoặc prepare-deployment-layer.ps1 trong mỗi service folder Tổng kích thước deployment: ~8MB → ~200KB mỗi Lambda (nhờ Shared Layer) Bước 3: Synthesize CloudFormation Template Tạo CloudFormation template để xem lại các thay đổi:\n# Quay về thư mục infrastructure cd D:\\Project_AWS\\everyonecook\\infrastructure # Synthesize template npx cdk synth EveryoneCook-dev-Backend --context environment=dev Kết quả mong đợi hiển thị CloudFormation template với tất cả resources.\nBước 4: Triển Khai Backend Stack Triển khai Backend stack lên AWS:\n# Chỉ triển khai Backend Stack npx cdk deploy EveryoneCook-dev-Backend --context environment=dev # Hoặc triển khai với approval npx cdk deploy EveryoneCook-dev-Backend --context environment=dev --require-approval never Kết quả mong đợi:\n✨ Synthesis time: 5.23s\rEveryoneCook-dev-Backend: deploying...\r[0%] start: Publishing abc123:current_account-current_region\r[33%] success: Published abc123:current_account-current_region\r[33%] start: Publishing def456:current_account-current_region\r[66%] success: Published def456:current_account-current_region\r[66%] start: Publishing EveryoneCook-dev-Backend\r[100%] success: Published EveryoneCook-dev-Backend\rEveryoneCook-dev-Backend: creating CloudFormation changeset...\rEveryoneCook-dev-Backend\r✨ Deployment time: 420.15s\rOutputs:\rEveryoneCook-dev-Backend.ApiUrl = https://api-dev.everyonecook.cloud\rEveryoneCook-dev-Backend.ApiId = abc123xyz\rEveryoneCook-dev-Backend.ApiStage = api\rEveryoneCook-dev-Backend.ApiDomainName = api-dev.everyonecook.cloud\rEveryoneCook-dev-Backend.AIQueueUrl = https://sqs.ap-southeast-1.amazonaws.com/123456789/everyonecook-dev-ai-queue\rEveryoneCook-dev-Backend.ImageQueueUrl = https://sqs.ap-southeast-1.amazonaws.com/123456789/everyonecook-dev-image-queue\rEveryoneCook-dev-Backend.WafWebAclArn = arn:aws:wafv2:ap-southeast-1:123456789:regional/webacl/EveryoneCook-API-WAF-dev/...\rStack ARN:\rarn:aws:cloudformation:ap-southeast-1:123456789:stack/EveryoneCook-dev-Backend/...\r✨ Total time: 425.38s Thời gian triển khai: ~7 phút (bao gồm certificate validation)\nBước 5: Xác Minh Triển Khai trên AWS Console 5.1: Xác Minh API Gateway Điều hướng đến API Gateway Console Chọn region: ap-southeast-1 Click vào EveryoneCook-API-dev Dashboard API Gateway hiển thị tên API, stage, custom domain, trạng thái caching và throttling settings\nClick vào Stages → api Xác minh stage settings: Cache Settings: Enabled (prod) / Disabled (dev) Cache capacity: 0.5 GB (chỉ prod) Default TTL: 300 seconds (chỉ prod) Throttling: 10000 requests/sec Burst: 5000 requests/sec Stage settings hiển thị cấu hình caching và throttling\nClick vào Custom domain names Xác minh custom domain: Domain name: api-dev.everyonecook.cloud Certificate: ACM certificate (Regional) Base path mapping: / → api stage Cấu hình custom domain với ACM certificate\n5.2: Xác Minh Lambda Functions Điều hướng đến Lambda Console Chọn region: ap-southeast-1 Xác minh tất cả 8 Lambda functions tồn tại: Tên Function Runtime Memory Timeout Layer Source Code everyonecook-dev-api-router Node 20.x 512MB 30s SharedDependenciesLayer services/api-router everyonecook-dev-auth-user Node 20.x 512MB 30s SharedDependenciesLayer services/auth-module everyonecook-dev-social Node 20.x 512MB 30s SharedDependenciesLayer services/social-module everyonecook-dev-recipe-ai Node 20.x 512MB 30s SharedDependenciesLayer services/recipe-module everyonecook-dev-admin Node 20.x 512MB 30s SharedDependenciesLayer services/admin-module everyonecook-dev-upload Node 20.x 512MB 30s SharedDependenciesLayer services/upload-module everyonecook-dev-ai-worker Node 20.x 1024MB 60s SharedDependenciesLayer services/ai-module/workers everyonecook-dev-image-worker Node 20.x 512MB 60s SharedDependenciesLayer services/image-worker Danh sách Lambda functions hiển thị tất cả 8 functions với runtime và configuration\nClick vào everyonecook-dev-api-router Xác minh configuration: Environment variables: DYNAMODB_TABLE, USER_POOL_ID, v.v. Layers: SharedDependenciesLayer Triggers: API Gateway (Proxy integration) API Router function hiển thị environment variables, layers, và API Gateway trigger\nClick vào tab Monitoring Xác minh CloudWatch Logs integration: Log group: /aws/lambda/everyonecook-dev-api-router Retention: Dựa trên environment config Dashboard monitoring Lambda hiển thị CloudWatch Logs và metrics\n5.3: Xác Minh SQS Queues Điều hướng đến SQS Console Chọn region: ap-southeast-1 Xác minh 4 queues hoạt động tồn tại (2 main + 2 DLQs): Lưu ý: Chỉ AI và Image queues được sử dụng tích cực. Analytics và Notification queues tồn tại trong code nhưng không được triển khai.\nTên Queue Type Visibility Timeout Retention DLQ Trạng thái Worker everyonecook-dev-ai-queue Main 2 phút 4 ngày everyonecook-dev-ai-dlq Hoạt động everyonecook-dev-ai-dlq DLQ 5 phút 14 ngày - - everyonecook-dev-image-queue Main 60 giây 4 ngày everyonecook-dev-image-dlq Hoạt động everyonecook-dev-image-dlq DLQ 5 phút 14 ngày - - Danh sách SQS queues hiển thị 4 queues hoạt động: ai-queue, ai-dlq, image-queue, image-dlq\nClick vào everyonecook-dev-ai-queue Xác minh queue configuration: Visibility timeout: 2 phút Message retention: 4 ngày Dead-letter queue: everyonecook-dev-ai-dlq Maximum receives: 3 Encryption: KMS managed Cấu hình AI Queue hiển thị visibility timeout, retention, DLQ, và encryption settings\nClick vào tab Lambda triggers Xác minh Lambda trigger: Function: everyonecook-dev-ai-worker Batch size: 1 Batch window: 0 seconds AI Queue Lambda trigger hiển thị ai-worker function với batch configuration\n5.4: Xác Minh WAF Web ACL Điều hướng đến WAF \u0026amp; Shield Console Chọn region: ap-southeast-1 (Regional) Click vào Web ACLs Click vào EveryoneCook-API-WAF-dev Dashboard WAF Web ACL để bảo vệ EveryoneCook API\nClick vào tab Rules Xác minh tất cả 5 rules tồn tại: Priority Tên Rule Type Action Status 0 RateLimitRule Rate-based Block Enabled 1 AWSManagedRulesSQLi Managed Block Enabled 2 AWSManagedRulesKnownBadInputs Managed Block Enabled 3 AWSManagedRulesCoreRuleSet Managed Block Enabled 4 RequestSizeLimit Size constraint Block Enabled 5.5: Xác Minh CloudWatch Alarms Điều hướng đến CloudWatch Console Chọn region: ap-southeast-1 Filter theo: EveryoneCook-dev-Backend CloudWatch alarms cho Backend Stack: Queue depth, Lambda errors/duration, WAF blocks\n5.6: Xác Minh Route 53 DNS Record Điều hướng đến Route 53 Console Click vào Hosted zones Click vào everyonecook.cloud Xác minh A record tồn tại: Name: api-dev.everyonecook.cloud Type: A (Alias) Target: API Gateway domain name Routing policy: Simple Route 53 A record (Alias) trỏ đến API Gateway custom domain\nBước 6: Kiểm Tra API Endpoint Kiểm tra custom domain endpoint:\n# Kiểm tra API Gateway health endpoint (nếu tồn tại) curl https://api-dev.everyonecook.cloud/health # Hoặc kiểm tra với browser start https://api-dev.everyonecook.cloud Phản hồi mong đợi (nếu health endpoint tồn tại):\n{ \u0026#34;status\u0026#34;: \u0026#34;healthy\u0026#34;, \u0026#34;environment\u0026#34;: \u0026#34;dev\u0026#34;, \u0026#34;timestamp\u0026#34;: \u0026#34;2024-01-15T10:30:00Z\u0026#34; } Sự Khác Biệt Giữa Các Environment Hướng dẫn này sử dụng môi trường Development (dev) làm ví dụ. Dưới đây là các khác biệt chính giữa các môi trường:\nDomain Names Environment API Domain Frontend Domain Dev api-dev.everyonecook.cloud dev.everyonecook.cloud Staging api-staging.everyonecook.cloud staging.everyonecook.cloud Prod api.everyonecook.cloud everyonecook.cloud Resource Naming Loại Resource Dev Staging Prod Stack Name EveryoneCook-dev-Backend EveryoneCook-staging-Backend EveryoneCook-prod-Backend API Gateway EveryoneCook-API-dev EveryoneCook-API-staging EveryoneCook-API-prod Lambda everyonecook-dev-auth-user everyonecook-staging-auth-user everyonecook-prod-auth-user SQS Queue everyonecook-dev-ai-queue everyonecook-staging-ai-queue everyonecook-prod-ai-queue WAF EveryoneCook-API-WAF-dev EveryoneCook-API-WAF-staging EveryoneCook-API-WAF-prod Sự Khác Biệt Cấu Hình Setting Dev Staging Production API Caching Tắt Tắt Bật (0.5GB) Data Trace Logging Bật Bật Tắt Log Retention 7 ngày 30 ngày 90 ngày CloudWatch Removal DESTROY DESTROY RETAIN WAF Rate Limit 2000 req/5min 2000 req/5min 5000 req/5min Lambda Log Level DEBUG INFO INFO CORS Localhost Cho phép Không cho phép Không cho phép Lệnh Triển Khai # Development npx cdk deploy EveryoneCook-dev-Backend --context environment=dev # Staging npx cdk deploy EveryoneCook-staging-Backend --context environment=staging # Production (yêu cầu approval) npx cdk deploy EveryoneCook-prod-Backend --context environment=prod --require-approval broadening Cân Nhắc Đặc Thù Cho Từng Environment Development CORS cho phép http://localhost:3000 để kiểm tra frontend local Data trace logging bật để debug Log retention thấp hơn (7 ngày) để giảm chi phí Resources bị xóa khi xóa stack (RemovalPolicy.DESTROY) Staging Cấu hình giống production để kiểm tra pre-release Domain riêng để tránh ảnh hưởng production Các quy tắc bảo mật giống production Resources bị xóa khi xóa stack Production API Gateway caching bật (0.5GB, 5-min TTL) Data trace logging tắt (tối ưu chi phí) Log retention 90 ngày để tuân thủ Resources được giữ lại khi xóa stack (RemovalPolicy.RETAIN) WAF rate limits nghiêm ngặt hơn Không có localhost CORS Phân Tích Chi Phí Phân Tích Chi Phí Hàng Tháng (Dev Environment) Dịch vụ Cấu hình Chi phí hàng tháng API Gateway 1M requests, caching tắt ~$3.50 Lambda (6 functions) 512MB, 1M invocations, 200ms avg ~$8.40 Lambda (2 workers) 512-1024MB, 10K invocations ~$0.42 SQS (2 queues) 10K messages/tháng ~$0.03 WAF Web ACL 1 ACL + 5 rules + 1M requests ~$10.60 CloudWatch Logs 5GB ingestion, 30-day retention ~$2.50 CloudWatch Alarms 10 alarms ~$1.00 Tổng Backend Stack ~$26.45/tháng Ước Tính Chi Phí Production Dịch vụ Cấu hình Chi phí hàng tháng API Gateway 10M requests, caching bật (0.5GB) ~$50.00 Lambda (6 functions) 512MB, 10M invocations, 200ms avg ~$84.00 Lambda (2 workers) 512-1024MB, 100K invocations ~$4.20 SQS (2 queues) 100K messages/tháng ~$0.25 WAF Web ACL 1 ACL + 5 rules + 10M requests ~$16.00 CloudWatch Logs 20GB ingestion, 90-day retention ~$10.00 CloudWatch Alarms 15 alarms ~$1.50 Tổng Backend Stack ~$165.95/tháng Các Bước Tiếp Theo Sau khi triển khai Backend Stack:\nTriển khai Frontend Stack (Phase 5) - Ứng dụng Next.js trên CloudFront Triển khai Observability Stack (Phase 6) - CloudWatch dashboards và alarms Kiểm tra API Integration - Xác minh tất cả endpoints hoạt động chính xác Load Testing - Kiểm tra hiệu năng và khả năng mở rộng Security Audit - Xem lại WAF rules và access controls Tài Liệu Tham Khảo Infrastructure Code Backend Stack: infrastructure/lib/stacks/backend-stack.ts (2965 dòng) Shared Layer Construct: infrastructure/lib/constructs/shared-layer.ts Lambda Function Source Code (6 Business Functions) API Router: services/api-router/ - Request routing \u0026amp; JWT validation Auth User Module: services/auth-module/ - Authentication \u0026amp; user profiles Social Module: services/social-module/ - Posts, comments, friends, notifications Recipe AI Module: services/recipe-module/ - Recipe CRUD, AI generation, search Admin Module: services/admin-module/ - Content moderation, user management Upload Module: services/upload-module/ - S3 presigned URLs, file uploads Worker Lambda Source Code (2 Active Workers) AI Worker: services/ai-module/workers/ - Bedrock Claude 3 Haiku integration Image Worker: services/image-worker/ - Image optimization (resize, compress) Shared Dependencies Shared Layer: layers/shared-dependencies/ - AWS SDK v3, uuid, jsonwebtoken, jwks-rsa Other Services (Không trong Backend Stack) WebSocket Module: services/websocket-module/ - Real-time communication (stack riêng) Shared Utilities: services/shared/ - Common utilities across services Tóm Tắt Backend Stack là stack lớn nhất và phức tạp nhất trong hạ tầng EveryoneCook. Nó tổng hợp:\nAPI Gateway với custom domain (caching chỉ trong prod) 6 Lambda functions cho business logic 2 SQS queues hoạt động cho async processing (tổng 4 với DLQs) 2 worker Lambda functions (AI Worker, Image Worker) WAF Web ACL cho bảo mật (5 quy tắc bảo vệ) CloudWatch monitoring và alarms Thực Sự Được Triển Khai: 8 Lambda functions, 4 SQS queues (2 hoạt động với workers), 1 WAF Web ACL, CloudWatch alarms\nDevelopment Environment Checklist Chuẩn bị tất cả Lambda deployment packages (8 functions + 1 layer) Xem lại cấu hình môi trường dev Xác minh caching tắt (chỉ prod) Kiểm tra từng Lambda function độc lập Theo dõi CloudWatch alarms Xác minh WAF rules không chặn legitimate traffic Kiểm tra localhost CORS (chỉ dev) Cho Staging/Production Deployment Xem lại Sự Khác Biệt Giữa Các Environment Bật API Gateway caching (chỉ prod) Tắt data trace logging (chỉ prod) Thiết lập log retention phù hợp (90 ngày cho prod) Cập nhật WAF rate limits (cao hơn cho prod) Loại bỏ localhost khỏi CORS Sử dụng --require-approval broadening cho production Thứ Tự Triển Khai: DNS → Certificate → Core → Auth → Backend → Frontend → Observability\nEnvironments: Hướng dẫn này minh họa triển khai dev. Lặp lại cho staging và prod với cấu hình phù hợp.\n"
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/5-workshop/5.06-configure-api-lambda/",
	"title": "Cấu hình API &amp; Lambda",
	"tags": [],
	"description": "",
	"content": "Tổng quan Sau khi deploy infrastructure, bạn cần cấu hình API Gateway routes và Lambda functions để xử lý business logic.\nKiến trúc API API Gateway (api.everyonecook.cloud)\r↓\rAPI Router Lambda (entry point)\r↓\r┌─────────┬─────────┬─────────┬─────────┬─────────┐\r│ Auth │ Social │ Recipe │ Admin │ Upload │\r│ Module │ Module │ AI │ Module │ Module │\r└─────────┴─────────┴─────────┴─────────┴─────────┘\r↓ ↓ ↓ ↓ ↓\rDynamoDB DynamoDB Bedrock DynamoDB S3 Bước 1: Review API Routes Cấu trúc API Router:\n// services/api-router/routes/index.ts export const routes = { // Auth routes \u0026#39;POST /auth/register\u0026#39;: \u0026#39;auth-module\u0026#39;, \u0026#39;POST /auth/login\u0026#39;: \u0026#39;auth-module\u0026#39;, \u0026#39;GET /auth/profile\u0026#39;: \u0026#39;auth-module\u0026#39;, \u0026#39;PUT /auth/profile\u0026#39;: \u0026#39;auth-module\u0026#39;, // Social routes \u0026#39;GET /social/posts\u0026#39;: \u0026#39;social-module\u0026#39;, \u0026#39;POST /social/posts\u0026#39;: \u0026#39;social-module\u0026#39;, \u0026#39;GET /social/posts/:id\u0026#39;: \u0026#39;social-module\u0026#39;, \u0026#39;POST /social/posts/:id/like\u0026#39;: \u0026#39;social-module\u0026#39;, // Recipe routes \u0026#39;GET /recipes\u0026#39;: \u0026#39;recipe-module\u0026#39;, \u0026#39;POST /recipes\u0026#39;: \u0026#39;recipe-module\u0026#39;, \u0026#39;POST /ai/generate-recipe\u0026#39;: \u0026#39;recipe-module\u0026#39;, \u0026#39;POST /ai/search\u0026#39;: \u0026#39;recipe-module\u0026#39;, // Admin routes \u0026#39;GET /admin/users\u0026#39;: \u0026#39;admin-module\u0026#39;, \u0026#39;POST /admin/users/:id/ban\u0026#39;: \u0026#39;admin-module\u0026#39;, // Upload routes \u0026#39;POST /upload/presigned-url\u0026#39;: \u0026#39;upload-module\u0026#39;, \u0026#39;POST /upload/complete\u0026#39;: \u0026#39;upload-module\u0026#39; }; Bước 2: Cấu hình Lambda Modules 1. Auth Module\ncd services/auth-module # Review cấu hình cat package.json cat tsconfig.json # Kiểm tra environment variables cần thiết cat index.ts | grep process.env Environment Variables:\nTABLE_NAME: Tên DynamoDB table USER_POOL_ID: Cognito User Pool ID REGION: AWS region 2. Social Module\ncd services/social-module # Review handlers ls handlers/ # - posts.handler.ts # - comments.handler.ts # - reactions.handler.ts # - friends.handler.ts 3. Recipe/AI Module\ncd services/recipe-module # Kiểm tra cấu hình AI cat services/ai.service.ts Environment Variables:\nBEDROCK_MODEL_ID: Claude 3.5 Sonnet v2 BEDROCK_REGION: us-east-1 OPENSEARCH_ENDPOINT: OpenSearch domain (nếu enabled) 4. Admin Module\ncd services/admin-module # Review admin operations ls handlers/ 5. Upload Module\ncd services/upload-module # Kiểm tra cấu hình S3 cat services/s3.service.ts Environment Variables:\nCONTENT_BUCKET: Tên S3 content bucket CLOUDFRONT_DOMAIN: CloudFront domain CLOUDFRONT_KEY_PAIR_ID: Cho signed URLs Bước 3: Cấu hình Lambda Layers Shared Dependencies:\ncd services/shared # Review shared code ls -la # - repositories/ # - business-logic/ # - utils/ # - types/ Cấu trúc Lambda Layer:\nshared/\r├── repositories/\r│ ├── user.repository.ts\r│ ├── post.repository.ts\r│ └── recipe.repository.ts\r├── business-logic/\r│ ├── auth.logic.ts\r│ └── validation.logic.ts\r└── utils/\r├── dynamodb.utils.ts\r└── response.utils.ts Bước 4: Thiết lập Lambda Environment Variables 1. Lấy Stack Outputs\n# Lấy DynamoDB table name TABLE_NAME=$(aws cloudformation describe-stacks \\ --stack-name EveryoneCook-dev-Core \\ --query \u0026#39;Stacks[0].Outputs[?OutputKey==`DynamoDBTableName`].OutputValue\u0026#39; \\ --output text) # Lấy User Pool ID USER_POOL_ID=$(aws cloudformation describe-stacks \\ --stack-name EveryoneCook-dev-Auth \\ --query \u0026#39;Stacks[0].Outputs[?OutputKey==`UserPoolId`].OutputValue\u0026#39; \\ --output text) # Lấy Content Bucket CONTENT_BUCKET=$(aws cloudformation describe-stacks \\ --stack-name EveryoneCook-dev-Core \\ --query \u0026#39;Stacks[0].Outputs[?OutputKey==`ContentBucketName`].OutputValue\u0026#39; \\ --output text) echo \u0026#34;TABLE_NAME=$TABLE_NAME\u0026#34; echo \u0026#34;USER_POOL_ID=$USER_POOL_ID\u0026#34; echo \u0026#34;CONTENT_BUCKET=$CONTENT_BUCKET\u0026#34; 2. Cập nhật Lambda Environment Variables\nLambda environment variables được thiết lập tự động bởi CDK stack, nhưng bạn có thể xác minh:\n# Kiểm tra Auth Module environment variables aws lambda get-function-configuration \\ --function-name EveryoneCook-dev-AuthModule \\ --query \u0026#39;Environment.Variables\u0026#39; # Phải hiển thị: # { # \u0026#34;TABLE_NAME\u0026#34;: \u0026#34;EveryoneCook-dev\u0026#34;, # \u0026#34;USER_POOL_ID\u0026#34;: \u0026#34;us-east-1_ABC123\u0026#34;, # \u0026#34;REGION\u0026#34;: \u0026#34;us-east-1\u0026#34; # } Bước 5: Cấu hình API Gateway 1. Review API Gateway Configuration\n# Lấy API Gateway ID API_ID=$(aws cloudformation describe-stacks \\ --stack-name EveryoneCook-dev-Backend \\ --query \u0026#39;Stacks[0].Outputs[?OutputKey==`ApiId`].OutputValue\u0026#39; \\ --output text) # Lấy API details aws apigateway get-rest-api --rest-api-id $API_ID 2. Kiểm tra Cognito Authorizer\n# Liệt kê authorizers aws apigateway get-authorizers --rest-api-id $API_ID # Phải hiển thị Cognito User Pool authorizer 3. Xác minh Custom Domain\n# Kiểm tra custom domain mapping aws apigateway get-domain-name --domain-name api.everyonecook.cloud # Phải hiển thị: # - Domain name: api.everyonecook.cloud # - Certificate ARN # - Regional domain name Bước 6: Cấu hình SQS Queues 1. Liệt kê Tất cả Queues\n# Liệt kê SQS queues aws sqs list-queues | grep EveryoneCook-dev # Phải hiển thị 12 queues (6 main + 6 DLQ) 2. Cấu hình Queue Permissions\nPermissions được thiết lập tự động bởi CDK, xác minh:\n# Lấy AI Queue URL AI_QUEUE_URL=$(aws sqs list-queues \\ --queue-name-prefix EveryoneCook-dev-AIQueue \\ | jq -r \u0026#39;.QueueUrls[0]\u0026#39;) # Kiểm tra queue attributes aws sqs get-queue-attributes \\ --queue-url $AI_QUEUE_URL \\ --attribute-names All Bước 7: Cấu hình Lambda Triggers Cognito Lambda Triggers:\n# Kiểm tra User Pool triggers aws cognito-idp describe-user-pool \\ --user-pool-id $USER_POOL_ID \\ --query \u0026#39;UserPool.LambdaConfig\u0026#39; # Phải hiển thị 5 triggers: # - PreSignUp # - PostConfirmation # - PreAuthentication # - PostAuthentication # - CustomMessage Bước 8: Test Lambda Functions Locally 1. Test Auth Module\ncd services/auth-module # Chạy tests npm test # Test specific handler npm run test:unit -- handlers/profile.test.ts 2. Test API Router\ncd services/api-router # Test routing logic npm test # Test với sample event node -e \u0026#34; const handler = require(\u0026#39;./dist/index\u0026#39;).handler; const event = { httpMethod: \u0026#39;GET\u0026#39;, path: \u0026#39;/health\u0026#39;, headers: {} }; handler(event).then(console.log); \u0026#34; Bước 9: Xác minh IAM Permissions 1. Kiểm tra Lambda Execution Roles\n# Liệt kê Lambda functions aws lambda list-functions \\ --query \u0026#39;Functions[?contains(FunctionName, `EveryoneCook-dev`)].FunctionName\u0026#39; # Kiểm tra role cho Auth Module aws lambda get-function \\ --function-name EveryoneCook-dev-AuthModule \\ --query \u0026#39;Configuration.Role\u0026#39; 2. Xác minh DynamoDB Permissions\n# Lấy role name ROLE_NAME=$(aws lambda get-function \\ --function-name EveryoneCook-dev-AuthModule \\ --query \u0026#39;Configuration.Role\u0026#39; \\ --output text | cut -d\u0026#39;/\u0026#39; -f2) # Liệt kê attached policies aws iam list-attached-role-policies --role-name $ROLE_NAME # Phải bao gồm DynamoDB access policy Checklist Cấu hình API routes đã review và hiểu rõ Cấu trúc Lambda modules đã review Environment variables đã xác minh Lambda layers đã cấu hình API Gateway custom domain hoạt động Cognito authorizer đã cấu hình SQS queues đã tạo và accessible Lambda triggers đã attach vào Cognito IAM permissions đã xác minh Local tests passing Bước tiếp theo Sau khi hoàn thành cấu hình, tiếp tục với Deploy Backend Services để deploy Lambda code của bạn.\n"
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/1-worklog/1.6-week6/",
	"title": "Báo cáo công việc Tuần 6",
	"tags": [],
	"description": "",
	"content": "Mục tiêu Tuần 6: Quản lý Danh tính \u0026amp; Truy cập (IAM): Triển khai kiểm soát danh tính mạnh mẽ bằng IAM Identity Center (SSO), giới hạn đặc quyền với Permission Boundaries, và bảo mật việc giả lập vai trò (role assumption) bằng các chính sách có điều kiện. Tuân thủ Bảo mật \u0026amp; Phòng thủ: Tự động hóa kiểm tra bảo mật với AWS Security Hub và bảo vệ ứng dụng web bằng AWS WAF. Bảo vệ Dữ liệu: Làm chủ mã hóa dữ liệu sử dụng AWS KMS (Key Management Service) và thiết lập chiến lược sao lưu toàn diện với AWS Backup. Mạng Nâng cao: Triển khai kiến trúc mạng mở rộng sử dụng VPC Peering cho kết nối trực tiếp và Transit Gateway cho mô hình hub-and-spoke. Các nhiệm vụ thực hiện trong tuần: Ngày Nhiệm vụ Ngày bắt đầu Ngày hoàn thành Tài liệu tham khảo 2 Quản lý Danh tính Nâng cao - Thiết lập IAM Identity Center (SSO) để truy cập tập trung giữa các tài khoản. - Tạo Permission Boundaries để giới hạn quyền tối đa cho IAM User/Role. - Cấu hình IAM Role Conditions để ngăn chặn lạm dụng chuyển giao vai trò. 13/10/2025 13/10/2025 https://000012.awsstudygroup.com/ https://000030.awsstudygroup.com/ https://000044.awsstudygroup.com/ 3 Tư thế Bảo mật \u0026amp; Phòng thủ Ứng dụng - Bật AWS Security Hub để kiểm tra tuân thủ (theo chuẩn CIS). - Triển khai AWS WAF (Tường lửa ứng dụng web): + Tạo Web ACLs với các Managed Rules. + Chặn tấn công SQL Injection/XSS trên ALB. 14/10/2025 14/10/2025 https://000018.awsstudygroup.com/ https://000026.awsstudygroup.com/ 4 Bảo vệ Dữ liệu (Mã hóa \u0026amp; Sao lưu) - Tạo Customer Managed Keys (CMK) trong AWS KMS. - Mã hóa S3 bucket và kiểm tra việc sử dụng qua CloudTrail \u0026amp; Athena. - Cấu hình AWS Backup: + Tạo Backup Vault và Backup Plan. + Thực hiện sao lưu và khôi phục tài nguyên theo yêu cầu. 15/10/2025 15/10/2025 https://000033.awsstudygroup.com/ https://000013.awsstudygroup.com/ 5 Độ tin cậy Mạng (Peering \u0026amp; Transit) - VPC Peering: Kết nối hai VPC cô lập và cấu hình Route Tables/DNS. - Transit Gateway (TGW): Xây dựng hub trung tâm để kết nối nhiều VPC. - Cấu hình TGW Route Tables để phân tách lưu lượng mạng. 16/10/2025 16/10/2025 https://000019.awsstudygroup.com/ https://000020.awsstudygroup.com/ 6 Rà soát \u0026amp; Dọn dẹp - Rà soát lại tất cả các cấu hình bảo mật. - Quan trọng: Xóa Transit Gateway, NAT Gateways, và tắt Security Hub/Config để tránh chi phí cao. - Xác nhận việc xóa các KMS keys (lên lịch xóa). 17/10/2025 17/10/2025 Tất cả các phần Dọn dẹp Thành tựu Tuần 6 Quản lý Danh tính \u0026amp; Truy cập (IAM) Đã triển khai thành công IAM Identity Center để quản lý người dùng tập trung và đơn giản hóa việc đăng nhập truy cập trên toàn tổ chức. Áp dụng Permission Boundaries để ngăn chặn leo thang đặc quyền, đảm bảo người dùng không thể tự cấp quyền vượt quá mức cho phép. Tăng cường bảo mật bằng cách thêm Conditions (Điều kiện) vào IAM Roles, giới hạn cách thức và nơi vai trò có thể được đảm nhận hoặc chuyển giao (ví dụ: giới hạn việc chuyển role cho các dịch vụ cụ thể). Tuân thủ Bảo mật \u0026amp; Phòng thủ Ứng dụng Kích hoạt AWS Security Hub để có cái nhìn toàn diện về trạng thái bảo mật và tự động kiểm tra theo tiêu chuẩn CIS AWS Foundations Benchmark. Bảo vệ các ứng dụng web bằng cách triển khai AWS WAF, tạo thành công các quy tắc chặn các mối đe dọa phổ biến như SQL Injection và các địa chỉ IP độc hại trước khi chúng tiếp cận Application Load Balancer. Chiến lược Mã hóa \u0026amp; Sao lưu Dữ liệu Quản lý bảo mật dữ liệu sử dụng AWS KMS, tạo Customer Managed Keys để mã hóa dữ liệu nhạy cảm trong S3. Kiểm toán việc sử dụng khóa và truy cập dữ liệu bằng cách tích hợp nhật ký KMS với CloudTrail và truy vấn thông qua Amazon Athena. Thiết lập kế hoạch Khôi phục Thảm họa (DR) mạnh mẽ bằng AWS Backup, tự động hóa lịch trình sao lưu cho các EBS volume và kiểm thử thành công việc khôi phục dữ liệu từ điểm sao lưu. Kết nối \u0026amp; Mạng Nâng cao Kết nối các môi trường mạng cô lập sử dụng VPC Peering, cho phép giao tiếp riêng tư giữa các VPC mà không cần đi qua internet công cộng. Giải quyết sự phức tạp của mạng lưới dạng lưới (mesh) bằng cách triển khai AWS Transit Gateway, tạo kiến trúc mạng mô hình hub-and-spoke có khả năng mở rộng để kết nối nhiều VPC một cách hiệu quả. Cấu hình các Route Table phức tạp cho cả Peering và Transit Gateway để đảm bảo luồng lưu lượng chính xác và sự cô lập mạng. "
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/3-blogstranslated/3.6-blog6/",
	"title": "Blog 6: 10 Công bố Hàng đầu về AWS Cloud Operations tại re:Invent 2025",
	"tags": [],
	"description": "",
	"content": "Tổng quan: Định hình lại Vận hành Cloud với AI Tại re:Invent 2025, AWS đã công bố hàng loạt cải tiến quan trọng cho Cloud Operations. Trọng tâm của năm nay xoay quanh việc ứng dụng Generative AI để quan sát và xử lý sự cố, đồng thời đơn giản hóa việc quản lý dữ liệu vận hành quy mô lớn thông qua các tính năng tập trung hóa (centralization).\nDưới đây là ghi chú chi tiết về 10 công bố hàng đầu giúp tối ưu hóa quy trình vận hành trên AWS.\n1. Quan sát Generative AI trên CloudWatch và AgentCore AWS ra mắt khả năng quan sát toàn diện cho các ứng dụng Generative AI. Tính năng này cung cấp thông tin chi tiết về độ trễ (latency), lượng token sử dụng và các lỗi phát sinh trong AI stack. Đặc biệt, nó tích hợp mượt mà với Amazon Bedrock AgentCore và các framework mã nguồn mở như LangChain hay CrewAI mà không cần viết code instrumentation thủ công.\n[Figure 1] Amazon CloudWatch Generative AI dashboard\nGiao diện quản lý Agent cũng giúp theo dõi luồng hoạt động của agent từ đầu đến cuối (end-to-end):\n[Figure 2] Agent Management View\n2. CloudWatch Application Map tự động phát hiện dịch vụ Trước đây để vẽ bản đồ ứng dụng (Application Map), chúng ta thường phải cài đặt instrumentation phức tạp. Giờ đây, CloudWatch Application Signals có khả năng tự động phát hiện và trực quan hóa cấu trúc ứng dụng (topology), hiển thị các mối quan hệ phụ thuộc giữa các dịch vụ ngay lập tức. Tính năng này giúp nhóm vận hành có cái nhìn tổng quan về hệ thống nhanh chóng hơn.\n[Figure 3] CloudWatch Application Map\n3. Phân tích nguyên nhân gốc rễ (5 \u0026ldquo;Whys\u0026rdquo;) và tạo báo cáo sự cố Đây là bước tiến lớn trong AIOps. CloudWatch Investigations tận dụng Generative AI để tự động hóa quy trình phân tích nguyên nhân gốc rễ. Thay vì phải tự tổng hợp dữ liệu, hệ thống sẽ tạo ra một báo cáo sự cố tương tác.\n[Figure 4] Amazon CloudWatch Investigations Incident Report\nĐáng chú ý nhất là quy trình phân tích \u0026ldquo;5 Whys\u0026rdquo; (5 câu hỏi Tại sao) được tích hợp sẵn, mô phỏng phương pháp xử lý lỗi nội bộ của Amazon (Correction of Errors - COE), giúp tìm ra nguyên nhân sâu xa của vấn đề một cách hệ thống.\n[Figure 5] 5 Whys Analysis in the CloudWatch investigations Incident Report\n4. Hỗ trợ Model Context Protocol (MCP) Servers CloudWatch và Application Signals hiện đã hỗ trợ Model Context Protocol (MCP) servers. Điều này đóng vai trò cầu nối, cho phép các trợ lý AI (AI assistants) tương tác tự nhiên với dữ liệu quan sát (metrics, logs, traces). Nhờ đó, chúng ta có thể xây dựng các quy trình vận hành tự trị và tích hợp dữ liệu CloudWatch vào các công cụ phát triển hỗ trợ bởi AI.\n5. Tích hợp GitHub Action và cải tiến MCP cho Application Signals Để hỗ trợ tốt hơn cho developer, CloudWatch Application Signals đã được tích hợp trực tiếp vào GitHub Actions. Tính năng này cung cấp thông tin quan sát ngay trong các Pull Request và CI/CD pipelines.\nNó giúp phát hiện các vấn đề về hiệu năng hoặc lỗi hệ thống mà không cần rời khỏi môi trường phát triển GitHub:\n[Figure 6] Automated Root Cause Analysis in the GitHub issues\nThậm chí, hệ thống còn có khả năng đề xuất các bản vá lỗi tự động thông qua Pull Request:\n[Figure 7] Automated GitHub Pull Request to Fix the Issue\n6. Nâng cấp trải nghiệm Log Analytics trên OpenSearch Service Amazon OpenSearch Service giới thiệu các cải tiến đáng kể cho ngôn ngữ Piped Processing Language (PPL). Việc phân tích log trở nên nhanh hơn và trực quan hơn. Khả năng truy vấn nâng cao giúp xử lý các truy vấn phân tích phức tạp hiệu quả, đồng thời tích hợp liền mạch với CloudWatch Logs để phân tích log thống nhất.\n7. Real User Monitoring (RUM) hỗ trợ Mobile (iOS/Android) Amazon CloudWatch RUM mở rộng khả năng giám sát trải nghiệm người dùng thực sang nền tảng di động. Giờ đây, chúng ta có thể theo dõi hiệu năng, hành trình người dùng và lỗi phía client (client-side errors) trên các ứng dụng iOS và Android, giúp đảm bảo trải nghiệm đồng nhất trên mọi thiết bị và vị trí địa lý.\n8. CloudTrail: Tổng hợp sự kiện dữ liệu (Data Event Aggregation) Để giải quyết vấn đề khối lượng log khổng lồ từ các API activity, AWS CloudTrail thêm tính năng Event Aggregation. Thay vì ghi lại từng dòng log riêng lẻ, hệ thống sẽ tóm tắt các hoạt động tần suất cao thành các bản tổng hợp mỗi 5 phút.\nViệc này giúp:\nGiảm chi phí lưu trữ log. Dễ dàng phát hiện các mẫu bất thường (như truy cập S3 lạ hoặc DynamoDB throttling) mà không cần phân tích thủ công quá nhiều dữ liệu thô. 9. Tập trung Log Đa tài khoản \u0026amp; Đa vùng (Log Centralization) Đây là tính năng được mong chờ cho các tổ chức lớn. CloudWatch Logs Centralization cho phép gom log từ nhiều tài khoản (Accounts) và nhiều vùng (Regions) khác nhau về một tài khoản đích duy nhất.\nTích hợp với AWS Organizations. Tự động thêm context @aws.account và @aws.region vào log để dễ truy xuất nguồn gốc. Tiết kiệm chi phí (không tốn phí ingestion cho bản copy đầu tiên). 10. Giám sát Database tập trung Đa tài khoản \u0026amp; Đa vùng Tương tự như log, CloudWatch Database Insights cũng hỗ trợ giám sát tập trung. Chúng ta có thể theo dõi hiệu năng của Amazon RDS, Amazon Aurora, và Amazon DynamoDB trên toàn bộ tổ chức AWS từ một tài khoản giám sát duy nhất. Điều này giúp liên kết hiệu năng database với sức khỏe ứng dụng dễ dàng hơn.\nKết luận Các công bố năm 2025 cho thấy AWS đang tập trung giải quyết bài toán \u0026ldquo;quá tải dữ liệu vận hành\u0026rdquo; bằng cách sử dụng AI để lọc nhiễu và tự động hóa phân tích. Từ việc giám sát GenAI, đến việc dùng GenAI để sửa lỗi, và khả năng quản lý tập trung (Centralization), các công cụ này giúp người vận hành chuyển từ trạng thái bị động sang chủ động kiểm soát hệ thống.\nTác giả Nereida Woo\rNereida is a WW Specialist Solutions Architect in Cloud Operations focusing on Centralized Operations Management and Application operations on AWS. When she isn't working, she enjoys traveling to attend music concerts.\nCalvin Weng\rCalvin Weng is a Product Marketing Manager for AWS Cloud Operations, focusing on observability and monitoring services. Outside of work, Calvin travels, practices pottery, plays ping pong competitively, and explores the Pacific Northwest with his dog Kai.\nRaviteja Sunkavalli\rRaviteja Sunkavalli is a Senior Worldwide Specialist Solutions Architect at Amazon Web Services, specializing in AIOps and GenAI observability. He helps global customers implement observability and incident management solutions across complex and distributed cloud environments. Outside of work, he enjoys playing cricket and exploring new cooking recipes.\n"
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/6-self-evaluation/",
	"title": "Tự Đánh Giá",
	"tags": [],
	"description": "",
	"content": "Trong thời gian thực tập tại Amazon Web Services Vietnam Co., Ltd. từ 08/09/2025 đến 09/12/2025, tôi đã có cơ hội làm việc trong một môi trường chuyên nghiệp, đề cao tính kỷ luật, trách nhiệm và sự phát triển bản thân. Quãng thời gian này giúp tôi hiểu rõ hơn các tiêu chuẩn làm việc, rèn luyện tư duy nghề nghiệp, đồng thời hình thành một phong cách làm việc có tổ chức và khoa học hơn khi thực hiện nhiệm vụ được giao.\nTrong kỳ thực tập, tôi tham gia vào dự án Everyonecook, đảm nhận các công việc liên quan đến quy trình phát triển và vận hành của nhóm. Nhờ đó, tôi có thêm kinh nghiệm thực tế về cách phối hợp trong nhóm, cũng như cách áp dụng các quy trình phát triển trên nền tảng điện toán đám mây vào dự án thực tế.\nXuyên suốt thời gian thực tập, tôi luôn giữ thái độ nghiêm túc, tuân thủ quy trình làm việc và phối hợp tốt với đồng nghiệp để hoàn thành mục tiêu chung. Tôi luôn ưu tiên chất lượng sản phẩm đầu ra và đảm bảo hoàn thành đúng thời hạn.\nDưới đây là bảng tự đánh giá của tôi dựa trên các tiêu chí chính:\nSTT Tiêu chí Mô tả Tốt Khá TB 1 Kiến thức \u0026amp; kỹ năng chuyên môn Khả năng áp dụng kiến thức, sử dụng công cụ, tạo ra kết quả chất lượng ☐ ✅ ☐ 2 Khả năng học hỏi Tiếp thu kiến thức mới và thích ứng với nhiệm vụ ☐ ✅ ☐ 3 Tính chủ động Tinh thần tự giác và tham gia hỗ trợ quy trình làm việc ☐ ✅ ☐ 4 Trách nhiệm Hoàn thành nhiệm vụ đúng hạn và đảm bảo chất lượng ☐ ✅ ☐ 5 Kỷ luật Tuân thủ quy trình, thời gian biểu và nội quy công ty ☐ ✅ ☐ 6 Cải thiện liên tục Sẵn sàng tiếp nhận phản hồi và chủ động hoàn thiện bản thân ☐ ✅ ☐ 7 Giao tiếp Trình bày ý tưởng rõ ràng trong thảo luận và báo cáo ☐ ✅ ☐ 8 Làm việc nhóm Hợp tác hiệu quả và hỗ trợ đồng đội ☐ ✅ ☐ 9 Tác phong chuyên nghiệp Thái độ nghiêm túc, tôn trọng và hành xử phù hợp nơi làm việc ☐ ✅ ☐ 10 Giải quyết vấn đề Nhận diện vấn đề và đưa ra giải pháp thực tế ☐ ✅ ☐ 11 Mức độ đóng góp Hiệu quả và giá trị mang lại cho dự án/nhóm ☐ ✅ ☐ 12 Tổng quan Đánh giá chung toàn bộ quá trình thực tập ☐ ✅ ☐ Các điểm cần cải thiện Cải thiện tính nhất quán và kỷ luật trong thói quen làm việc hằng ngày Tăng cường tư duy logic và cách tiếp cận có hệ thống khi giải quyết vấn đề Nâng cao kỹ năng giao tiếp, đặc biệt là diễn đạt ý tưởng và xử lý tình huống chuyên nghiệp "
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/5-workshop/5.04-configure-stacks/5.4.6-frontend-stack/",
	"title": "5.4.6 Frontend Stack",
	"tags": [],
	"description": "",
	"content": " Frontend Stack - AWS Amplify Hosting Tổng quan Frontend Stack xử lý triển khai ứng dụng Next.js 15 sử dụng AWS Amplify. Khác với các stack khác được quản lý bởi CDK, Frontend được triển khai thông qua Amplify Console với tích hợp GitLab để tự động triển khai.\nPhương thức triển khai: AWS Amplify Console (không phải CDK stack)\n⚠️ Lưu ý quan trọng: Triển khai Frontend được thực hiện riêng biệt thông qua Amplify Console. Xem chi tiết tại 5.10 Deploy to Amplify.\nTrách nhiệm chính Host ứng dụng Next.js 15 SSR Tự động triển khai từ GitLab repository Cấu hình custom domain với Route 53 Tự động cấp chứng chỉ SSL qua ACM Phân phối CDN toàn cầu Quản lý biến môi trường Stack này bao gồm Ứng dụng Next.js:\nFramework: Next.js 15 với React 18 Rendering: Chế độ standalone output (SSR) Styling: Tailwind CSS + Flowbite components State Management: React Context API Authentication: AWS Amplify Auth (tích hợp Cognito) Tính năng AWS Amplify:\nTự động build và deploy từ Git Hỗ trợ server-side rendering (SSR) Custom domain với HTTPS CDN caching và compression Injection biến môi trường Tích hợp GitLab CI/CD Kiến trúc ┌─────────────────────────────────────────────────────────────────┐\r│ GitLab Repository │\r│ (everyonecook/frontend) │\r│ │\r│ Push to main/dev branch │\r└──────────────────────────┬──────────────────────────────────────┘\r│ Webhook Trigger\r▼\r┌─────────────────────────────────────────────────────────────────┐\r│ AWS Amplify (Hosting + CI/CD) │\r│ │\r│ ┌──────────────────────────────────────────────────────────┐ │\r│ │ Build Pipeline (Tự động kích hoạt) │ │\r│ │ 1. Clone repository từ GitLab │ │\r│ │ 2. npm install (với legacy peer deps) │ │\r│ │ 3. Inject biến môi trường → .env.production │ │\r│ │ 4. npm run build (Next.js standalone build) │ │\r│ │ 5. Deploy to Amplify CDN │ │\r│ └──────────────────────────────────────────────────────────┘ │\r│ │\r│ ┌──────────────────────────────────────────────────────────┐ │\r│ │ Cấu hình Hosting │ │\r│ │ • CDN Distribution (CloudFront) │ │\r│ │ • SSR Lambda@Edge functions │ │\r│ │ • Custom domain: dev.everyonecook.cloud │ │\r│ │ • SSL Certificate (ACM - tự động cấp) │ │\r│ │ • Custom headers (bảo mật) │ │\r│ │ • Custom rewrites (Next.js routing) │ │\r│ └──────────────────────────────────────────────────────────┘ │\r└──────────────────────────┬──────────────────────────────────────┘\r│\r▼\r┌─────────────────────────────────────────────────────────────────┐\r│ Route 53 (DNS) │\r│ dev.everyonecook.cloud → A Record → Amplify CDN │\r│ www.dev.everyonecook.cloud → CNAME → Amplify CDN │\r└─────────────────────────────────────────────────────────────────┘\r│\r▼\r┌─────────────────────────────────────────────────────────────────┐\r│ End Users (Global) │\r│ Truy cập qua: https://dev.everyonecook.cloud │\r└─────────────────────────────────────────────────────────────────┘ Cấu hình Frontend Cấu trúc thư mục frontend/\r├── amplify.yml # Cấu hình build Amplify\r├── next.config.js # Cấu hình Next.js\r├── package.json # Dependencies \u0026amp; scripts\r├── .env.example # Template biến môi trường\r├── app/ # Next.js App Router\r│ ├── layout.tsx # Root layout\r│ ├── page.tsx # Home page\r│ ├── auth/ # Trang xác thực\r│ ├── profile/ # Hồ sơ người dùng\r│ ├── recipes/ # Trang công thức\r│ └── ...\r├── components/ # React components tái sử dụng\r├── contexts/ # React Context providers\r├── hooks/ # Custom React hooks\r├── lib/ # Utility functions\r├── services/ # API service layer\r└── types/ # TypeScript definitions 1. Cấu hình Amplify Build File: amplify.yml (thư mục gốc)\n⚠️ Quan trọng: Amplify sử dụng file amplify.yml ở thư mục gốc repository, không phải trong thư mục frontend/.\nversion: 1 applications: - frontend: phases: preBuild: commands: - export HUSKY=0 - npm install --legacy-peer-deps --ignore-scripts build: commands: - echo \u0026#34;=== Creating .env.production from Amplify env vars ===\u0026#34; - rm -f .env.production - env | grep -e NEXT_PUBLIC_ \u0026gt; .env.production || true - echo \u0026#34;=== .env.production content ===\u0026#34; - cat .env.production - echo \u0026#34;=== Building frontend ===\u0026#34; - npm run build artifacts: baseDirectory: .next files: - \u0026#39;**/*\u0026#39; cache: paths: - node_modules/**/* - .next/cache/**/* appRoot: frontend Cấu hình bổ sung trong frontend/amplify.yml:\nFile frontend/amplify.yml chứa các security headers và custom rewrites bổ sung (có thể merge vào amplify.yml gốc nếu cần):\ncustomHeaders: - pattern: \u0026#39;**/*\u0026#39; headers: - key: \u0026#39;Strict-Transport-Security\u0026#39; value: \u0026#39;max-age=31536000; includeSubDomains\u0026#39; - key: \u0026#39;X-Content-Type-Options\u0026#39; value: \u0026#39;nosniff\u0026#39; - key: \u0026#39;X-Frame-Options\u0026#39; value: \u0026#39;DENY\u0026#39; - key: \u0026#39;X-XSS-Protection\u0026#39; value: \u0026#39;1; mode=block\u0026#39; customRules: # Xử lý dynamic routes [id] - rewrite các request không phải file về Next.js - source: \u0026#39;\u0026lt;/^[^.]+$|\\.(?!(css|gif|ico|jpg|jpeg|js|json|png|txt|svg|woff|woff2|ttf|map|webp|avif)$)([^.]+$)/\u0026gt;\u0026#39; target: /index.html status: \u0026#39;200\u0026#39; # Bảo toàn static assets - source: \u0026#39;/_next/\u0026lt;*\u0026gt;\u0026#39; target: \u0026#39;/_next/\u0026lt;*\u0026gt;\u0026#39; status: \u0026#39;200\u0026#39; - source: \u0026#39;/api/\u0026lt;*\u0026gt;\u0026#39; target: \u0026#39;/api/\u0026lt;*\u0026gt;\u0026#39; status: \u0026#39;200\u0026#39; Điểm chính:\nappRoot: frontend: Source code trong thư mục frontend/ Build artifacts: Thư mục .next (Next.js standalone build) Root amplify.yml: Chỉ cấu hình build Frontend amplify.yml: Bao gồm security headers + custom rewrites Khuyến nghị: Merge customHeaders và customRules vào root amplify.yml để cấu hình tập trung 2. Cấu hình Next.js File: frontend/next.config.js\n/** @type {import(\u0026#39;next\u0026#39;).NextConfig} */ const nextConfig = { reactStrictMode: true, // Output mode cho Amplify SSR deployment output: \u0026#39;standalone\u0026#39;, // Tối ưu hiệu năng poweredByHeader: false, compress: true, trailingSlash: false, // Tối ưu hình ảnh images: { remotePatterns: [ { protocol: \u0026#39;https\u0026#39;, hostname: \u0026#39;cdn-dev.everyonecook.cloud\u0026#39;, pathname: \u0026#39;/**\u0026#39;, }, ], formats: [\u0026#39;image/avif\u0026#39;, \u0026#39;image/webp\u0026#39;], deviceSizes: [640, 750, 828, 1080, 1200, 1920, 2048, 3840], }, // Tối ưu bundle experimental: { optimizePackageImports: [\u0026#39;react-icons\u0026#39;, \u0026#39;flowbite-react\u0026#39;, \u0026#39;aws-amplify\u0026#39;], optimizeCss: true, }, // Biến môi trường (giá trị dự phòng) env: { NEXT_PUBLIC_API_URL: process.env.NEXT_PUBLIC_API_URL || \u0026#39;https://api-dev.everyonecook.cloud\u0026#39;, NEXT_PUBLIC_CDN_URL: process.env.NEXT_PUBLIC_CDN_URL || \u0026#39;https://cdn-dev.everyonecook.cloud\u0026#39;, NEXT_PUBLIC_COGNITO_USER_POOL_ID: process.env.NEXT_PUBLIC_COGNITO_USER_POOL_ID, NEXT_PUBLIC_COGNITO_CLIENT_ID: process.env.NEXT_PUBLIC_COGNITO_CLIENT_ID, NEXT_PUBLIC_COGNITO_REGION: process.env.NEXT_PUBLIC_COGNITO_REGION || \u0026#39;ap-southeast-1\u0026#39;, }, }; module.exports = nextConfig; Điểm chính:\noutput: 'standalone': Build tối ưu cho Amplify Tối ưu hình ảnh: Hỗ trợ định dạng AVIF, WebP Tích hợp CDN: Load hình ảnh từ CloudFront CDN Biến môi trường: Được inject từ Amplify Console 3. Dependencies File: frontend/package.json\n{ \u0026#34;name\u0026#34;: \u0026#34;everyonecook-frontend\u0026#34;, \u0026#34;version\u0026#34;: \u0026#34;1.0.0\u0026#34;, \u0026#34;scripts\u0026#34;: { \u0026#34;dev\u0026#34;: \u0026#34;next dev --turbo\u0026#34;, \u0026#34;build\u0026#34;: \u0026#34;next build\u0026#34;, \u0026#34;start\u0026#34;: \u0026#34;next start\u0026#34; }, \u0026#34;dependencies\u0026#34;: { \u0026#34;next\u0026#34;: \u0026#34;^15.0.0\u0026#34;, \u0026#34;react\u0026#34;: \u0026#34;^18.3.0\u0026#34;, \u0026#34;react-dom\u0026#34;: \u0026#34;^18.3.0\u0026#34;, \u0026#34;aws-amplify\u0026#34;: \u0026#34;^6.15.8\u0026#34;, \u0026#34;@aws-amplify/auth\u0026#34;: \u0026#34;^6.17.0\u0026#34;, \u0026#34;axios\u0026#34;: \u0026#34;^1.13.2\u0026#34;, \u0026#34;flowbite-react\u0026#34;: \u0026#34;^0.7.0\u0026#34;, \u0026#34;react-icons\u0026#34;: \u0026#34;^5.0.1\u0026#34; }, \u0026#34;devDependencies\u0026#34;: { \u0026#34;typescript\u0026#34;: \u0026#34;^5.3.0\u0026#34;, \u0026#34;tailwindcss\u0026#34;: \u0026#34;^3.4.18\u0026#34;, \u0026#34;autoprefixer\u0026#34;: \u0026#34;^10.4.22\u0026#34; } } Dependencies chính:\nNext.js 15: Framework SSR mới nhất AWS Amplify: Authentication \u0026amp; API integration Flowbite React: Thư viện UI component Tailwind CSS: Framework CSS utility-first 4. Biến môi trường File: frontend/.env.example\n# Cấu hình API NEXT_PUBLIC_API_URL=https://api-dev.everyonecook.cloud # Cấu hình CDN NEXT_PUBLIC_CDN_URL=https://cdn-dev.everyonecook.cloud # Cấu hình AWS Cognito NEXT_PUBLIC_COGNITO_USER_POOL_ID=ap-southeast-1_XXXXXXXXX NEXT_PUBLIC_COGNITO_CLIENT_ID=xxxxxxxxxxxxxxxxxxxxx NEXT_PUBLIC_COGNITO_REGION=ap-southeast-1 # Môi trường NEXT_PUBLIC_ENV=development Quan trọng: Các biến này phải được cấu hình trong Amplify Console \u0026gt; Environment Variables.\nCấu hình Triển khai Cấu hình Domain Môi trường Frontend Domain Backend API CDN Dev dev.everyonecook.cloud api-dev.everyonecook.cloud cdn-dev.everyonecook.cloud Staging staging.everyonecook.cloud api-staging.everyonecook.cloud cdn-staging.everyonecook.cloud Prod everyonecook.cloud api.everyonecook.cloud cdn.everyonecook.cloud Cấu hình Amplify Cài đặt Build:\nPhiên bản Node.js: 18.x (tự động phát hiện) Build timeout: 15 phút Build image: Amazon Linux 2023 Cache: node_modules + .next/cache Cài đặt Deployment:\nAuto-deploy: Enabled (khi push Git) Branch: main (prod), dev (development) Build mode: Server-side rendering (SSR) Tích hợp với các Stack khác Dependencies Frontend yêu cầu outputs từ:\nDNS Stack (Phase 1):\nRoute 53 Hosted Zone ID Cấu hình tên miền Certificate Stack (Phase 1.5):\nACM Certificate cho custom domain (CloudFront - us-east-1) Amplify sẽ tự động provision certificate Auth Stack (Phase 3):\nCOGNITO_USER_POOL_ID: User Pool ID COGNITO_CLIENT_ID: App Client ID COGNITO_REGION: AWS Region Backend Stack (Phase 4):\nAPI_URL: API Gateway custom domain Cấu hình API endpoints Core Stack (Phase 2):\nCDN_URL: CloudFront distribution domain S3 bucket cho upload hình ảnh Cross-Stack References Frontend sử dụng biến môi trường để kết nối với backend:\n// services/api.ts const API_BASE_URL = process.env.NEXT_PUBLIC_API_URL; // Từ Backend Stack const CDN_URL = process.env.NEXT_PUBLIC_CDN_URL; // Từ Core Stack // lib/auth.ts const cognitoConfig = { userPoolId: process.env.NEXT_PUBLIC_COGNITO_USER_POOL_ID, // Từ Auth Stack userPoolClientId: process.env.NEXT_PUBLIC_COGNITO_CLIENT_ID, // Từ Auth Stack region: process.env.NEXT_PUBLIC_COGNITO_REGION, }; Quy trình Triển khai Điều kiện tiên quyết Trước khi triển khai frontend, đảm bảo các điều sau đã hoàn thành:\n✅ DNS Stack đã deploy (Route 53 Hosted Zone) ✅ Core Stack đã deploy (S3 + CloudFront CDN) ✅ Auth Stack đã deploy (Cognito User Pool) ✅ Backend Stack đã deploy (API Gateway + Lambda) ✅ GitLab repository đã cấu hình ✅ AWS Amplify đã kết nối với GitLab Các bước triển khai Frontend được triển khai thông qua Amplify Console, KHÔNG qua CDK.\nĐể biết chi tiết triển khai, xem: 5.10 Deploy to Amplify\nTóm tắt các bước:\nTạo Amplify App qua AWS Console Kết nối GitLab repository (everyonecook) Cấu hình build settings (amplify.yml) Thiết lập biến môi trường (Cognito, API, CDN URLs) Cấu hình custom domain (dev.everyonecook.cloud) Deploy tự động khi push Git ⚠️ Lưu ý: Sau khi triển khai thành công, bạn cần:\n✅ Xác minh DNS records trong Route 53 ✅ Kiểm tra chứng chỉ SSL ✅ Xác minh custom domain hoạt động ✅ Kiểm tra authentication flow với Cognito Xác minh 1. Kiểm tra Amplify Console 📸 Screenshot yêu cầu: AWS Console \u0026gt; Amplify \u0026gt; App Overview\nXác minh:\nBuild status: Success Deployment status: Live Custom domain: Active SSL certificate: Issued Screenshot: Amplify Console hiển thị triển khai thành công\n2. Kiểm tra Route 53 DNS 📸 Screenshot yêu cầu: AWS Console \u0026gt; Route 53 \u0026gt; Hosted Zone\nXác minh DNS records:\ndev.everyonecook.cloud A → Amplify CDN\rwww.dev.everyonecook.cloud CNAME → Amplify CDN Screenshot: Route 53 hiển thị Amplify DNS records\n3. Kiểm tra ứng dụng Frontend URL truy cập:\n# Qua custom domain https://dev.everyonecook.cloud # Qua Amplify default domain https://main.d1234567890.amplifyapp.com Kiểm tra tính năng:\nHomepage load thành công HTTPS certificate hợp lệ Đăng ký người dùng hoạt động Login với Cognito API calls tới backend Hình ảnh load từ CDN 📸 Screenshot yêu cầu: Browser hiển thị frontend homepage với DevTools Network tab\nScreenshot: Frontend homepage load thành công\n4. Xác minh biến môi trường 📸 Screenshot yêu cầu: Amplify Console \u0026gt; Environment Variables\nXác minh tất cả biến yêu cầu:\nNEXT_PUBLIC_API_URL=https://api-dev.everyonecook.cloud\rNEXT_PUBLIC_CDN_URL=https://cdn-dev.everyonecook.cloud\rNEXT_PUBLIC_COGNITO_USER_POOL_ID=ap-southeast-1_XXXXXXXXX\rNEXT_PUBLIC_COGNITO_CLIENT_ID=xxxxxxxxxxxxxxxxxxxxx\rNEXT_PUBLIC_COGNITO_REGION=ap-southeast-1 Screenshot: Amplify environment variables đã cấu hình\nBest Practices 1. Quản lý môi trường ✅ Sử dụng Amplify apps riêng cho dev/staging/prod ✅ Cấu hình biến môi trường trong Amplify Console ⚠️ KHÔNG commit .env.production vào Git ✅ Sử dụng .env.example để document các biến yêu cầu 2. Tối ưu Build ✅ Enable caching: node_modules + .next/cache ✅ Sử dụng output: 'standalone' cho bundle nhỏ hơn ✅ Tối ưu hình ảnh: Định dạng AVIF, WebP ✅ Enable gzip compression 3. Bảo mật ✅ Thiết lập security headers (HSTS, CSP, X-Frame-Options) ✅ Chỉ sử dụng HTTPS (enforce qua Amplify) ✅ Validate biến môi trường tại build time ⚠️ Không expose dữ liệu nhạy cảm trong client code 4. Monitoring ✅ Monitor build logs trong Amplify Console ✅ Thiết lập build notifications (email, Slack) ✅ Kiểm tra CloudWatch metrics cho CDN ✅ Monitor error rates và performance Tóm tắt Các điểm nổi bật cấu hình Frontend Stack:\n✅ Next.js 15 SSR application\n✅ AWS Amplify hosting với automatic deployment\n✅ GitLab CI/CD integration\n✅ Custom domain với Route 53 + ACM\n✅ Environment variables management\n✅ Security headers và optimization\n🔗 Bước tiếp theo: Deploy to Amplify (5.10) - Quy trình triển khai chi tiết\nTài liệu tham khảo AWS Amplify Documentation: https://docs.aws.amazon.com/amplify/ Next.js Deployment: https://nextjs.org/docs/deployment Frontend Source: everyonecook/frontend/ Build Config: everyonecook/frontend/amplify.yml "
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/5-workshop/5.07-deploy-backend/",
	"title": "Triển khai Backend Services",
	"tags": [],
	"description": "",
	"content": "Tổng quan Sau khi deploy infrastructure với CDK, bạn cần deploy Lambda code lên AWS. Dự án EveryoneCook cung cấp automated deployment script để build, package và deploy tất cả Lambda functions.\nKiến trúc Backend Lambda Modules (7 functions):\napi-router - API Gateway routing với JWT validation auth-user - Authentication \u0026amp; User Management social - Posts, Comments, Reactions, Friends, Notifications recipe-ai - Recipes \u0026amp; AI Features (Bedrock) ai-worker - Async AI processing worker admin - Admin Dashboard \u0026amp; Content Moderation upload - File Upload với S3 Presigned URLs Lambda Layer:\nshared-dependencies - Shared npm packages (aws-sdk, uuid, etc.) Cognito Triggers (Auth Stack):\nPre-Signup, Post-Confirmation, Post-Authentication, Pre-Authentication, Custom Message Quy trình Triển khai 1. Build Lambda Layer (shared dependencies)\r2. Build TypeScript modules → JavaScript\r3. Validate dist folders (kiểm tra lỗi)\r4. Chuẩn bị deployment packages\r5. Deploy qua CDK hoặc Direct Lambda Update\r6. Xác minh deployments\r7. Kiểm tra CloudWatch logs Tùy chọn A: Triển khai Đầy đủ (Khuyến nghị - Lần đầu tiên) Full deployment sử dụng CDK để deploy toàn bộ infrastructure và Lambda code.\nBước 1: Di chuyển đến Dự án # Di chuyển đến thư mục gốc everyonecook cd D:\\Project_AWS\\everyonecook Bước 2: Chạy Script Triển khai Đầy đủ # Full deployment cho dev environment .\\deploy\\deploy-backend.ps1 -Environment dev # Hoặc ngắn gọn (mặc định là dev) .\\deploy\\deploy-backend.ps1 Script sẽ thực hiện:\nBƯỚC 0: Xây dựng Lambda Layer\nDọn dẹp các builds trước đó Cài đặt production dependencies vào layers/shared-dependencies/nodejs/ Kích thước Layer: ~15-20 MB BƯỚC 1: Xây dựng Lambda modules\nBuild auth triggers (Pre-Signup, Post-Confirmation, etc.) Build tất cả 7 Lambda modules Dọn dẹp dist và tsconfig.tsbuildinfo để buộc compile mới Biên dịch TypeScript → JavaScript BƯỚC 2: Xác thực dist folders\nKiểm tra dist folder tồn tại Phát hiện node_modules trong dist (vấn đề phổ biến) Kiểm tra kích thước dist (nên \u0026lt; 10 MB) Xác minh index.js tồn tại Tự động sửa chữa nếu phát hiện vấn đề BƯỚC 3: Chuẩn bị deployment packages\nDọn dẹp các artifacts trước đó Sao chép nội dung dist → thư mục deployment Thêm build-info.json (timestamp, git commit) BƯỚC 4: Triển khai với CDK\nTổng hợp CloudFormation templates Deploy stack EveryoneCook-dev-Backend Cập nhật Lambda functions Cập nhật Lambda Layer Cập nhật API Gateway Kết quả mẫu:\n========================================\rBackend Deployment - dev\rWith Lambda Layers\r========================================\rSTEP 0: Building Lambda Layer...\rInstalling layer dependencies...\rLayer built: 18.45 MB\rSTEP 1: Building Lambda modules...\rBuilding auth triggers... OK\rBuilding api-router... OK\rBuilding auth-module... OK\rBuilding social-module... OK\rBuilding ai-module... OK\rBuilding admin-module... OK\rBuilding upload-module... OK\rSTEP 2: Validating dist folders...\rapi-router... OK (125 files, 1.2 MB)\rauth-module... OK (156 files, 1.5 MB)\rsocial-module... OK (189 files, 1.8 MB)\rai-module... OK (142 files, 1.3 MB)\radmin-module... OK (98 files, 0.9 MB)\rupload-module... OK (45 files, 0.4 MB)\rSTEP 3: Preparing deployment packages...\rPreparing api-router... Done\rPreparing auth-module... Done\rPreparing social-module... Done\rPreparing ai-module... Done\rPreparing admin-module... Done\rPreparing upload-module... Done\rSTEP 4: Deploying with CDK...\rSynthesizing CloudFormation templates...\rEveryoneCook-dev-Backend\rDeploying...\r✅ Lambda Layer updated\r✅ API Router function updated\r✅ Auth User function updated\r✅ Social function updated\r✅ Recipe AI function updated\r✅ AI Worker updated\r✅ Admin function updated\r✅ Upload function updated\rOutputs:\rApiUrl = https://xinq7xh300.execute-api.ap-southeast-1.amazonaws.com/v1/\rApiCustomDomain = https://api-dev.everyonecook.cloud\r========================================\rFULL DEPLOYMENT SUCCESSFUL!\r======================================== Bước 3: Xác minh Triển khai # Liệt kê tất cả Lambda functions aws lambda list-functions ` --query \u0026#39;Functions[?contains(FunctionName, `everyonecook-dev`)].{Name:FunctionName,Runtime:Runtime,Updated:LastModified}\u0026#39; ` --output table # Kết quả mong đợi: # -------------------------------------------------------- # | ListFunctions | # +------------------------------------------------------+ # | Name | Runtime | Updated | # +------------------------------------------------------+ # | everyonecook-dev-api-router | nodejs20.x | ... | # | everyonecook-dev-auth-user | nodejs20.x | ... | # | everyonecook-dev-social | nodejs20.x | ... | # | everyonecook-dev-recipe-ai | nodejs20.x | ... | # | everyonecook-dev-ai-worker | nodejs20.x | ... | # | everyonecook-dev-admin | nodejs20.x | ... | # | everyonecook-dev-upload | nodejs20.x | ... | # +------------------------------------------------------+ Tùy chọn B: Triển khai Nhanh (Chỉ Lambda Code) Nếu chỉ thay đổi Lambda code (không thay đổi infrastructure), dùng fast deployment.\nBước 1: Triển khai Chỉ Lambda # Fast deploy - chỉ update Lambda code .\\deploy\\deploy-backend.ps1 -Environment dev -LambdaOnly # Hoặc dùng script chuyên dụng .\\deploy\\force-update-lambdas.ps1 -Environment dev Quy trình triển khai nhanh hơn:\nBƯỚC 0: Build Layer (hoặc bỏ qua)\rBƯỚC 1: Build modules\rBƯỚC 2: Validate dist\rBƯỚC 3: Chuẩn bị packages\rBƯỚC 4: Upload lên Lambda (Fast Deploy)\r- Tạo ZIP files\r- Upload trực tiếp qua aws lambda update-function-code\r- Cập nhật Layer ARN nếu thay đổi\r- Bỏ qua CDK (nhanh hơn) Thời gian:\nFull Deploy (CDK): ~5-8 phút Lambda Only: ~2-3 phút Bước 2: Các Tùy chọn Bỏ qua (Nâng cao) # Bỏ qua build layer (sử dụng layer hiện có) .\\deploy\\deploy-backend.ps1 -Environment dev -SkipLayer # Bỏ qua build module (sử dụng dist hiện có) .\\deploy\\deploy-backend.ps1 -Environment dev -SkipBuild # Kết hợp các tùy chọn .\\deploy\\deploy-backend.ps1 -Environment dev -LambdaOnly -SkipLayer Bước 4: Xác minh Lambda Functions 1. Kiểm tra Cấu hình Function # Lấy chi tiết API Router aws lambda get-function ` --function-name everyonecook-dev-api-router ` --query \u0026#39;Configuration.{Runtime:Runtime,Handler:Handler,Timeout:Timeout,Memory:MemorySize,Layer:Layers[0].Arn}\u0026#39; # Kết quả mong đợi: # { # \u0026#34;Runtime\u0026#34;: \u0026#34;nodejs20.x\u0026#34;, # \u0026#34;Handler\u0026#34;: \u0026#34;services/api-router/dist/handlers/index.handler\u0026#34;, # \u0026#34;Timeout\u0026#34;: 30, # \u0026#34;Memory\u0026#34;: 512, # \u0026#34;Layer\u0026#34;: \u0026#34;arn:aws:lambda:ap-southeast-1:...:layer:everyonecook-shared-deps-dev:X\u0026#34; # } 2. Xác minh Code SHA256 (Code đã được cập nhật) # Kiểm tra code hash aws lambda get-function ` --function-name everyonecook-dev-api-router ` --query \u0026#39;Configuration.CodeSha256\u0026#39; # SHA256 sẽ thay đổi mỗi khi code được cập nhật 3. Kiểm tra Biến Môi trường # Lấy biến môi trường aws lambda get-function-configuration ` --function-name everyonecook-dev-auth-user ` --query \u0026#39;Environment.Variables\u0026#39; # Kết quả mong đợi: # { # \u0026#34;TABLE_NAME\u0026#34;: \u0026#34;EveryoneCook-dev\u0026#34;, # \u0026#34;REGION\u0026#34;: \u0026#34;ap-southeast-1\u0026#34;, # \u0026#34;USER_POOL_ID\u0026#34;: \u0026#34;ap-southeast-1_PKoL34PF0\u0026#34;, # ... # } Bước 5: Kiểm thử Lambda Functions 1. Kiểm thử API Router (Health Check) # Gọi API Router với test event aws lambda invoke ` --function-name everyonecook-dev-api-router ` --payload \u0026#39;{\u0026#34;httpMethod\u0026#34;:\u0026#34;GET\u0026#34;,\u0026#34;path\u0026#34;:\u0026#34;/health\u0026#34;,\u0026#34;headers\u0026#34;:{}}\u0026#39; ` response.json # Kiểm tra response Get-Content response.json | ConvertFrom-Json # Kết quả mong đợi: # { # \u0026#34;statusCode\u0026#34;: 200, # \u0026#34;body\u0026#34;: \u0026#34;{\\\u0026#34;status\\\u0026#34;:\\\u0026#34;healthy\\\u0026#34;,\\\u0026#34;timestamp\\\u0026#34;:\\\u0026#34;...\\\u0026#34;}\u0026#34; # } 2. Làm nóng Functions (Tránh Cold Start) # Làm nóng tất cả functions $functions = @( \u0026#34;everyonecook-dev-api-router\u0026#34;, \u0026#34;everyonecook-dev-auth-user\u0026#34;, \u0026#34;everyonecook-dev-social\u0026#34;, \u0026#34;everyonecook-dev-recipe-ai\u0026#34;, \u0026#34;everyonecook-dev-admin\u0026#34;, \u0026#34;everyonecook-dev-upload\u0026#34; ) foreach ($func in $functions) { Write-Host \u0026#34;Warming up $func...\u0026#34; -ForegroundColor Cyan aws lambda invoke ` --function-name $func ` --payload \u0026#39;{\u0026#34;warmup\u0026#34;:true}\u0026#39; ` out.json | Out-Null } Write-Host \u0026#34;All functions warmed up!\u0026#34; -ForegroundColor Green Bước 6: Kiểm tra CloudWatch Logs 1. Theo dõi Logs Real-time # Theo dõi API Router logs aws logs tail /aws/lambda/everyonecook-dev-api-router --follow # Xem logs 10 phút gần nhất aws logs tail /aws/lambda/everyonecook-dev-api-router --since 10m 2. Tìm kiếm Lỗi # Tìm kiếm lỗi trong giờ qua $oneHourAgo = [DateTimeOffset]::Now.AddHours(-1).ToUnixTimeMilliseconds() aws logs filter-log-events ` --log-group-name /aws/lambda/everyonecook-dev-api-router ` --start-time $oneHourAgo ` --filter-pattern \u0026#34;ERROR\u0026#34; 3. Kiểm tra Tất cả Lambda Logs # Liệt kê tất cả log groups aws logs describe-log-groups ` --log-group-name-prefix /aws/lambda/everyonecook-dev ` --query \u0026#39;logGroups[].logGroupName\u0026#39; Bước 7: Xác minh Tích hợp API Gateway 1. Lấy API Endpoint # Lấy API URL từ CloudFormation $apiUrl = aws cloudformation describe-stacks ` --stack-name EveryoneCook-dev-Backend ` --query \u0026#39;Stacks[0].Outputs[?OutputKey==`ApiCustomDomain`].OutputValue\u0026#39; ` --output text Write-Host \u0026#34;API Endpoint: $apiUrl\u0026#34; # Output: https://api-dev.everyonecook.cloud 2. Kiểm thử Health Endpoint # Kiểm thử qua API Gateway (endpoint thực) $response = Invoke-RestMethod -Uri \u0026#34;$apiUrl/health\u0026#34; -Method Get $response | ConvertTo-Json # Kết quả mong đợi: # { # \u0026#34;status\u0026#34;: \u0026#34;healthy\u0026#34;, # \u0026#34;timestamp\u0026#34;: \u0026#34;2025-12-09T...\u0026#34;, # \u0026#34;service\u0026#34;: \u0026#34;EveryoneCook API\u0026#34;, # \u0026#34;environment\u0026#34;: \u0026#34;dev\u0026#34; # } 3. Xác minh Triển khai API Gateway # Lấy API ID $apiId = aws cloudformation describe-stacks ` --stack-name EveryoneCook-dev-Backend ` --query \u0026#39;Stacks[0].Outputs[?OutputKey==`ApiId`].OutputValue\u0026#39; ` --output text # Liệt kê deployments aws apigateway get-deployments --rest-api-id $apiId # Lấy deployment mới nhất aws apigateway get-deployment ` --rest-api-id $apiId ` --deployment-id (aws apigateway get-deployments ` --rest-api-id $apiId ` --query \u0026#39;items[0].id\u0026#39; ` --output text) Bước 8: Xác minh Cognito Triggers Cognito triggers đã được deploy với Auth Stack. Xác minh:\n# Liệt kê Cognito User Pool triggers $userPoolId = aws cloudformation describe-stacks ` --stack-name EveryoneCook-dev-Auth ` --query \u0026#39;Stacks[0].Outputs[?OutputKey==`UserPoolId`].OutputValue\u0026#39; ` --output text aws cognito-idp describe-user-pool ` --user-pool-id $userPoolId ` --query \u0026#39;UserPool.LambdaConfig\u0026#39; # Kết quả mong đợi: # { # \u0026#34;PreSignUp\u0026#34;: \u0026#34;arn:aws:lambda:...:function:EveryoneCook-dev-PreSignup\u0026#34;, # \u0026#34;PostConfirmation\u0026#34;: \u0026#34;arn:aws:lambda:...:function:EveryoneCook-dev-PostConfirmation\u0026#34;, # \u0026#34;PostAuthentication\u0026#34;: \u0026#34;arn:aws:lambda:...:function:EveryoneCook-dev-PostAuthentication\u0026#34;, # \u0026#34;PreAuthentication\u0026#34;: \u0026#34;arn:aws:lambda:...:function:EveryoneCook-dev-PreAuthentication\u0026#34;, # \u0026#34;CustomMessage\u0026#34;: \u0026#34;arn:aws:lambda:...:function:EveryoneCook-dev-CustomMessage\u0026#34; # } Bước 9: Xác minh SQS Workers 1. Kiểm tra AI Worker # Lấy AI Worker function aws lambda get-function --function-name everyonecook-dev-ai-worker # Kiểm tra event source mapping (SQS trigger) aws lambda list-event-source-mappings ` --function-name everyonecook-dev-ai-worker # Kết quả mong đợi: Event source từ AI Queue 2. Kiểm thử Worker với SQS Message # Lấy AI Queue URL $queueUrl = aws sqs list-queues ` --queue-name-prefix everyonecook-dev-ai-queue ` --query \u0026#39;QueueUrls[0]\u0026#39; ` --output text # Gửi test message aws sqs send-message ` --queue-url $queueUrl ` --message-body \u0026#39;{\u0026#34;type\u0026#34;:\u0026#34;test\u0026#34;,\u0026#34;data\u0026#34;:\u0026#34;worker-verification\u0026#34;}\u0026#39; # Kiểm tra worker logs aws logs tail /aws/lambda/everyonecook-dev-ai-worker --follow Danh sách Kiểm tra Triển khai Sử dụng danh sách này để xác minh deployment:\nBuild \u0026amp; Package Lambda Layer được build thành công (~15-20 MB) Tất cả 7 modules được biên dịch (TypeScript → JavaScript) Dist folders được xác thực (không có node_modules, \u0026lt; 10 MB) Deployment packages được tạo với build-info.json Lambda Functions Tất cả 7 Lambda functions được triển khai\nRuntime: nodejs20.x\nHandler paths chính xác\nTimeout: 30 giây\nMemory: 512 MB (auth, social), 1024 MB (ai)\nLambda Layer được đính kèm vào tất cả functions\nBiến môi trường được cấu hình đúng\nCode SHA256 đã thay đổi (code đã cập nhật)\nCognito Triggers Pre-Signup trigger được triển khai Post-Confirmation trigger được triển khai Post-Authentication trigger được triển khai Pre-Authentication trigger được triển khai Custom Message trigger được triển khai API Gateway API Gateway được triển khai Custom domain được cấu hình: api-dev.everyonecook.cloud Health endpoint phản hồi: GET /health CORS được cấu hình đúng Workers \u0026amp; Queues AI Worker được triển khai Event source mapping được cấu hình (SQS → Lambda) SQS queues được tạo (ai-queue, image-queue, analytics-queue, notification-queue) Worker có thể xử lý test messages Xác minh Tất cả functions được gọi thành công Không có lỗi trong CloudWatch logs API Gateway trả về 200 cho health check Functions đã được làm nóng (không có cold start) Xử lý Sự cố Vấn đề 1: Build Thất bại - Lỗi Biên dịch TypeScript # Kiểm tra lỗi TypeScript cd services/auth-module npx tsc --noEmit # Sửa lỗi và rebuild npm run build Vấn đề 2: Thư mục Dist Quá Lớn # Kiểm tra node_modules trong dist Get-ChildItem -Path services/*/dist/node_modules -Recurse # Script sẽ tự động xóa, hoặc thủ công: Remove-Item services/auth-module/dist/node_modules -Recurse -Force # Rebuild cd services/auth-module npm run build Vấn đề 3: Cập nhật Lambda Thất bại # Kiểm tra trạng thái function aws lambda get-function ` --function-name everyonecook-dev-auth-user ` --query \u0026#39;Configuration.{State:State,StateReason:StateReason}\u0026#39; # Nếu state là \u0026#34;Failed\u0026#34;, kiểm tra logs aws logs tail /aws/lambda/everyonecook-dev-auth-user --since 10m Vấn đề 4: Function Timeout # Tăng timeout (qua CDK hoặc AWS CLI) aws lambda update-function-configuration ` --function-name everyonecook-dev-auth-user ` --timeout 60 # Hoặc cập nhật trong backend-stack.ts và redeploy Vấn đề 5: Hết Bộ nhớ # Tăng memory aws lambda update-function-configuration ` --function-name everyonecook-dev-recipe-ai ` --memory-size 1024 # AI functions cần 1024 MB cho Bedrock calls Vấn đề 6: Layer Không Được Đính kèm # Lấy layer ARN $layerArn = aws lambda list-layer-versions ` --layer-name everyonecook-shared-deps-dev ` --query \u0026#39;LayerVersions[0].LayerVersionArn\u0026#39; ` --output text # Đính kèm layer thủ công aws lambda update-function-configuration ` --function-name everyonecook-dev-auth-user ` --layers $layerArn Vấn đề 7: Thiếu Biến Môi trường # Kiểm tra biến môi trường hiện tại aws lambda get-function-configuration ` --function-name everyonecook-dev-auth-user ` --query \u0026#39;Environment.Variables\u0026#39; # Cập nhật thủ công (hoặc qua CDK) aws lambda update-function-configuration ` --function-name everyonecook-dev-auth-user ` --environment \u0026#34;Variables={TABLE_NAME=EveryoneCook-dev,REGION=ap-southeast-1}\u0026#34; Giám sát Hiệu suất 1. Lambda Metrics (CloudWatch) # Lấy số lần gọi (1 giờ qua) $startTime = (Get-Date).AddHours(-1).ToString(\u0026#34;yyyy-MM-ddTHH:mm:ss\u0026#34;) $endTime = (Get-Date).ToString(\u0026#34;yyyy-MM-ddTHH:mm:ss\u0026#34;) aws cloudwatch get-metric-statistics ` --namespace AWS/Lambda ` --metric-name Invocations ` --dimensions Name=FunctionName,Value=everyonecook-dev-api-router ` --start-time $startTime ` --end-time $endTime ` --period 300 ` --statistics Sum 2. Tỷ lệ Lỗi # Lấy số lượng lỗi aws cloudwatch get-metric-statistics ` --namespace AWS/Lambda ` --metric-name Errors ` --dimensions Name=FunctionName,Value=everyonecook-dev-api-router ` --start-time $startTime ` --end-time $endTime ` --period 300 ` --statistics Sum 3. Thời gian Thực thi (Trung bình \u0026amp; P99) # Lấy thời gian thực thi trung bình aws cloudwatch get-metric-statistics ` --namespace AWS/Lambda ` --metric-name Duration ` --dimensions Name=FunctionName,Value=everyonecook-dev-api-router ` --start-time $startTime ` --end-time $endTime ` --period 300 ` --statistics Average,Maximum 4. Thực thi Đồng thời # Kiểm tra số lượng thực thi đồng thời aws cloudwatch get-metric-statistics ` --namespace AWS/Lambda ` --metric-name ConcurrentExecutions ` --dimensions Name=FunctionName,Value=everyonecook-dev-api-router ` --start-time $startTime ` --end-time $endTime ` --period 300 ` --statistics Maximum Thực hành Tốt nhất 1. Chiến lược Triển khai Development:\n# Lặp nhanh - Chỉ Lambda .\\deploy\\deploy-backend.ps1 -LambdaOnly Staging/Production:\n# Triển khai đầy đủ với CDK .\\deploy\\deploy-backend.ps1 -Environment prod # Xác minh kỹ lưỡng trước khi tiếp tục 2. Chiến lược Rollback # Lấy phiên bản trước đó aws lambda list-versions-by-function ` --function-name everyonecook-dev-auth-user # Rollback về phiên bản X aws lambda update-alias ` --function-name everyonecook-dev-auth-user ` --name LIVE ` --function-version X 3. Triển khai Blue-Green # Triển khai lên phiên bản mới .\\deploy\\deploy-backend.ps1 -Environment dev # Kiểm thử phiên bản mới # Nếu OK, chuyển traffic hoàn tất # Nếu có vấn đề, rollback alias 4. Cảnh báo Giám sát # Tạo CloudWatch alarm cho lỗi aws cloudwatch put-metric-alarm ` --alarm-name everyonecook-dev-api-router-errors ` --alarm-description \u0026#34;Alert on Lambda errors\u0026#34; ` --metric-name Errors ` --namespace AWS/Lambda ` --statistic Sum ` --period 300 ` --evaluation-periods 1 ` --threshold 10 ` --comparison-operator GreaterThanThreshold ` --dimensions Name=FunctionName,Value=everyonecook-dev-api-router Benchmarks Hiệu suất Thời gian Triển khai Dự kiến:\nThao tác Thời gian Ghi chú Build Layer 30-60s npm install production deps Build Modules 20-40s Biên dịch TypeScript (7 modules) Validate \u0026amp; Package 10-20s Tạo ZIP CDK Deploy 3-5 phút Cập nhật CloudFormation Lambda Only 1-2 phút Cập nhật function trực tiếp Hiệu suất Lambda Dự kiến:\nFunction Cold Start Warm Memory Timeout api-router 800-1200ms 50-100ms 512 MB 30s auth-user 600-900ms 80-150ms 512 MB 30s social 700-1000ms 100-200ms 512 MB 30s recipe-ai 1500-2500ms 200-500ms 1024 MB 60s ai-worker 2000-3000ms 300-800ms 1024 MB 300s admin 600-800ms 100-150ms 512 MB 30s upload 400-600ms 50-80ms 256 MB 15s Nâng cao: Tích hợp CI/CD Để tự động hóa deployment trong GitLab CI/CD:\n# .gitlab-ci.yml deploy-backend: stage: deploy script: - cd everyonecook - .\\deploy\\deploy-backend.ps1 -Environment $CI_ENVIRONMENT_NAME -LambdaOnly only: - main environment: name: production Tóm tắt Trong lab này, bạn đã:\n✅ Triển khai Lambda Functions: 7 modules + 5 Cognito triggers\n✅ Triển khai Lambda Layer: Shared dependencies\n✅ Cấu hình API Gateway: Tích hợp custom domain\n✅ Thiết lập SQS Workers: Xử lý bất đồng bộ\n✅ Xác minh Triển khai: Health checks, logs, metrics\n✅ Tối ưu Hiệu suất: Làm nóng functions, tối ưu cold start\nThành tựu Chính:\nTriển khai tự động với PowerShell script Full CDK deployment hoặc cập nhật Lambda-only nhanh Xác thực toàn diện và xử lý lỗi Giám sát và cảnh báo CloudWatch Cấu hình Lambda production-ready Các Bước Tiếp theo Backend đã được triển khai thành công! Tiếp theo:\n✅ Kiểm thử Endpoints: Xác minh tất cả API endpoints → 5.08 - Test Endpoints 📝 Quản lý Phiên bản: Push code lên GitLab → 5.09 - Push to GitLab 🚀 Triển khai Frontend: Ứng dụng Next.js 🔍 Giám sát: CloudWatch dashboards và alerts Tiếp tục đến: 5.08 - Test Endpoints End-to-End\n# Kiểm thử get posts aws lambda invoke \\ --function-name EveryoneCook-dev-SocialModule \\ --payload \u0026#39;{ \u0026#34;httpMethod\u0026#34;:\u0026#34;GET\u0026#34;, \u0026#34;path\u0026#34;:\u0026#34;/social/posts\u0026#34;, \u0026#34;headers\u0026#34;:{\u0026#34;Authorization\u0026#34;:\u0026#34;Bearer test-token\u0026#34;}, \u0026#34;requestContext\u0026#34;:{\u0026#34;authorizer\u0026#34;:{\u0026#34;claims\u0026#34;:{\u0026#34;sub\u0026#34;:\u0026#34;test-user-id\u0026#34;,\u0026#34;username\u0026#34;:\u0026#34;testuser\u0026#34;}}} }\u0026#39; \\ response.json cat response.json Bước 5: Kiểm tra CloudWatch Logs 1. Xem Logs Gần đây\n# Theo dõi Auth Module logs aws logs tail /aws/lambda/EveryoneCook-dev-AuthModule --follow # Hoặc xem 10 phút gần nhất aws logs tail /aws/lambda/EveryoneCook-dev-AuthModule --since 10m 2. Tìm kiếm Lỗi\n# Tìm kiếm lỗi trong giờ qua aws logs filter-log-events \\ --log-group-name /aws/lambda/EveryoneCook-dev-AuthModule \\ --start-time $(date -d \u0026#39;1 hour ago\u0026#39; +%s)000 \\ --filter-pattern \u0026#34;ERROR\u0026#34; 3. Kiểm tra Lambda Insights\n# Lấy Lambda metrics aws cloudwatch get-metric-statistics \\ --namespace AWS/Lambda \\ --metric-name Invocations \\ --dimensions Name=FunctionName,Value=EveryoneCook-dev-AuthModule \\ --start-time $(date -u -d \u0026#39;1 hour ago\u0026#39; +%Y-%m-%dT%H:%M:%S) \\ --end-time $(date -u +%Y-%m-%dT%H:%M:%S) \\ --period 300 \\ --statistics Sum Screenshot: CloudWatch Logs hiển thị Lambda execution\nBước 6: Triển khai Lambda Triggers Lambda triggers đã được triển khai với Auth Stack, xác minh:\n# Kiểm tra Post-Confirmation trigger aws lambda get-function \\ --function-name EveryoneCook-dev-PostConfirmationTrigger # Kiểm thử trigger (sẽ được gọi tự động khi user confirmation) Bước 7: Triển khai Search Sync Worker 1. Triển khai Worker\n# Worker được triển khai với Backend Stack # Xác minh deployment aws lambda get-function \\ --function-name EveryoneCook-dev-SearchSyncWorker 2. Kiểm thử Worker với SQS\n# Lấy SearchIndex queue URL QUEUE_URL=$(aws sqs list-queues \\ --queue-name-prefix EveryoneCook-dev-SearchIndexQueue \\ | jq -r \u0026#39;.QueueUrls[0]\u0026#39;) # Gửi test message aws sqs send-message \\ --queue-url $QUEUE_URL \\ --message-body \u0026#39;{ \u0026#34;eventName\u0026#34;: \u0026#34;INSERT\u0026#34;, \u0026#34;tableName\u0026#34;: \u0026#34;recipes\u0026#34;, \u0026#34;keys\u0026#34;: {\u0026#34;PK\u0026#34;: \u0026#34;USER#testuser\u0026#34;, \u0026#34;SK\u0026#34;: \u0026#34;RECIPE#test-123\u0026#34;}, \u0026#34;newImage\u0026#34;: {\u0026#34;title\u0026#34;: \u0026#34;Test Recipe\u0026#34;, \u0026#34;cuisine\u0026#34;: \u0026#34;Vietnamese\u0026#34;} }\u0026#39; # Kiểm tra worker logs aws logs tail /aws/lambda/EveryoneCook-dev-SearchSyncWorker --follow Bước 8: Cập nhật API Gateway API Gateway tự động cập nhật khi triển khai Backend Stack, xác minh:\n# Lấy API Gateway deployment API_ID=$(aws cloudformation describe-stacks \\ --stack-name EveryoneCook-dev-Backend \\ --query \u0026#39;Stacks[0].Outputs[?OutputKey==`ApiId`].OutputValue\u0026#39; \\ --output text) # Liệt kê deployments aws apigateway get-deployments --rest-api-id $API_ID # Lấy deployment mới nhất aws apigateway get-deployment \\ --rest-api-id $API_ID \\ --deployment-id $(aws apigateway get-deployments \\ --rest-api-id $API_ID \\ --query \u0026#39;items[0].id\u0026#39; \\ --output text) Bước 9: Làm nóng Lambda Functions Tránh cold start cho các requests đầu tiên:\n# Gọi tất cả functions một lần for func in APIRouter AuthModule SocialModule RecipeAIModule AdminModule UploadModule SearchSyncWorker; do echo \u0026#34;Warming up $func...\u0026#34; aws lambda invoke \\ --function-name EveryoneCook-dev-$func \\ --payload \u0026#39;{\u0026#34;warmup\u0026#34;:true}\u0026#39; \\ /dev/null done Bước 10: Xác minh End-to-End 1. Kiểm thử Health Endpoint\n# Kiểm thử qua API Gateway curl https://api.everyonecook.cloud/health # Nên trả về: {\u0026#34;status\u0026#34;:\u0026#34;healthy\u0026#34;,\u0026#34;timestamp\u0026#34;:\u0026#34;...\u0026#34;} 2. Kiểm thử với Postman\nImport Postman collection:\n{ \u0026#34;info\u0026#34;: { \u0026#34;name\u0026#34;: \u0026#34;EveryoneCook API\u0026#34;, \u0026#34;schema\u0026#34;: \u0026#34;https://schema.getpostman.com/json/collection/v2.1.0/collection.json\u0026#34; }, \u0026#34;item\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Health Check\u0026#34;, \u0026#34;request\u0026#34;: { \u0026#34;method\u0026#34;: \u0026#34;GET\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://api.everyonecook.cloud/health\u0026#34; } } ] } Danh sách Kiểm tra Triển khai Script chuẩn bị hoàn tất thành công Tất cả Lambda functions được cập nhật Trạng thái function: Active Các lần gọi kiểm thử thành công CloudWatch logs hiển thị executions Không có lỗi trong logs Lambda triggers hoạt động Search Sync Worker xử lý messages API Gateway được cập nhật Health endpoint phản hồi Functions đã được làm nóng Xử lý Sự cố Vấn đề: Cập nhật Lambda thất bại\n# Kiểm tra trạng thái function aws lambda get-function \\ --function-name EveryoneCook-dev-AuthModule \\ --query \u0026#39;Configuration.State\u0026#39; # Nếu state là \u0026#34;Failed\u0026#34;, kiểm tra StateReasonCode aws lambda get-function \\ --function-name EveryoneCook-dev-AuthModule \\ --query \u0026#39;Configuration.StateReasonCode\u0026#39; Vấn đề: Function timeout\n# Tăng timeout aws lambda update-function-configuration \\ --function-name EveryoneCook-dev-AuthModule \\ --timeout 30 Vấn đề: Hết bộ nhớ\n# Tăng memory aws lambda update-function-configuration \\ --function-name EveryoneCook-dev-AuthModule \\ --memory-size 512 Vấn đề: Thiếu biến môi trường\n# Cập nhật biến môi trường aws lambda update-function-configuration \\ --function-name EveryoneCook-dev-AuthModule \\ --environment Variables={TABLE_NAME=EveryoneCook-dev,REGION=us-east-1} Giám sát Hiệu suất Kiểm tra Lambda metrics:\n# Invocations aws cloudwatch get-metric-statistics \\ --namespace AWS/Lambda \\ --metric-name Invocations \\ --dimensions Name=FunctionName,Value=EveryoneCook-dev-AuthModule \\ --start-time $(date -u -d \u0026#39;1 hour ago\u0026#39; +%Y-%m-%dT%H:%M:%S) \\ --end-time $(date -u +%Y-%m-%dT%H:%M:%S) \\ --period 300 \\ --statistics Sum # Errors aws cloudwatch get-metric-statistics \\ --namespace AWS/Lambda \\ --metric-name Errors \\ --dimensions Name=FunctionName,Value=EveryoneCook-dev-AuthModule \\ --start-time $(date -u -d \u0026#39;1 hour ago\u0026#39; +%Y-%m-%dT%H:%M:%S) \\ --end-time $(date -u +%Y-%m-%dT%H:%M:%S) \\ --period 300 \\ --statistics Sum # Duration aws cloudwatch get-metric-statistics \\ --namespace AWS/Lambda \\ --metric-name Duration \\ --dimensions Name=FunctionName,Value=EveryoneCook-dev-AuthModule \\ --start-time $(date -u -d \u0026#39;1 hour ago\u0026#39; +%Y-%m-%dT%H:%M:%S) \\ --end-time $(date -u +%Y-%m-%dT%H:%M:%S) \\ --period 300 \\ --statistics Average,Maximum Các Bước Tiếp theo Sau khi backend được triển khai và xác minh, tiếp tục đến Test Endpoints End-to-End để kiểm thử luồng ứng dụng hoàn chỉnh.\n"
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/1-worklog/1.7-week7/",
	"title": "Báo cáo công việc Tuần 7",
	"tags": [],
	"description": "",
	"content": "Mục tiêu Tuần 7: Đóng gói ứng dụng (Containerization): Làm chủ việc đóng gói ứng dụng sử dụng Docker và triển khai trên EC2. Điều phối Container (Orchestration): Triển khai và quản lý các ứng dụng container có khả năng mở rộng sử dụng Amazon ECS (Elastic Container Service). DevOps \u0026amp; Tự động hóa: Triển khai CI/CD Pipelines (AWS CodePipeline, CodeBuild) để tự động hóa việc triển khai lên EC2 và ECS. Giải pháp Lưu trữ: Tích hợp môi trường on-premises với lưu trữ đám mây sử dụng File Storage Gateway và FSx for Windows. Kiến trúc Cơ sở dữ liệu Nâng cao: Tìm hiểu sâu về các mẫu thiết kế (design patterns), chiến lược đánh chỉ mục và mô hình hóa dữ liệu cho các ứng dụng hiệu năng cao với Amazon DynamoDB. Các nhiệm vụ thực hiện trong tuần: Ngày Nhiệm vụ Ngày bắt đầu Ngày hoàn thành Tài liệu tham khảo 2 Đóng gói Ứng dụng (Docker) - Cài đặt Docker trên EC2 \u0026amp; Máy cục bộ. - Build Docker images cho ứng dụng mẫu (Frontend/Backend). - Sử dụng Docker Compose để điều phối nhiều container. - Đẩy (Push) images lên Amazon ECR (Elastic Container Registry). 20/10/2025 20/10/2025 https://000015.awsstudygroup.com/ 3 Điều phối Container (Amazon ECS) - Tạo ECS Cluster (Launch Type: Fargate/EC2). - Định nghĩa Task Definitions và Services. - Cấu hình Application Load Balancer (ALB) để phân phối lưu lượng. - Triển khai Service Discovery với AWS Cloud Map. 21/10/2025 21/10/2025 https://000016.awsstudygroup.com/ 4 CI/CD cho Containers - Thiết lập AWS CodePipeline kích hoạt từ GitHub/GitLab. - Cấu hình AWS CodeBuild để build và push Docker images. - Tự động hóa deploy lên ECS Clusters. - Triển khai Monitoring với Container Insights và Logging với FireLens. 22/10/2025 22/10/2025 https://000017.awsstudygroup.com/ 5 CI/CD cho EC2 \u0026amp; Lưu trữ Hybrid - CodePipeline cho EC2: Tự động hóa deploy sử dụng CodeDeploy agent. - Storage Gateway: Cấu hình File Gateway để mount S3 buckets dưới dạng NFS shares. - Amazon FSx: Triển khai Windows File Server được quản lý hoàn toàn và mount qua SMB. 23/10/2025 23/10/2025 https://000023.awsstudygroup.com/ Tự nghiên cứu về FSx/Storage Gateway 6 Kiến trúc DynamoDB Nâng cao - Mô hình hóa dữ liệu: Thiết kế theo mẫu Single Table Design. - Tối ưu hiệu năng: Làm việc với Partition Keys, Sort Keys, và Capacity Units (RCU/WCU). - Tính năng nâng cao: Triển khai Global Secondary Indexes (GSI), DynamoDB Streams, và Global Tables. 24/10/2025 24/10/2025 https://000039.awsstudygroup.com/ Thành tựu Tuần 7 Containerization \u0026amp; Orchestration Đã thực hiện \u0026ldquo;dockerize\u0026rdquo; thành công một ứng dụng nguyên khối (monolithic), tách biệt nó khỏi cơ sở hạ tầng bên dưới. Triển khai cụm container có tính sẵn sàng cao sử dụng Amazon ECS, tận dụng Task Definitions để định nghĩa yêu cầu tài nguyên. Cấu hình Service Discovery cho phép các microservices trong cụm giao tiếp qua tên logic thay vì địa chỉ IP. Triển khai Application Load Balancer để phân phối lưu lượng public tới các container target động. Tự động hóa DevOps \u0026amp; CI/CD Xây dựng CI/CD Pipeline mạnh mẽ sử dụng AWS CodePipeline và CodeBuild. Đạt được Continuous Deployment (Triển khai liên tục): Các thay đổi code đẩy lên repository tự động kích hoạt quá trình build, tạo image và cập nhật rolling update cho dịch vụ ECS mà không gây gián đoạn (zero downtime). Tích hợp giám sát toàn diện sử dụng CloudWatch Container Insights để theo dõi mức sử dụng CPU/Memory của các task. Tập trung hóa log của container sử dụng FireLens để dễ dàng gỡ lỗi và phân tích. Triển khai Lưu trữ Hybrid Kết nối khoảng cách giữa các giao thức on-premises và lưu trữ đám mây. Cấu hình File Storage Gateway cho phép các ứng dụng cũ (legacy) ghi dữ liệu vào S3 bằng giao thức NFS tiêu chuẩn. Triển khai Amazon FSx for Windows File Server, cung cấp hệ thống tệp Windows native được quản lý hoàn toàn với khả năng tích hợp Active Directory. Thiết kế Cơ sở dữ liệu Hiệu năng cao Làm chủ các khái niệm NoSQL với Amazon DynamoDB. Tối ưu hóa hiệu năng cơ sở dữ liệu bằng cách thiết kế Partition Key và Sort Key hiệu quả. Triển khai Global Secondary Indexes (GSI) để hỗ trợ các mẫu truy cập đa dạng mà không cần nhân bản bảng dữ liệu. Khám phá DynamoDB Streams cho kiến trúc hướng sự kiện (kích hoạt Lambda function khi dữ liệu thay đổi). "
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/7-feedback/",
	"title": "Chia Sẻ và Phản Hồi",
	"tags": [],
	"description": "",
	"content": "Đánh Giá Chung 1. Môi trường làm việc\nMôi trường làm việc chuyên nghiệp, thân thiện và rất thuận lợi cho việc học hỏi. Các thành viên trong nhóm luôn giữ thái độ hòa nhã, hỗ trợ khi cần thiết và tạo điều kiện để tôi dễ dàng hòa nhập. Không gian làm việc được bố trí ngăn nắp, thoải mái, góp phần nâng cao hiệu suất. Công ty có thể bổ sung thêm các hoạt động gắn kết nội bộ để tăng sự tương tác giữa các thành viên.\n2. Sự hỗ trợ từ Mentor / Team Admin\nMentor của tôi luôn đưa ra định hướng rõ ràng, có cấu trúc và khuyến khích tôi tự tìm hướng giải quyết trước khi đưa ra hướng dẫn chi tiết. Bộ phận admin cũng hỗ trợ nhanh chóng, đặc biệt trong các thủ tục và tài liệu liên quan, giúp quy trình làm việc diễn ra thuận lợi. Sự kết hợp giữa mentor và admin đã đóng vai trò quan trọng trong quá trình phát triển của tôi.\n3. Mức độ phù hợp của công việc với chuyên ngành\nCác nhiệm vụ được giao phù hợp với kiến thức tôi đã học tại trường đại học, đồng thời mở rộng thêm nhiều kiến thức thực tế và công cụ mới. Điều này giúp tôi củng cố nền tảng lý thuyết và phát triển thêm các kỹ năng cần thiết trong ngành.\n4. Cơ hội học hỏi và phát triển kỹ năng\nKỳ thực tập giúp tôi làm quen với các công cụ quản lý dự án, quy trình làm việc nhóm và kỹ năng giao tiếp chuyên nghiệp. Mentor còn chia sẻ nhiều kinh nghiệm thực tế trong ngành, giúp tôi hình dung rõ hơn về định hướng nghề nghiệp và mục tiêu phát triển lâu dài.\n5. Văn hóa công ty và tinh thần làm việc\nCông ty xây dựng một môi trường tôn trọng và tích cực. Các thành viên luôn hỗ trợ lẫn nhau và hợp tác hiệu quả. Trong những giai đoạn công việc gấp rút, mọi người đều chủ động phối hợp, không phân biệt vị trí hay thâm niên. Điều này tạo cho tôi cảm giác được chào đón và là một phần của tập thể.\n6. Chính sách / Phúc lợi thực tập\nChính sách thực tập thân thiện và hỗ trợ, bao gồm phụ cấp và sự linh hoạt khi cần thiết. Ngoài ra, cơ hội tham gia các buổi đào tạo nội bộ cũng mang lại nhiều giá trị, góp phần nâng cao trải nghiệm thực tập của tôi.\nCác Câu Hỏi Bổ Sung 1. Điều bạn hài lòng nhất trong kỳ thực tập?\nĐiều khiến tôi hài lòng nhất là được làm việc trong một môi trường chuyên nghiệp nhưng vẫn rất cởi mở và hỗ trợ. Tôi đánh giá cao sự hướng dẫn tận tình của mentor — rõ ràng, khoa học và luôn tạo điều kiện để tôi rèn luyện khả năng tự giải quyết vấn đề. Nhờ đó, tôi tiến bộ cả về kỹ thuật lẫn tác phong nghề nghiệp.\n2. Công ty nên cải thiện điểm nào cho các khóa thực tập sau?\nKhông có thêm ý kiến nào ngoài những điểm đã đề cập ở trên.\n3. Bạn có giới thiệu chương trình thực tập này cho bạn bè không? Vì sao?\nCó. Tôi hoàn toàn sẵn lòng giới thiệu chương trình. Kỳ thực tập kết hợp tốt giữa đào tạo kỹ thuật, trải nghiệm thực tiễn và môi trường làm việc tích cực. Mentor hỗ trợ tận tình, còn công việc mang lại cơ hội phát triển thật sự cho các bạn sinh viên.\nGóp Ý \u0026amp; Kỳ Vọng Bạn có đề xuất gì để nâng cao trải nghiệm thực tập không?\nKhông có thêm ý kiến.\nBạn có muốn tiếp tục tham gia chương trình trong tương lai không?\nKhông có thêm ý kiến.\nÝ kiến bổ sung:\nKhông có thêm ý kiến.\n"
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/5-workshop/5.04-configure-stacks/5.4.7-observability-stack/",
	"title": "5.4.7 Observability Stack",
	"tags": [],
	"description": "",
	"content": " Observability Stack - Monitoring \u0026amp; Alerting Tổng quan Observability Stack là lớp giám sát Phase 7 của hạ tầng EveryoneCook. Nó cung cấp giám sát toàn diện, cảnh báo và trực quan hóa cho tất cả các stack đã triển khai thông qua CloudWatch dashboards, alarms và SNS notifications.\nThứ tự triển khai: Stack này PHẢI được triển khai CUỐI CÙNG, sau khi tất cả các stack khác (DNS, Certificate, Core, Auth, Backend, Frontend) đã được triển khai.\n⚠️ Lưu ý môi trường: Hướng dẫn này tập trung vào triển khai môi trường Development (dev). Đối với triển khai staging/production, ngưỡng alarm và khoảng thời gian giám sát có thể khác.\nTrách nhiệm chính Tạo CloudWatch Dashboards cho tất cả các lớp stack Cấu hình CloudWatch Alarms cho các metric quan trọng Thiết lập SNS Topic cho thông báo alarm Tạo Composite Alarm cho trạng thái sức khỏe tổng thể hệ thống Giám sát API Gateway, Lambda, DynamoDB, S3, CloudFront và Cognito Theo dõi chi phí và billing metrics Stack này bao gồm CloudWatch Dashboards (4 dashboards):\nCore Dashboard: DynamoDB, S3, CloudFront metrics Auth Dashboard: Cognito authentication metrics Backend Dashboard: API Gateway, Lambda, SQS metrics Overview Dashboard: Aggregated system health view CloudWatch Alarms (15+ alarms):\nAPI Gateway: 5XX errors, 4XX errors, latency Lambda: Error rate, throttles, duration DynamoDB: Read/write throttles, latency S3: 4XX/5XX errors SQS: DLQ messages, queue age Cost: Daily spending warnings Hệ thống thông báo:\nSNS Topic cho thông báo alarm Email subscriptions cho alerts Composite alarm cho trạng thái sức khỏe hệ thống Kiến trúc ┌──────────────────────────────────────────────────────────────────────┐\r│ Observability Stack (Phase 7 - Dev Environment) │\r│ │\r│ ┌─────────────────────────────────────────────────────────────────┐ │\r│ │ SNS Topic (Alarm Notifications) │ │\r│ │ ├─ Topic Name: EveryoneCook-dev-Alarms │ │\r│ │ ├─ Email Subscription: team@everyonecook.cloud │ │\r│ │ └─ Protocol: Email (yêu cầu xác nhận) │ │\r│ └─────────────────────────────────────────────────────────────────┘ │\r│ │ │\r│ ▼ (Alarm Actions) │\r│ ┌─────────────────────────────────────────────────────────────────┐ │\r│ │ CloudWatch Alarms (15+ alarms) │ │\r│ │ │ │\r│ │ API Gateway Alarms: │ │\r│ │ ├─ 5XX Error Rate \u0026gt; 5% (Critical) │ │\r│ │ ├─ 4XX Error Rate \u0026gt; 20% (Warning) │ │\r│ │ └─ P99 Latency \u0026gt; 3s (Warning) │ │\r│ │ │ │\r│ │ Lambda Alarms: │ │\r│ │ ├─ Error Rate \u0026gt; 5% (Critical) │ │\r│ │ ├─ Throttles \u0026gt; 10 (Critical) │ │\r│ │ └─ P99 Duration \u0026gt; 10s (Warning) │ │\r│ │ │ │\r│ │ DynamoDB Alarms: │ │\r│ │ ├─ Read Throttles \u0026gt; 10 (Critical) │ │\r│ │ ├─ Write Throttles \u0026gt; 10 (Critical) │ │\r│ │ └─ P99 Latency \u0026gt; 100ms (Warning) │ │\r│ │ │ │\r│ │ S3 Alarms: │ │\r│ │ ├─ 4XX Error Rate \u0026gt; 5% (Warning) │ │\r│ │ └─ 5XX Errors \u0026gt; 0 (Critical) │ │\r│ │ │ │\r│ │ SQS Alarms: │ │\r│ │ ├─ DLQ Messages \u0026gt; 0 (Critical) │ │\r│ │ └─ Message Age \u0026gt; 5 minutes (Warning) │ │\r│ │ │ │\r│ │ Cost Alarms: │ │\r│ │ ├─ Daily Cost \u0026gt; $50 (Warning) │ │\r│ │ └─ Daily Cost \u0026gt; $100 (Critical) │ │\r│ └─────────────────────────────────────────────────────────────────┘ │\r│ │ │\r│ ▼ │\r│ ┌─────────────────────────────────────────────────────────────────┐ │\r│ │ Composite Alarm (System Health) │ │\r│ │ ├─ Name: EveryoneCook-dev-SystemHealth │ │\r│ │ ├─ Triggers: BẤT KỲ critical alarm nào kích hoạt │ │\r│ │ └─ Action: Gửi SNS notification │ │\r│ └─────────────────────────────────────────────────────────────────┘ │\r│ │\r│ ┌─────────────────────────────────────────────────────────────────┐ │\r│ │ CloudWatch Dashboards (4 dashboards) │ │\r│ │ │ │\r│ │ 1. Core Dashboard (EveryoneCook-dev-Core): │ │\r│ │ ├─ DynamoDB: Read/Write capacity, throttles, latency │ │\r│ │ ├─ S3: Requests, errors, bytes transferred │ │\r│ │ └─ CloudFront: Requests, error rates, bytes downloaded │ │\r│ │ │ │\r│ │ 2. Auth Dashboard (EveryoneCook-dev-Auth): │ │\r│ │ ├─ Cognito: Sign-ups, sign-ins │ │\r│ │ └─ Cognito: Failed authentications │ │\r│ │ │ │\r│ │ 3. Backend Dashboard (EveryoneCook-dev-Backend): │ │\r│ │ ├─ API Gateway: Requests, latency (P50/P95/P99) │ │\r│ │ ├─ API Gateway: 4XX/5XX errors │ │\r│ │ ├─ Lambda: Invocations, duration, errors, throttles │ │\r│ │ └─ SQS: Messages sent, visible, oldest age │ │\r│ │ │ │\r│ │ 4. Overview Dashboard (EveryoneCook-dev-Overview): │ │\r│ │ ├─ System Health: Environment info, region │ │\r│ │ ├─ Key Metrics: API requests, latency, Lambda stats │ │\r│ │ ├─ Error Trends: API 5XX, Lambda errors (giờ gần nhất) │ │\r│ │ ├─ Cost Tracking: Chi phí ước tính hàng ngày, xu hướng 7d │ │\r│ │ └─ Alarm Status: Composite alarm widget │ │\r│ └─────────────────────────────────────────────────────────────────┘ │\r└──────────────────────────────────────────────────────────────────────┘\r│\r│ Giám sát\r▼\r┌──────────────────┴───────────────────┐\r▼ ▼ ▼\rCore Stack Auth Stack Backend Stack\r(DynamoDB, (Cognito) (API Gateway,\rS3, CDN) Lambda, SQS) Cấu hình Stack Cấu trúc thư mục infrastructure/lib/stacks/\r└── observability-stack.ts # Observability Stack implementation (1175 dòng) Code Implementation Highlights File: infrastructure/lib/stacks/observability-stack.ts\n1. SNS Topic cho Alarms /** * Tạo SNS Topic cho CloudWatch Alarms * Task 7.4.2 - Step 1 */ private createAlarmTopic(): sns.Topic { const topic = new sns.Topic(this, \u0026#39;AlarmTopic\u0026#39;, { topicName: `EveryoneCook-${this.config.environment}-Alarms`, displayName: \u0026#39;Everyone Cook CloudWatch Alarms\u0026#39;, }); // Thêm email subscription cho alarm notifications topic.addSubscription( new sns_subscriptions.EmailSubscription(this.config.contact.email) ); return topic; } Cấu hình: Email subscription yêu cầu xác nhận qua AWS SNS.\n2. API Gateway Alarms // API Gateway: High 5XX Error Rate (Critical) const api5xxAlarm = new cloudwatch.Alarm(this, \u0026#39;API-5XX-Critical\u0026#39;, { alarmName: `EveryoneCook-${this.config.environment}-API-5XX-Critical`, alarmDescription: \u0026#39;API Gateway 5XX error rate \u0026gt; 5% trong 5 phút\u0026#39;, metric: new cloudwatch.Metric({ namespace: \u0026#39;AWS/ApiGateway\u0026#39;, metricName: \u0026#39;5XXError\u0026#39;, dimensionsMap: { ApiName: apiName }, statistic: \u0026#39;Sum\u0026#39;, period: cdk.Duration.minutes(5), }), threshold: 5, evaluationPeriods: 2, comparisonOperator: cloudwatch.ComparisonOperator.GREATER_THAN_THRESHOLD, treatMissingData: cloudwatch.TreatMissingData.NOT_BREACHING, }); api5xxAlarm.addAlarmAction(alarmAction); // API Gateway: High Latency (Warning) const apiLatencyAlarm = new cloudwatch.Alarm(this, \u0026#39;API-Latency-High\u0026#39;, { alarmName: `EveryoneCook-${this.config.environment}-API-Latency-High`, alarmDescription: \u0026#39;API Gateway P99 latency \u0026gt; 3s trong 5 phút\u0026#39;, metric: new cloudwatch.Metric({ namespace: \u0026#39;AWS/ApiGateway\u0026#39;, metricName: \u0026#39;Latency\u0026#39;, dimensionsMap: { ApiName: apiName }, statistic: \u0026#39;p99\u0026#39;, period: cdk.Duration.minutes(5), }), threshold: 3000, // 3 giây tính bằng milliseconds evaluationPeriods: 2, comparisonOperator: cloudwatch.ComparisonOperator.GREATER_THAN_THRESHOLD, }); 3. Lambda Alarms // Lambda: High Error Rate (Critical) const lambdaErrorAlarm = new cloudwatch.Alarm(this, \u0026#39;Lambda-Error-Rate\u0026#39;, { alarmName: `EveryoneCook-${this.config.environment}-Lambda-Error-Rate`, alarmDescription: \u0026#39;Lambda error rate \u0026gt; 5% trong 5 phút\u0026#39;, metric: new cloudwatch.Metric({ namespace: \u0026#39;AWS/Lambda\u0026#39;, metricName: \u0026#39;Errors\u0026#39;, statistic: \u0026#39;Sum\u0026#39;, period: cdk.Duration.minutes(5), }), threshold: 5, evaluationPeriods: 2, comparisonOperator: cloudwatch.ComparisonOperator.GREATER_THAN_THRESHOLD, }); // Lambda: Throttles (Critical) const lambdaThrottleAlarm = new cloudwatch.Alarm(this, \u0026#39;Lambda-Throttle\u0026#39;, { alarmName: `EveryoneCook-${this.config.environment}-Lambda-Throttle`, alarmDescription: \u0026#39;Lambda throttles \u0026gt; 10 trong 5 phút\u0026#39;, metric: new cloudwatch.Metric({ namespace: \u0026#39;AWS/Lambda\u0026#39;, metricName: \u0026#39;Throttles\u0026#39;, statistic: \u0026#39;Sum\u0026#39;, period: cdk.Duration.minutes(5), }), threshold: 10, evaluationPeriods: 1, }); 4. DynamoDB Alarms // DynamoDB: Read Throttles (Critical) const dynamoReadThrottleAlarm = new cloudwatch.Alarm(this, \u0026#39;DynamoDB-Read-Throttle\u0026#39;, { alarmName: `EveryoneCook-${this.config.environment}-DynamoDB-Read-Throttle`, alarmDescription: \u0026#39;DynamoDB read throttles \u0026gt; 10 trong 5 phút\u0026#39;, metric: new cloudwatch.Metric({ namespace: \u0026#39;AWS/DynamoDB\u0026#39;, metricName: \u0026#39;ReadThrottleEvents\u0026#39;, dimensionsMap: { TableName: dynamoTableName }, statistic: \u0026#39;Sum\u0026#39;, period: cdk.Duration.minutes(5), }), threshold: 10, evaluationPeriods: 2, }); // DynamoDB: High Latency (Warning) const dynamoLatencyAlarm = new cloudwatch.Alarm(this, \u0026#39;DynamoDB-Latency-High\u0026#39;, { alarmName: `EveryoneCook-${this.config.environment}-DynamoDB-Latency-High`, alarmDescription: \u0026#39;DynamoDB P99 latency \u0026gt; 100ms trong 5 phút\u0026#39;, metric: new cloudwatch.Metric({ namespace: \u0026#39;AWS/DynamoDB\u0026#39;, metricName: \u0026#39;SuccessfulRequestLatency\u0026#39;, dimensionsMap: { TableName: dynamoTableName, Operation: \u0026#39;Query\u0026#39;, }, statistic: \u0026#39;p99\u0026#39;, period: cdk.Duration.minutes(5), }), threshold: 100, // 100ms evaluationPeriods: 3, }); 5. Composite Alarm /** * Tạo Composite Alarm cho trạng thái sức khỏe tổng thể hệ thống * Task 7.4.2 - Step 2 */ private createCompositeAlarm(alarms: cloudwatch.IAlarm[]): cloudwatch.CompositeAlarm { // Lọc chỉ các critical alarms const criticalAlarms = alarms.filter( (alarm) =\u0026gt; alarm.alarmName.includes(\u0026#39;Critical\u0026#39;) || alarm.alarmName.includes(\u0026#39;Throttle\u0026#39;) ); const compositeAlarm = new cloudwatch.CompositeAlarm(this, \u0026#39;SystemHealth\u0026#39;, { compositeAlarmName: `EveryoneCook-${this.config.environment}-SystemHealth`, alarmDescription: \u0026#39;Trạng thái sức khỏe tổng thể hệ thống - kích hoạt nếu bất kỳ critical alarm nào fires\u0026#39;, alarmRule: cloudwatch.AlarmRule.anyOf( ...criticalAlarms.map((alarm) =\u0026gt; cloudwatch.AlarmRule.fromAlarm(alarm, cloudwatch.AlarmState.ALARM) ) ), }); compositeAlarm.addAlarmAction(new cloudwatch_actions.SnsAction(this.alarmTopic)); return compositeAlarm; } 6. Core Dashboard /** * Tạo Core Dashboard (DynamoDB, S3, CloudFront) */ private createCoreDashboard(props: ObservabilityStackProps): cloudwatch.Dashboard { const dashboard = new cloudwatch.Dashboard(this, \u0026#39;CoreDashboard\u0026#39;, { dashboardName: `EveryoneCook-${this.config.environment}-Core`, }); // DynamoDB Metrics dashboard.addWidgets( new cloudwatch.GraphWidget({ title: \u0026#39;DynamoDB - Read/Write Capacity\u0026#39;, left: [ new cloudwatch.Metric({ namespace: \u0026#39;AWS/DynamoDB\u0026#39;, metricName: \u0026#39;ConsumedReadCapacityUnits\u0026#39;, dimensionsMap: { TableName: dynamoTableName }, statistic: \u0026#39;Sum\u0026#39;, period: cdk.Duration.minutes(5), }), new cloudwatch.Metric({ namespace: \u0026#39;AWS/DynamoDB\u0026#39;, metricName: \u0026#39;ConsumedWriteCapacityUnits\u0026#39;, dimensionsMap: { TableName: dynamoTableName }, statistic: \u0026#39;Sum\u0026#39;, period: cdk.Duration.minutes(5), }), ], width: 12, }), new cloudwatch.GraphWidget({ title: \u0026#39;DynamoDB - Throttles\u0026#39;, left: [ new cloudwatch.Metric({ namespace: \u0026#39;AWS/DynamoDB\u0026#39;, metricName: \u0026#39;ReadThrottleEvents\u0026#39;, dimensionsMap: { TableName: dynamoTableName }, statistic: \u0026#39;Sum\u0026#39;, period: cdk.Duration.minutes(5), }), new cloudwatch.Metric({ namespace: \u0026#39;AWS/DynamoDB\u0026#39;, metricName: \u0026#39;WriteThrottleEvents\u0026#39;, dimensionsMap: { TableName: dynamoTableName }, statistic: \u0026#39;Sum\u0026#39;, period: cdk.Duration.minutes(5), }), ], width: 12, }) ); // S3 và CloudFront metrics... return dashboard; } 7. Overview Dashboard /** * Tạo Overview Dashboard (Aggregated view) */ private createOverviewDashboard(props: ObservabilityStackProps): cloudwatch.Dashboard { const dashboard = new cloudwatch.Dashboard(this, \u0026#39;OverviewDashboard\u0026#39;, { dashboardName: `EveryoneCook-${this.config.environment}-Overview`, }); // System Health Header dashboard.addWidgets( new cloudwatch.TextWidget({ markdown: `# Everyone Cook - System Overview\\n\\n**Environment:** ${this.config.environment}\\n\\n**Region:** ${this.region}`, width: 24, height: 2, }) ); // Key Metrics: API, Lambda, DynamoDB, S3 // Cost Tracking // Alarm Status Widget return dashboard; } Hướng dẫn Triển khai Điều kiện tiên quyết Trước khi triển khai Observability Stack, đảm bảo:\nTất cả các stack khác đã triển khai:\nDNS Stack (Phase 1) Certificate Stack (Phase 1.5) Core Stack (Phase 2) Auth Stack (Phase 3) Backend Stack (Phase 4) Frontend Stack (Phase 6 - Amplify) Stack exports có sẵn:\naws cloudformation list-exports --region ap-southeast-1 Expected exports:\nEveryoneCook-dev-Core-TableName EveryoneCook-dev-Core-ContentBucketName EveryoneCook-dev-Core-DistributionId EveryoneCook-dev-Auth-UserPoolId EveryoneCook-dev-Backend-ApiName Email đã cấu hình:\nEmail hợp lệ trong infrastructure/config/dev.ts Email sẽ nhận xác nhận subscription SNS Bước 1: Xem lại cấu hình File: infrastructure/config/dev.ts\nexport const devConfig: EnvironmentConfig = { environment: \u0026#39;dev\u0026#39;, region: \u0026#39;ap-southeast-1\u0026#39;, // Email cho alarm notifications contact: { email: \u0026#39;your-email@example.com\u0026#39;, // ⚠️ Cập nhật cái này phone: \u0026#39;+1234567890\u0026#39;, }, // Monitoring settings (đã cấu hình) monitoring: { enableDetailedMonitoring: true, retainLogs: true, logRetentionDays: 7, enableXRay: false, // Tắt cho dev để tiết kiệm chi phí }, }; ⚠️ Quan trọng: Cập nhật địa chỉ email để nhận thông báo alarm.\nBước 2: Synthesize CloudFormation Template Di chuyển đến thư mục infrastructure:\ncd D:\\Project_AWS\\everyonecook\\infrastructure Synthesize Observability Stack:\nnpm run synth Kết quả mong đợi (1175 dòng):\n✨ Synthesis time: 3.5s\rResources:\r[+] AWS::SNS::Topic AlarmTopic\r[+] AWS::SNS::Subscription AlarmTopic/EmailSubscription\r[+] AWS::CloudWatch::Alarm API-5XX-Critical\r[+] AWS::CloudWatch::Alarm API-4XX-Warning\r[+] AWS::CloudWatch::Alarm API-Latency-High\r[+] AWS::CloudWatch::Alarm Lambda-Error-Rate\r[+] AWS::CloudWatch::Alarm Lambda-Throttle\r[+] AWS::CloudWatch::Alarm Lambda-Duration-High\r[+] AWS::CloudWatch::Alarm DynamoDB-Read-Throttle\r[+] AWS::CloudWatch::Alarm DynamoDB-Write-Throttle\r[+] AWS::CloudWatch::Alarm DynamoDB-Latency-High\r[+] AWS::CloudWatch::Alarm S3-4XX-Warning\r[+] AWS::CloudWatch::Alarm S3-5XX-Critical\r[+] AWS::CloudWatch::Alarm SQS-DLQ-Messages\r[+] AWS::CloudWatch::Alarm SQS-Queue-Age\r[+] AWS::CloudWatch::Alarm Cost-Warning\r[+] AWS::CloudWatch::Alarm Cost-Critical\r[+] AWS::CloudWatch::CompositeAlarm SystemHealth\r[+] AWS::CloudWatch::Dashboard CoreDashboard\r[+] AWS::CloudWatch::Dashboard AuthDashboard\r[+] AWS::CloudWatch::Dashboard BackendDashboard\r[+] AWS::CloudWatch::Dashboard OverviewDashboard\rOutputs:\r- AlarmTopicArn\r- CompositeAlarmName\r- CoreDashboardName\r- AuthDashboardName\r- BackendDashboardName\r- OverviewDashboardName Screenshot: CDK synth output hiển thị tất cả tài nguyên Observability Stack\nBước 3: Xem lại Generated Template Mở CloudFormation template đã tạo:\ncode infrastructure/cdk.out/EveryoneCook-dev-Observability.template.json Screenshot: Generated CloudFormation template hiển thị SNS Topic, 15+ Alarms, Composite Alarm và 4 Dashboards\nBước 4: Deploy Observability Stack Deploy sử dụng CDK:\nnpx cdk deploy EveryoneCook-dev-Observability --require-approval never Thời gian triển khai dự kiến: 2-3 phút\nKết quả Deployment:\nEveryoneCook-dev-Observability: deploying...\rEveryoneCook-dev-Observability: creating CloudFormation changeset...\rEveryoneCook-dev-Observability\rOutputs:\rEveryoneCook-dev-Observability.AlarmTopicArn = arn:aws:sns:ap-southeast-1:123456789012:EveryoneCook-dev-Alarms\rEveryoneCook-dev-Observability.CompositeAlarmName = EveryoneCook-dev-SystemHealth\rEveryoneCook-dev-Observability.CoreDashboardName = EveryoneCook-dev-Core\rEveryoneCook-dev-Observability.AuthDashboardName = EveryoneCook-dev-Auth\rEveryoneCook-dev-Observability.BackendDashboardName = EveryoneCook-dev-Backend\rEveryoneCook-dev-Observability.OverviewDashboardName = EveryoneCook-dev-Overview\rStack ARN:\rarn:aws:cloudformation:ap-southeast-1:123456789012:stack/EveryoneCook-dev-Observability/...\r✨ Deployment time: 2m 15s Xác minh Bước 1: Xác minh CloudFormation Stack Điều hướng đến CloudFormation Console:\nAWS Console → CloudFormation → Stacks Xác minh Stack:\nStack Name: EveryoneCook-dev-Observability Status: CREATE_COMPLETE ✅ Resources: 24 resources đã tạo Screenshot: CloudFormation stack với trạng thái CREATE_COMPLETE và 24 resources\nScreenshot: CloudFormation Outputs tab hiển thị tất cả 6 outputs\nBước 2: Xác minh CloudWatch Alarms Điều hướng đến CloudWatch Console → Alarms:\nAWS Console → CloudWatch → All alarms Xác minh Alarms đã tạo (15+ alarms):\nTên Alarm Loại Metric Ngưỡng Trạng thái EveryoneCook-dev-API-5XX-Critical Critical API 5XX Errors \u0026gt; 5 OK EveryoneCook-dev-API-4XX-Warning Warning API 4XX Errors \u0026gt; 20 OK EveryoneCook-dev-API-Latency-High Warning API P99 Latency \u0026gt; 3000ms OK EveryoneCook-dev-Lambda-Error-Rate Critical Lambda Errors \u0026gt; 5 OK EveryoneCook-dev-Lambda-Throttle Critical Lambda Throttles \u0026gt; 10 OK EveryoneCook-dev-Lambda-Duration-High Warning Lambda P99 Duration \u0026gt; 10000ms OK EveryoneCook-dev-DynamoDB-Read-Throttle Critical DynamoDB Read Throttles \u0026gt; 10 OK EveryoneCook-dev-DynamoDB-Write-Throttle Critical DynamoDB Write Throttles \u0026gt; 10 OK EveryoneCook-dev-DynamoDB-Latency-High Warning DynamoDB P99 Latency \u0026gt; 100ms OK EveryoneCook-dev-S3-4XX-Warning Warning S3 4XX Errors \u0026gt; 5% OK EveryoneCook-dev-S3-5XX-Critical Critical S3 5XX Errors \u0026gt; 0 OK EveryoneCook-dev-SQS-DLQ-Messages Critical SQS DLQ Messages \u0026gt; 0 OK EveryoneCook-dev-SQS-Queue-Age Warning SQS Message Age \u0026gt; 300s OK EveryoneCook-dev-Cost-Warning Warning Daily Cost \u0026gt; $50 OK EveryoneCook-dev-Cost-Critical Critical Daily Cost \u0026gt; $100 OK Xác minh Composite Alarm:\nName: EveryoneCook-dev-SystemHealth Type: Composite Rule: BẤT KỲ critical alarm nào → ALARM Status: OK ✅ Screenshot: CloudWatch Alarms console hiển thị tất cả 15+ alarms với trạng thái OK\nScreenshot: Chi tiết Composite alarm cho giám sát trạng thái sức khỏe hệ thống\nBước 3: Xác minh CloudWatch Dashboards Điều hướng đến CloudWatch Console → Dashboards:\nAWS Console → CloudWatch → Dashboards Xác minh Dashboards đã tạo (5 dashboards):\n1. Core Dashboard (EveryoneCook-dev-Core) Mở dashboard và xác minh các widgets:\nDynamoDB Widgets:\nBiểu đồ Read/Write Capacity Biểu đồ Throttles Biểu đồ Latency (P99) Metric Table Size S3 Widgets:\nBiểu đồ Requests Biểu đồ Errors (4XX/5XX) CloudFront Widgets:\nBiểu đồ Requests Biểu đồ Error Rate (4XX/5XX) Biểu đồ Bytes Downloaded Screenshot: Core Dashboard hiển thị DynamoDB, S3 và CloudFront metrics\n2. Auth Dashboard (EveryoneCook-dev-Auth) Cognito Widgets:\nBiểu đồ Sign-ups Biểu đồ Sign-ins Biểu đồ Failed Authentications Screenshot: Auth Dashboard hiển thị Cognito authentication metrics\n3. Backend Dashboard (EveryoneCook-dev-Backend) API Gateway Widgets:\nBiểu đồ Requests Biểu đồ Latency (P50/P95/P99) Biểu đồ 4XX Errors Biểu đồ 5XX Errors Lambda Widgets:\nBiểu đồ Invocations Biểu đồ Duration (P99) Biểu đồ Errors Biểu đồ Throttles SQS Widgets:\nBiểu đồ Messages Sent Biểu đồ Messages Visible Biểu đồ Oldest Message Age Screenshot: Backend Dashboard hiển thị API Gateway, Lambda và SQS metrics\n4. Overview Dashboard (EveryoneCook-dev-Overview) Phần System Health:\nHeader với thông tin environment Thông tin Region Key Metrics:\nAPI Requests (5m) - Single value widget API P99 Latency - Single value widget Lambda Invocations (5m) - Single value widget Lambda Errors (5m) - Single value widget DynamoDB Read/Write Throttles - Single value widgets S3 Requests và Errors - Single value widgets Trends:\nBiểu đồ Error Rates (API 5XX, Lambda Errors) Cost Tracking:\nEstimated Daily Cost - Single value widget Cost Trend (7 ngày) - Graph widget Alarm Status:\nComposite Alarm widget hiển thị trạng thái sức khỏe hệ thống Screenshot: Overview Dashboard với system health, key metrics, error trends và cost tracking\nPhân tích Chi phí Chi phí hàng tháng (Development) Dịch vụ Tài nguyên Số lượng Đơn giá Tổng CloudWatch Alarms Standard alarms 15 $0.10/alarm $1.50 CloudWatch Alarms Composite alarm 1 $0.50/alarm $0.50 CloudWatch Dashboards Dashboards (\u0026gt;3) 1 $3.00/dashboard $3.00 CloudWatch Metrics Standard resolution Bao gồm Miễn phí $0.00 SNS Email notifications \u0026lt;1000 Free tier $0.00 CloudWatch Logs 7-day retention ~5 GB $0.50/GB $2.50 Tổng cộng $7.50/tháng Lợi ích Free Tier:\n3 dashboard đầu tiên: Miễn phí 10 alarm đầu tiên: Miễn phí (đã bao gồm) 1 triệu API request đầu tiên tới CloudWatch: Miễn phí SNS email (1000 đầu tiên): Miễn phí Các bước tiếp theo Sau khi triển khai Observability Stack:\nXác nhận Email Subscription: Kiểm tra inbox và xác nhận SNS subscription\nXem lại Dashboards: Làm quen với tất cả 4 dashboards\nKiểm tra Alarms: Kích hoạt test alarm để xác minh thông báo\nGiám sát Chi phí: Kiểm tra theo dõi chi phí hàng ngày trong Overview Dashboard\n⏭️ Deploy Frontend: Tiếp tục đến 5.10 Deploy to Amplify\n⏭️ Test End-to-End: Kiểm tra luồng ứng dụng hoàn chỉnh và giám sát metrics\n📊 Xem lại Metrics: Sau 24 giờ, xem lại tất cả dashboards để có baseline metrics\nTóm tắt Bạn đã triển khai thành công Observability Stack với:\n1 SNS Topic cho thông báo alarm\n15+ CloudWatch Alarms cho các metric quan trọng\n1 Composite Alarm cho trạng thái sức khỏe tổng thể hệ thống\n4 CloudWatch Dashboards cho giám sát\nEmail Notifications đã cấu hình và xác nhận\nThành tựu chính:\nTầm nhìn hoàn chỉnh về trạng thái sức khỏe hệ thống Cảnh báo chủ động cho các vấn đề nghiêm trọng Theo dõi và tối ưu chi phí Dashboards giám sát tập trung Tổng tài nguyên: 24 CloudFormation resources\nThời gian triển khai: ~2-3 phút\nChi phí hàng tháng: ~$7.50 (môi trường dev)\n🎉 Chúc mừng! Bạn đã hoàn thành tất cả các triển khai infrastructure stack. Nền tảng EveryoneCook của bạn giờ đây có giám sát và observability toàn diện.\nTiếp theo: 5.10 Deploy to Amplify để triển khai ứng dụng Next.js frontend.\n"
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/5-workshop/5.08-test-endpoints/",
	"title": "Kiểm Tra Endpoints Toàn Diện",
	"tags": [],
	"description": "",
	"content": "Tổng quan Sau khi deploy backend thành công, bạn cần test tất cả API endpoints để đảm bảo hệ thống hoạt động đúng từ đầu đến cuối. Workshop này hướng dẫn chi tiết cách test từng module của hệ thống EveryoneCook.\nKiến trúc API Dự án EveryoneCook sử dụng API Router Pattern với các thành phần:\nAPI Gateway: REST API với custom domain api-dev.everyonecook.cloud API Router Lambda: Routing requests tới các module Lambda 5 Module Lambda: auth-user-lambda: Authentication \u0026amp; User Management social-lambda: Posts, Comments, Reactions, Friends, Notifications recipe-ai-lambda: Recipes \u0026amp; AI Features admin-lambda: Admin Dashboard \u0026amp; Content Moderation upload-lambda: File Upload với S3 Presigned URLs 4 SQS Queues: Async processing (AI, Image, Analytics, Notifications) WAF: Web Application Firewall bảo vệ API Luồng Test 1. Lấy API Endpoint\r2. Test Health Check (Public)\r3. Test User Registration \u0026amp; Verification\r4. Test User Login \u0026amp; Get JWT Token\r5. Test Profile Management\r6. Test Social Features (Posts, Friends, Notifications)\r7. Test Recipe Management\r8. Test AI Features (Recipe Generation, Translation)\r9. Test File Upload (S3 + CloudFront)\r10. Test Admin Features (nếu có quyền admin) Bước 1: Lấy API Endpoint 1. Lấy API URL từ CloudFormation Outputs\n# Get API endpoint từ Backend Stack $API_ENDPOINT = aws cloudformation describe-stacks ` --stack-name EveryoneCook-dev-Backend ` --query \u0026#39;Stacks[0].Outputs[?OutputKey==`ApiCustomDomain`].OutputValue\u0026#39; ` --output text Write-Host \u0026#34;API Endpoint: $API_ENDPOINT\u0026#34; # Output: https://api-dev.everyonecook.cloud 2. Hoặc lấy từ file outputs.json\n# Đọc từ infrastructure/outputs.json cd D:\\Project_AWS\\everyonecook\\infrastructure $outputs = Get-Content outputs.json | ConvertFrom-Json $API_ENDPOINT = $outputs.\u0026#39;EveryoneCook-dev-Backend\u0026#39;.ApiCustomDomain Write-Host \u0026#34;API Endpoint: $API_ENDPOINT\u0026#34; 3. Setup biến môi trường\n# Set API endpoint cho PowerShell session $API_ENDPOINT = \u0026#34;https://api-dev.everyonecook.cloud\u0026#34; $HEADERS_JSON = @{\u0026#34;Content-Type\u0026#34;=\u0026#34;application/json\u0026#34;} Write-Host \u0026#34;Environment configured:\u0026#34; Write-Host \u0026#34; API Endpoint: $API_ENDPOINT\u0026#34; Bước 2: Test Health Check (Public) Health check endpoint không cần authentication.\n1. Test với PowerShell\n# Test health endpoint $response = Invoke-RestMethod -Uri \u0026#34;$API_ENDPOINT/health\u0026#34; -Method Get $response | ConvertTo-Json # Expected Output: # { # \u0026#34;status\u0026#34;: \u0026#34;healthy\u0026#34;, # \u0026#34;timestamp\u0026#34;: \u0026#34;2025-12-09T10:30:00.000Z\u0026#34;, # \u0026#34;service\u0026#34;: \u0026#34;EveryoneCook API\u0026#34;, # \u0026#34;environment\u0026#34;: \u0026#34;dev\u0026#34; # } 2. Test với curl (nếu có WSL hoặc Git Bash)\ncurl -X GET \u0026#34;$API_ENDPOINT/health\u0026#34; | jq 3. Verify API Router hoạt động\n# Check API Router Lambda logs aws logs tail /aws/lambda/everyonecook-dev-api-router --follow ✅ Kết quả mong đợi: Status 200, response JSON có \u0026quot;status\u0026quot;: \u0026quot;healthy\u0026quot;\nBước 3: Test User Registration 1. Lấy User Pool Client ID\n# Get Cognito User Pool Client ID $CLIENT_ID = aws cloudformation describe-stacks ` --stack-name EveryoneCook-dev-Auth ` --query \u0026#39;Stacks[0].Outputs[?OutputKey==`UserPoolClientId`].OutputValue\u0026#39; ` --output text Write-Host \u0026#34;User Pool Client ID: $CLIENT_ID\u0026#34; 2. Register User mới\n# Đăng ký user với Cognito (không qua API - trực tiếp với Cognito) $username = \u0026#34;testuser_$(Get-Random -Maximum 9999)\u0026#34; $email = \u0026#34;test_$username@example.com\u0026#34; $password = \u0026#34;TestPassword123!\u0026#34; aws cognito-idp sign-up ` --client-id $CLIENT_ID ` --username $username ` --password $password ` --user-attributes ` Name=email,Value=$email ` Name=given_name,Value=\u0026#34;Test User\u0026#34; Write-Host \u0026#34;User registered: $username\u0026#34; Write-Host \u0026#34;Email: $email\u0026#34; Write-Host \u0026#34;Password: $password\u0026#34; 3. Verify Pre-Signup Trigger (Lambda Cognito Trigger)\n# Check logs của Pre-Signup trigger aws logs tail /aws/lambda/EveryoneCook-dev-PreSignup --since 5m ✅ Kết quả mong đợi:\nCognito trả về success message Pre-Signup trigger logs không có error Bước 4: Verify Email \u0026amp; Confirm User 1. Lấy Confirmation Code\n# Trong môi trường dev, có thể lấy code từ email hoặc dùng admin command # Cách 1: Check email (nếu dùng real email) # Cách 2: Admin confirm (cho testing) aws cognito-idp admin-confirm-sign-up ` --user-pool-id ap-southeast-1_PKoL34PF0 ` --username $username Write-Host \u0026#34;User confirmed: $username\u0026#34; 2. Verify Post-Confirmation Trigger\nPost-Confirmation trigger sẽ tự động tạo user profile trong DynamoDB.\n# Check DynamoDB - User profile được tạo tự động aws dynamodb get-item ` --table-name EveryoneCook-dev ` --key \u0026#34;{\\\u0026#34;PK\\\u0026#34;:{\\\u0026#34;S\\\u0026#34;:\\\u0026#34;USER#$username\\\u0026#34;},\\\u0026#34;SK\\\u0026#34;:{\\\u0026#34;S\\\u0026#34;:\\\u0026#34;PROFILE\\\u0026#34;}}\u0026#34; # Expected: User profile với các fields: # - userId (Cognito sub ID) # - email # - fullName # - createdAt # - updatedAt 3. Check Post-Confirmation Lambda logs\naws logs tail /aws/lambda/EveryoneCook-dev-PostConfirmation --since 5m ✅ Kết quả mong đợi: User profile được tạo trong DynamoDB table\nBước 5: Test User Login \u0026amp; Get JWT Token 1. Login để lấy JWT tokens\n# Sign in với Cognito $authResult = aws cognito-idp initiate-auth ` --client-id $CLIENT_ID ` --auth-flow USER_PASSWORD_AUTH ` --auth-parameters USERNAME=$username,PASSWORD=$password ` | ConvertFrom-Json # Extract tokens $ID_TOKEN = $authResult.AuthenticationResult.IdToken $ACCESS_TOKEN = $authResult.AuthenticationResult.AccessToken $REFRESH_TOKEN = $authResult.AuthenticationResult.RefreshToken Write-Host \u0026#34;Login successful!\u0026#34; Write-Host \u0026#34;ID Token length: $($ID_TOKEN.Length)\u0026#34; 2. Verify Post-Authentication Trigger\nPost-Authentication trigger update lastLoginAt trong DynamoDB.\n# Check lastLoginAt updated aws dynamodb get-item ` --table-name EveryoneCook-dev ` --key \u0026#34;{\\\u0026#34;PK\\\u0026#34;:{\\\u0026#34;S\\\u0026#34;:\\\u0026#34;USER#$username\\\u0026#34;},\\\u0026#34;SK\\\u0026#34;:{\\\u0026#34;S\\\u0026#34;:\\\u0026#34;PROFILE\\\u0026#34;}}\u0026#34; ` --projection-expression \u0026#34;lastLoginAt\u0026#34; 3. Setup Authorization Header\n# Create headers with JWT token $HEADERS_AUTH = @{ \u0026#34;Content-Type\u0026#34; = \u0026#34;application/json\u0026#34; \u0026#34;Authorization\u0026#34; = \u0026#34;Bearer $ID_TOKEN\u0026#34; } ✅ Kết quả mong đợi: Login thành công, nhận được JWT tokens\nBước 6: Test Profile Management Endpoint: /users/me, /users/profile\n1. Get Current User Profile\n# GET /users/me $response = Invoke-RestMethod ` -Uri \u0026#34;$API_ENDPOINT/users/me\u0026#34; ` -Method Get ` -Headers $HEADERS_AUTH $response | ConvertTo-Json -Depth 5 # Expected Response: # { # \u0026#34;userId\u0026#34;: \u0026#34;...\u0026#34;, # \u0026#34;username\u0026#34;: \u0026#34;testuser_1234\u0026#34;, # \u0026#34;email\u0026#34;: \u0026#34;test_testuser_1234@example.com\u0026#34;, # \u0026#34;fullName\u0026#34;: \u0026#34;Test User\u0026#34;, # \u0026#34;birthday\u0026#34;: null, # \u0026#34;gender\u0026#34;: null, # \u0026#34;country\u0026#34;: null, # \u0026#34;createdAt\u0026#34;: \u0026#34;2025-12-09T10:30:00.000Z\u0026#34;, # \u0026#34;lastLoginAt\u0026#34;: \u0026#34;2025-12-09T11:00:00.000Z\u0026#34; # } 2. Update Profile (Onboarding)\n# PUT /users/profile - Complete onboarding $profileUpdate = @{ birthday = \u0026#34;1990-01-01\u0026#34; gender = \u0026#34;male\u0026#34; country = \u0026#34;Vietnam\u0026#34; bio = \u0026#34;Test user for EveryoneCook platform\u0026#34; } | ConvertTo-Json $response = Invoke-RestMethod ` -Uri \u0026#34;$API_ENDPOINT/users/profile\u0026#34; ` -Method Put ` -Headers $HEADERS_AUTH ` -Body $profileUpdate $response | ConvertTo-Json 3. Get Privacy Settings\n# GET /users/profile/privacy $privacy = Invoke-RestMethod ` -Uri \u0026#34;$API_ENDPOINT/users/profile/privacy\u0026#34; ` -Method Get ` -Headers $HEADERS_AUTH $privacy | ConvertTo-Json 4. Update Privacy Settings\n# PUT /users/profile/privacy $privacyUpdate = @{ profileVisibility = \u0026#34;public\u0026#34; showEmail = $false showBirthday = $false allowFriendRequests = $true } | ConvertTo-Json Invoke-RestMethod ` -Uri \u0026#34;$API_ENDPOINT/users/profile/privacy\u0026#34; ` -Method Put ` -Headers $HEADERS_AUTH ` -Body $privacyUpdate ✅ Kết quả mong đợi: Profile được update thành công trong DynamoDB\nBước 7: Test Social Features - Posts Endpoints: /posts, /posts/{postId}\n1. Create Post\n# POST /posts $newPost = @{ content = \u0026#34;My first post on EveryoneCook! Testing the platform 🍳\u0026#34; visibility = \u0026#34;public\u0026#34; type = \u0026#34;text\u0026#34; } | ConvertTo-Json $postResponse = Invoke-RestMethod ` -Uri \u0026#34;$API_ENDPOINT/posts\u0026#34; ` -Method Post ` -Headers $HEADERS_AUTH ` -Body $newPost $POST_ID = $postResponse.postId Write-Host \u0026#34;Created Post ID: $POST_ID\u0026#34; $postResponse | ConvertTo-Json 2. Get All Posts (Feed)\n# GET /posts - Get all posts $posts = Invoke-RestMethod ` -Uri \u0026#34;$API_ENDPOINT/posts?limit=10\u0026#34; ` -Method Get ` -Headers $HEADERS_AUTH Write-Host \u0026#34;Found $($posts.items.Count) posts\u0026#34; $posts.items | ConvertTo-Json -Depth 3 3. Get Specific Post\n# GET /posts/{postId} $post = Invoke-RestMethod ` -Uri \u0026#34;$API_ENDPOINT/posts/$POST_ID\u0026#34; ` -Method Get ` -Headers $HEADERS_AUTH $post | ConvertTo-Json 4. Like Post\n# POST /posts/{postId}/like Invoke-RestMethod ` -Uri \u0026#34;$API_ENDPOINT/posts/$POST_ID/like\u0026#34; ` -Method Post ` -Headers $HEADERS_AUTH Write-Host \u0026#34;Post liked successfully\u0026#34; 5. Add Comment\n# POST /posts/{postId}/comments $comment = @{ content = \u0026#34;Great post! 👍\u0026#34; } | ConvertTo-Json $commentResponse = Invoke-RestMethod ` -Uri \u0026#34;$API_ENDPOINT/posts/$POST_ID/comments\u0026#34; ` -Method Post ` -Headers $HEADERS_AUTH ` -Body $comment $COMMENT_ID = $commentResponse.commentId Write-Host \u0026#34;Comment ID: $COMMENT_ID\u0026#34; 6. Get Post Comments\n# GET /posts/{postId}/comments $comments = Invoke-RestMethod ` -Uri \u0026#34;$API_ENDPOINT/posts/$POST_ID/comments\u0026#34; ` -Method Get ` -Headers $HEADERS_AUTH $comments | ConvertTo-Json -Depth 3 ✅ Kết quả mong đợi: Posts, likes, comments được lưu trong DynamoDB\nBước 8: Test Social Features - Friends Endpoints: /friends/*\n1. Search Users\n# GET /users/search?q=test $users = Invoke-RestMethod ` -Uri \u0026#34;$API_ENDPOINT/users/search?q=test\u0026amp;limit=10\u0026#34; ` -Method Get ` -Headers $HEADERS_AUTH $users | ConvertTo-Json 2. Send Friend Request (cần 2 users)\n# POST /friends/{userId}/request # Giả sử có USER_ID của user khác $TARGET_USER_ID = \u0026#34;another-user-id\u0026#34; Invoke-RestMethod ` -Uri \u0026#34;$API_ENDPOINT/friends/$TARGET_USER_ID/request\u0026#34; ` -Method Post ` -Headers $HEADERS_AUTH Write-Host \u0026#34;Friend request sent\u0026#34; 3. Get Friend Requests\n# GET /friends/requests $requests = Invoke-RestMethod ` -Uri \u0026#34;$API_ENDPOINT/friends/requests\u0026#34; ` -Method Get ` -Headers $HEADERS_AUTH $requests | ConvertTo-Json ✅ Kết quả mong đợi: Friend requests được tạo với status \u0026ldquo;pending\u0026rdquo;\nBước 9: Test Recipe Management Endpoints: /recipes, /recipes/{recipeId}\n1. Create Recipe\n# POST /recipes $newRecipe = @{ title = \u0026#34;Phở Bò Hà Nội\u0026#34; description = \u0026#34;Traditional Vietnamese beef noodle soup\u0026#34; ingredients = @( @{ name = \u0026#34;beef bones\u0026#34;; amount = \u0026#34;2\u0026#34;; unit = \u0026#34;kg\u0026#34; } @{ name = \u0026#34;rice noodles\u0026#34;; amount = \u0026#34;500\u0026#34;; unit = \u0026#34;g\u0026#34; } @{ name = \u0026#34;ginger\u0026#34;; amount = \u0026#34;1\u0026#34;; unit = \u0026#34;piece\u0026#34; } @{ name = \u0026#34;star anise\u0026#34;; amount = \u0026#34;3\u0026#34;; unit = \u0026#34;pieces\u0026#34; } ) instructions = @( \u0026#34;Boil beef bones for 2-3 hours to make broth\u0026#34; \u0026#34;Add spices (ginger, star anise, cinnamon) and simmer\u0026#34; \u0026#34;Prepare rice noodles separately\u0026#34; \u0026#34;Serve noodles with broth and garnish with herbs\u0026#34; ) cuisine = \u0026#34;Vietnamese\u0026#34; difficulty = \u0026#34;medium\u0026#34; prepTime = 30 cookTime = 180 servings = 4 } | ConvertTo-Json -Depth 5 $recipeResponse = Invoke-RestMethod ` -Uri \u0026#34;$API_ENDPOINT/recipes\u0026#34; ` -Method Post ` -Headers $HEADERS_AUTH ` -Body $newRecipe $RECIPE_ID = $recipeResponse.recipeId Write-Host \u0026#34;Created Recipe ID: $RECIPE_ID\u0026#34; $recipeResponse | ConvertTo-Json -Depth 5 2. Get User\u0026rsquo;s Recipes\n# GET /users/{userId}/recipes $userId = $authResult.AuthenticationResult.AccessToken | ForEach-Object { [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String(($_.Split(\u0026#39;.\u0026#39;)[1]))) } | ConvertFrom-Json | Select-Object -ExpandProperty sub $recipes = Invoke-RestMethod ` -Uri \u0026#34;$API_ENDPOINT/users/$userId/recipes\u0026#34; ` -Method Get ` -Headers $HEADERS_AUTH $recipes | ConvertTo-Json -Depth 3 3. Search Recipes\n# POST /recipes/search $searchQuery = @{ query = \u0026#34;phở\u0026#34; filters = @{ cuisine = \u0026#34;Vietnamese\u0026#34; difficulty = \u0026#34;medium\u0026#34; } limit = 10 } | ConvertTo-Json $searchResults = Invoke-RestMethod ` -Uri \u0026#34;$API_ENDPOINT/recipes/search\u0026#34; ` -Method Post ` -Headers $HEADERS_AUTH ` -Body $searchQuery $searchResults | ConvertTo-Json -Depth 3 ✅ Kết quả mong đợi: Recipes được lưu trong DynamoDB với proper structure\nBước 10: Test AI Features (Bedrock) Endpoints: /recipes/generate-ai, /ai/nutrition, /dictionary/{ingredient}\n1. Generate Recipe with AI\n# POST /recipes/generate-ai $aiRequest = @{ ingredients = @(\u0026#34;chicken\u0026#34;, \u0026#34;rice\u0026#34;, \u0026#34;vegetables\u0026#34;, \u0026#34;fish sauce\u0026#34;) cuisine = \u0026#34;Vietnamese\u0026#34; dietaryRestrictions = @(\u0026#34;gluten-free\u0026#34;) servings = 4 difficulty = \u0026#34;medium\u0026#34; } | ConvertTo-Json Write-Host \u0026#34;Generating recipe with AI... (this takes 5-10 seconds)\u0026#34; $aiRecipe = Invoke-RestMethod ` -Uri \u0026#34;$API_ENDPOINT/recipes/generate-ai\u0026#34; ` -Method Post ` -Headers $HEADERS_AUTH ` -Body $aiRequest $aiRecipe | ConvertTo-Json -Depth 5 # Expected: AI-generated recipe with Vietnamese ingredient names # Uses Amazon Bedrock Claude model 2. Get Nutrition Analysis\n# POST /ai/nutrition $nutritionRequest = @{ ingredients = @( @{ name = \u0026#34;chicken breast\u0026#34;; amount = \u0026#34;200\u0026#34;; unit = \u0026#34;g\u0026#34; } @{ name = \u0026#34;rice\u0026#34;; amount = \u0026#34;100\u0026#34;; unit = \u0026#34;g\u0026#34; } ) } | ConvertTo-Json $nutrition = Invoke-RestMethod ` -Uri \u0026#34;$API_ENDPOINT/ai/nutrition\u0026#34; ` -Method Post ` -Headers $HEADERS_AUTH ` -Body $nutritionRequest $nutrition | ConvertTo-Json 3. Translate Ingredient (Vietnamese Dictionary)\n# GET /dictionary/{ingredient} $translation = Invoke-RestMethod ` -Uri \u0026#34;$API_ENDPOINT/dictionary/tomato\u0026#34; ` -Method Get ` -Headers $HEADERS_AUTH Write-Host \u0026#34;Translation: $($translation.vietnamese)\u0026#34; # Expected: { \u0026#34;ingredient\u0026#34;: \u0026#34;tomato\u0026#34;, \u0026#34;vietnamese\u0026#34;: \u0026#34;cà chua\u0026#34; } ✅ Kết quả mong đợi:\nAI recipe generation mất 5-10 giây Response có Vietnamese ingredient names Bedrock Lambda được invoke Bước 11: Test File Upload (S3 + CloudFront) Endpoint: /upload/presigned-url\n1. Request Presigned URL\n# POST /upload/presigned-url $uploadRequest = @{ fileType = \u0026#34;avatar\u0026#34; fileName = \u0026#34;test-avatar.jpg\u0026#34; contentType = \u0026#34;image/jpeg\u0026#34; fileSize = 1024000 # 1MB } | ConvertTo-Json $uploadResponse = Invoke-RestMethod ` -Uri \u0026#34;$API_ENDPOINT/upload/presigned-url\u0026#34; ` -Method Post ` -Headers $HEADERS_AUTH ` -Body $uploadRequest $PRESIGNED_URL = $uploadResponse.url $UPLOAD_KEY = $uploadResponse.key Write-Host \u0026#34;Presigned URL: $PRESIGNED_URL\u0026#34; Write-Host \u0026#34;Upload Key: $UPLOAD_KEY\u0026#34; 2. Upload File to S3\n# Create test image file $testImage = \u0026#34;D:\\test-avatar.jpg\u0026#34; # (Tạo file test image hoặc dùng file có sẵn) # Upload file using presigned URL Invoke-RestMethod ` -Uri $PRESIGNED_URL ` -Method Put ` -InFile $testImage ` -ContentType \u0026#34;image/jpeg\u0026#34; Write-Host \u0026#34;File uploaded to S3 successfully\u0026#34; 3. Access via CloudFront CDN\n# Get CloudFront distribution domain $CDN_DOMAIN = \u0026#34;d2shrpzup69rju.cloudfront.net\u0026#34; # Từ outputs.json # Access file via CloudFront $fileUrl = \u0026#34;https://$CDN_DOMAIN/$UPLOAD_KEY\u0026#34; Invoke-WebRequest -Uri $fileUrl -Method Head # Check caching headers # First request: X-Cache: Miss from cloudfront # Second request: X-Cache: Hit from cloudfront ✅ Kết quả mong đợi: File được upload lên S3 và serve qua CloudFront\nBước 12: Test Admin Features (Requires Admin Role) Endpoints: /admin/*\n1. Get System Stats\n# GET /admin/stats $stats = Invoke-RestMethod ` -Uri \u0026#34;$API_ENDPOINT/admin/stats\u0026#34; ` -Method Get ` -Headers $HEADERS_AUTH $stats | ConvertTo-Json # Expected (nếu có admin role): # { # \u0026#34;totalUsers\u0026#34;: 123, # \u0026#34;totalPosts\u0026#34;: 456, # \u0026#34;totalRecipes\u0026#34;: 789, # \u0026#34;activeUsers\u0026#34;: 45 # } 2. Get All Users\n# GET /admin/users $allUsers = Invoke-RestMethod ` -Uri \u0026#34;$API_ENDPOINT/admin/users?limit=20\u0026#34; ` -Method Get ` -Headers $HEADERS_AUTH $allUsers | ConvertTo-Json 3. Get Reported Posts\n# GET /admin/posts/reported $reportedPosts = Invoke-RestMethod ` -Uri \u0026#34;$API_ENDPOINT/admin/posts/reported\u0026#34; ` -Method Get ` -Headers $HEADERS_AUTH $reportedPosts | ConvertTo-Json ⚠️ Lưu ý: Admin endpoints require user có group \u0026ldquo;Admins\u0026rdquo; trong Cognito User Pool\nBước 13: Verify Async Processing (SQS Queues) 1. Check SQS Queues\n# List all queues aws sqs list-queues --queue-name-prefix everyonecook-dev # Get AI Queue attributes $AI_QUEUE_URL = \u0026#34;https://sqs.ap-southeast-1.amazonaws.com/616580903213/everyonecook-dev-ai-queue\u0026#34; aws sqs get-queue-attributes ` --queue-url $AI_QUEUE_URL ` --attribute-names ApproximateNumberOfMessages,ApproximateNumberOfMessagesNotVisible 2. Monitor Worker Lambdas\n# Check Image Processing Worker logs aws logs tail /aws/lambda/everyonecook-dev-image-worker --follow # Check AI Worker logs (for recipe generation) aws logs tail /aws/lambda/everyonecook-dev-ai-worker --follow ✅ Kết quả mong đợi: Messages được process bởi worker Lambdas\nTesting Checklist Sử dụng checklist này để track progress:\nPublic Endpoints GET /health - Health check responds GET /status - Status check responds Authentication \u0026amp; User Management User registration với Cognito works Email verification/confirmation works User login successful, nhận JWT tokens GET /users/me - Get current user profile PUT /users/profile - Update profile GET /users/profile/privacy - Get privacy settings PUT /users/profile/privacy - Update privacy settings Social Features POST /posts - Create post GET /posts - Get posts feed GET /posts/{postId} - Get specific post POST /posts/{postId}/like - Like post POST /posts/{postId}/comments - Add comment GET /posts/{postId}/comments - Get comments POST /friends/{userId}/request - Send friend request GET /friends/requests - Get friend requests GET /notifications - Get notifications Recipe Management POST /recipes - Create recipe GET /recipes - Get all recipes GET /recipes/{recipeId} - Get specific recipe POST /recipes/search - Search recipes AI Features POST /recipes/generate-ai - AI recipe generation (Bedrock) POST /ai/nutrition - Nutrition analysis GET /dictionary/{ingredient} - Ingredient translation File Upload POST /upload/presigned-url - Get presigned URL Upload file to S3 using presigned URL Access file via CloudFront CDN Verify CloudFront caching (Miss → Hit) Admin Features (if admin) GET /admin/stats - Get system stats GET /admin/users - List all users GET /admin/posts/reported - Get reported content Infrastructure All Lambda functions execute without errors SQS queues process messages correctly CloudWatch logs show proper execution DynamoDB items created correctly WAF rules protecting API Gateway Performance Benchmarks Thời gian phản hồi mong đợi:\nEndpoint Thời gian mong đợi Ghi chú GET /health \u0026lt; 50ms Direct response POST /auth/login \u0026lt; 200ms Cognito validation GET /users/me \u0026lt; 100ms DynamoDB single query POST /posts \u0026lt; 300ms DynamoDB write + notifications GET /posts \u0026lt; 500ms DynamoDB query with pagination POST /recipes/generate-ai 5-10 seconds Bedrock AI generation POST /upload/presigned-url \u0026lt; 100ms S3 presigned URL generation POST /recipes/search \u0026lt; 200ms DynamoDB GSI query Xử Lý Sự Cố Thường Gặp 1. 401 Unauthorized # Verify JWT token not expired $ID_TOKEN = \u0026#34;your-token-here\u0026#34; $parts = $ID_TOKEN.Split(\u0026#39;.\u0026#39;) $payload = [System.Text.Encoding]::UTF8.GetString( [System.Convert]::FromBase64String($parts[1]) ) | ConvertFrom-Json $exp = [DateTimeOffset]::FromUnixTimeSeconds($payload.exp).DateTime Write-Host \u0026#34;Token expires at: $exp\u0026#34; # If expired, login again 2. 403 Forbidden (WAF Block) # Check WAF logs aws wafv2 get-web-acl ` --name EveryoneCook-API-WAF-dev ` --scope REGIONAL ` --region ap-southeast-1 # Check if IP blocked 3. 500 Internal Server Error # Check Lambda function logs aws logs tail /aws/lambda/everyonecook-dev-api-router --follow aws logs tail /aws/lambda/everyonecook-dev-social --follow # Check DynamoDB table aws dynamodb describe-table --table-name EveryoneCook-dev 4. Slow AI Recipe Generation # Check Bedrock model availability aws bedrock list-foundation-models --region us-east-1 # Check AI Queue aws sqs get-queue-attributes ` --queue-url $AI_QUEUE_URL ` --attribute-names All Các Bước Tiếp Theo Sau khi test thành công tất cả endpoints:\n✅ Verify Infrastructure: Tất cả AWS resources hoạt động đúng 📊 Monitor CloudWatch: Check metrics và logs 🔒 Security Review: Verify WAF rules và Cognito auth 📝 Document API: Update API documentation nếu cần 🚀 Deploy Frontend: Proceed to frontend deployment 📦 Version Control: Commit code và push to GitLab (next step) Tiếp tục: 5.09 - Push to GitLab\n2. Xác nhận User\n# Confirm user with code aws cognito-idp confirm-sign-up \\ --client-id $CLIENT_ID \\ --username testuser \\ --confirmation-code 123456 3. Verify Post-Confirmation Trigger\n# Check if user profile was created in DynamoDB aws dynamodb get-item \\ --table-name EveryoneCook-dev \\ --key \u0026#39;{\u0026#34;PK\u0026#34;:{\u0026#34;S\u0026#34;:\u0026#34;USER#testuser\u0026#34;},\u0026#34;SK\u0026#34;:{\u0026#34;S\u0026#34;:\u0026#34;PROFILE\u0026#34;}}\u0026#39; # Should return user profile with: # - PK: USER#testuser # - SK: PROFILE # - userId: cognito-sub-id # - email: test@example.com # - fullName: Test User # - birthday: null # - gender: null # - country: null Bước 5: Test User Login 1. Đăng nhập\n# Sign in to get tokens TOKENS=$(aws cognito-idp initiate-auth \\ --client-id $CLIENT_ID \\ --auth-flow USER_PASSWORD_AUTH \\ --auth-parameters USERNAME=testuser,PASSWORD=TestPassword123!) # Extract tokens ACCESS_TOKEN=$(echo $TOKENS | jq -r \u0026#39;.AuthenticationResult.AccessToken\u0026#39;) ID_TOKEN=$(echo $TOKENS | jq -r \u0026#39;.AuthenticationResult.IdToken\u0026#39;) REFRESH_TOKEN=$(echo $TOKENS | jq -r \u0026#39;.AuthenticationResult.RefreshToken\u0026#39;) echo \u0026#34;ID Token: $ID_TOKEN\u0026#34; 2. Verify Post-Authentication Trigger\n# Check if lastLoginAt was updated aws dynamodb get-item \\ --table-name EveryoneCook-dev \\ --key \u0026#39;{\u0026#34;PK\u0026#34;:{\u0026#34;S\u0026#34;:\u0026#34;USER#testuser\u0026#34;},\u0026#34;SK\u0026#34;:{\u0026#34;S\u0026#34;:\u0026#34;PROFILE\u0026#34;}}\u0026#39; \\ --projection-expression \u0026#34;lastLoginAt\u0026#34; Bước 6: Test Profile Management 1. Lấy Profile\n# Get user profile curl -X GET \\ -H \u0026#34;Authorization: Bearer $ID_TOKEN\u0026#34; \\ $API_ENDPOINT/auth/profile # Expected: User profile data 2. Cập nhật Profile\n# Update profile (onboarding) curl -X PUT \\ -H \u0026#34;Authorization: Bearer $ID_TOKEN\u0026#34; \\ -H \u0026#34;Content-Type: application/json\u0026#34; \\ -d \u0026#39;{ \u0026#34;birthday\u0026#34;: \u0026#34;1990-01-01\u0026#34;, \u0026#34;gender\u0026#34;: \u0026#34;male\u0026#34;, \u0026#34;country\u0026#34;: \u0026#34;US\u0026#34; }\u0026#39; \\ $API_ENDPOINT/auth/profile # Expected: Updated profile 3. Xác minh Update trong DynamoDB\n# Check updated profile aws dynamodb get-item \\ --table-name EveryoneCook-dev \\ --key \u0026#39;{\u0026#34;PK\u0026#34;:{\u0026#34;S\u0026#34;:\u0026#34;USER#testuser\u0026#34;},\u0026#34;SK\u0026#34;:{\u0026#34;S\u0026#34;:\u0026#34;PROFILE\u0026#34;}}\u0026#39; # Should show birthday, gender, country updated Bước 7: Test Social Features 1. Tạo Post\n# Create a post POST_RESPONSE=$(curl -X POST \\ -H \u0026#34;Authorization: Bearer $ID_TOKEN\u0026#34; \\ -H \u0026#34;Content-Type: application/json\u0026#34; \\ -d \u0026#39;{ \u0026#34;content\u0026#34;: \u0026#34;My first post on EveryoneCook!\u0026#34;, \u0026#34;visibility\u0026#34;: \u0026#34;public\u0026#34; }\u0026#39; \\ $API_ENDPOINT/social/posts) POST_ID=$(echo $POST_RESPONSE | jq -r \u0026#39;.postId\u0026#39;) echo \u0026#34;Created post: $POST_ID\u0026#34; 2. Lấy Posts Feed\n# Get posts curl -X GET \\ -H \u0026#34;Authorization: Bearer $ID_TOKEN\u0026#34; \\ $API_ENDPOINT/social/posts # Expected: Array of posts including the one just created 3. Like Post\n# Like the post curl -X POST \\ -H \u0026#34;Authorization: Bearer $ID_TOKEN\u0026#34; \\ $API_ENDPOINT/social/posts/$POST_ID/like # Expected: Success message 4. Comment trên Post\n# Add comment curl -X POST \\ -H \u0026#34;Authorization: Bearer $ID_TOKEN\u0026#34; \\ -H \u0026#34;Content-Type: application/json\u0026#34; \\ -d \u0026#39;{\u0026#34;content\u0026#34;:\u0026#34;Great post!\u0026#34;}\u0026#39; \\ $API_ENDPOINT/social/posts/$POST_ID/comment # Expected: Comment created Bước 8: Test Recipe Features 1. Tạo Recipe\n# Create a recipe RECIPE_RESPONSE=$(curl -X POST \\ -H \u0026#34;Authorization: Bearer $ID_TOKEN\u0026#34; \\ -H \u0026#34;Content-Type: application/json\u0026#34; \\ -d \u0026#39;{ \u0026#34;title\u0026#34;: \u0026#34;Pho Bo (Vietnamese Beef Noodle Soup)\u0026#34;, \u0026#34;description\u0026#34;: \u0026#34;Traditional Vietnamese beef noodle soup\u0026#34;, \u0026#34;ingredients\u0026#34;: [ {\u0026#34;name\u0026#34;: \u0026#34;beef bones\u0026#34;, \u0026#34;amount\u0026#34;: \u0026#34;2\u0026#34;, \u0026#34;unit\u0026#34;: \u0026#34;kg\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;rice noodles\u0026#34;, \u0026#34;amount\u0026#34;: \u0026#34;500\u0026#34;, \u0026#34;unit\u0026#34;: \u0026#34;g\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;ginger\u0026#34;, \u0026#34;amount\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;unit\u0026#34;: \u0026#34;piece\u0026#34;} ], \u0026#34;instructions\u0026#34;: [ \u0026#34;Boil beef bones for 2 hours\u0026#34;, \u0026#34;Add spices and simmer\u0026#34;, \u0026#34;Prepare noodles and serve\u0026#34; ], \u0026#34;cuisine\u0026#34;: \u0026#34;Vietnamese\u0026#34;, \u0026#34;difficulty\u0026#34;: \u0026#34;medium\u0026#34;, \u0026#34;prepTime\u0026#34;: 30, \u0026#34;cookTime\u0026#34;: 120 }\u0026#39; \\ $API_ENDPOINT/recipes) RECIPE_ID=$(echo $RECIPE_RESPONSE | jq -r \u0026#39;.recipeId\u0026#39;) echo \u0026#34;Created recipe: $RECIPE_ID\u0026#34; 2. Lấy Recipes\n# Get all recipes curl -X GET \\ -H \u0026#34;Authorization: Bearer $ID_TOKEN\u0026#34; \\ $API_ENDPOINT/recipes # Expected: Array of recipes 3. Lấy Recipe theo ID\n# Get specific recipe curl -X GET \\ -H \u0026#34;Authorization: Bearer $ID_TOKEN\u0026#34; \\ $API_ENDPOINT/recipes/$RECIPE_ID # Expected: Recipe details Bước 9: Test AI Features 1. Tạo Recipe với AI\n# Generate recipe using Bedrock curl -X POST \\ -H \u0026#34;Authorization: Bearer $ID_TOKEN\u0026#34; \\ -H \u0026#34;Content-Type: application/json\u0026#34; \\ -d \u0026#39;{ \u0026#34;ingredients\u0026#34;: [\u0026#34;chicken\u0026#34;, \u0026#34;rice\u0026#34;, \u0026#34;vegetables\u0026#34;], \u0026#34;cuisine\u0026#34;: \u0026#34;Vietnamese\u0026#34;, \u0026#34;dietaryRestrictions\u0026#34;: [\u0026#34;gluten-free\u0026#34;], \u0026#34;servings\u0026#34;: 4 }\u0026#39; \\ $API_ENDPOINT/ai/generate-recipe # Expected: AI-generated recipe (takes 5-10 seconds) # Response includes Vietnamese ingredient names 2. Dịch Ingredient\n# Translate ingredient to Vietnamese curl -X POST \\ -H \u0026#34;Authorization: Bearer $ID_TOKEN\u0026#34; \\ -H \u0026#34;Content-Type: application/json\u0026#34; \\ -d \u0026#39;{ \u0026#34;ingredient\u0026#34;: \u0026#34;tomato\u0026#34;, \u0026#34;targetLanguage\u0026#34;: \u0026#34;vi\u0026#34; }\u0026#39; \\ $API_ENDPOINT/ai/translate # Expected: {\u0026#34;translation\u0026#34;: \u0026#34;cà chua\u0026#34;, \u0026#34;confidence\u0026#34;: 0.99} Bước 10: Test File Upload 1. Yêu cầu Pre-signed URL\n# Get pre-signed URL for avatar upload UPLOAD_RESPONSE=$(curl -X POST \\ -H \u0026#34;Authorization: Bearer $ID_TOKEN\u0026#34; \\ -H \u0026#34;Content-Type: application/json\u0026#34; \\ -d \u0026#39;{ \u0026#34;fileType\u0026#34;: \u0026#34;avatar\u0026#34;, \u0026#34;fileName\u0026#34;: \u0026#34;avatar.jpg\u0026#34;, \u0026#34;contentType\u0026#34;: \u0026#34;image/jpeg\u0026#34;, \u0026#34;fileSize\u0026#34;: 1024000 }\u0026#39; \\ $API_ENDPOINT/upload/presigned-url) PRESIGNED_URL=$(echo $UPLOAD_RESPONSE | jq -r \u0026#39;.url\u0026#39;) UPLOAD_KEY=$(echo $UPLOAD_RESPONSE | jq -r \u0026#39;.key\u0026#39;) echo \u0026#34;Pre-signed URL: $PRESIGNED_URL\u0026#34; echo \u0026#34;Upload Key: $UPLOAD_KEY\u0026#34; 2. Upload File lên S3\n# Create test image echo \u0026#34;Test image content\u0026#34; \u0026gt; test-avatar.jpg # Upload using pre-signed URL curl -X PUT \\ -H \u0026#34;Content-Type: image/jpeg\u0026#34; \\ --upload-file test-avatar.jpg \\ \u0026#34;$PRESIGNED_URL\u0026#34; # Expected: 200 OK 3. Đánh dấu Upload Complete\n# Notify backend that upload is complete curl -X POST \\ -H \u0026#34;Authorization: Bearer $ID_TOKEN\u0026#34; \\ -H \u0026#34;Content-Type: application/json\u0026#34; \\ -d \u0026#34;{\\\u0026#34;key\\\u0026#34;:\\\u0026#34;$UPLOAD_KEY\\\u0026#34;}\u0026#34; \\ $API_ENDPOINT/upload/complete # Expected: Success message 4. Truy cập qua CloudFront\n# Access file via CloudFront CDN curl -I https://cdn.everyonecook.cloud/$UPLOAD_KEY # First request: X-Cache: Miss from cloudfront # Second request: X-Cache: Hit from cloudfront Bước 11: Test Search (OpenSearch) Nếu OpenSearch được bật:\n# Search recipes with Vietnamese query curl -X POST \\ -H \u0026#34;Authorization: Bearer $ID_TOKEN\u0026#34; \\ -H \u0026#34;Content-Type: application/json\u0026#34; \\ -d \u0026#39;{ \u0026#34;query\u0026#34;: \u0026#34;phở bò\u0026#34;, \u0026#34;filters\u0026#34;: { \u0026#34;cuisine\u0026#34;: \u0026#34;Vietnamese\u0026#34;, \u0026#34;difficulty\u0026#34;: \u0026#34;medium\u0026#34; }, \u0026#34;limit\u0026#34;: 10 }\u0026#39; \\ $API_ENDPOINT/ai/search # Expected: Array of matching recipes # Vietnamese analyzer handles: \u0026#34;phở bò\u0026#34; = \u0026#34;pho bo\u0026#34; = \u0026#34;beef noodle soup\u0026#34; Bước 12: Test Admin Features 1. Liệt kê Users (Admin Only)\n# Get all users (requires admin role) curl -X GET \\ -H \u0026#34;Authorization: Bearer $ID_TOKEN\u0026#34; \\ $API_ENDPOINT/admin/users # Expected: Array of users or 403 Forbidden if not admin Bước 13: Xác minh Async Processing 1. Kiểm tra SQS Queue Processing\n# Send message to SearchIndex queue QUEUE_URL=$(aws sqs list-queues \\ --queue-name-prefix EveryoneCook-dev-SearchIndexQueue \\ | jq -r \u0026#39;.QueueUrls[0]\u0026#39;) aws sqs send-message \\ --queue-url $QUEUE_URL \\ --message-body \u0026#34;{ \\\u0026#34;eventName\\\u0026#34;: \\\u0026#34;INSERT\\\u0026#34;, \\\u0026#34;tableName\\\u0026#34;: \\\u0026#34;recipes\\\u0026#34;, \\\u0026#34;keys\\\u0026#34;: {\\\u0026#34;PK\\\u0026#34;: \\\u0026#34;USER#testuser\\\u0026#34;, \\\u0026#34;SK\\\u0026#34;: \\\u0026#34;RECIPE#$RECIPE_ID\\\u0026#34;}, \\\u0026#34;newImage\\\u0026#34;: { \\\u0026#34;title\\\u0026#34;: \\\u0026#34;Pho Bo\\\u0026#34;, \\\u0026#34;ingredients\\\u0026#34;: [\\\u0026#34;beef\\\u0026#34;, \\\u0026#34;noodles\\\u0026#34;], \\\u0026#34;cuisine\\\u0026#34;: \\\u0026#34;Vietnamese\\\u0026#34; } }\u0026#34; # Check worker logs aws logs tail /aws/lambda/EveryoneCook-dev-SearchSyncWorker --follow Testing Checklist Health check phản hồi User registration hoạt động Email verification hoạt động User login thành công Profile CRUD operations hoạt động Posts có thể được tạo Posts có thể được liked Comments có thể được thêm Recipes có thể được tạo AI recipe generation hoạt động Ingredient translation hoạt động File upload lên S3 hoạt động CloudFront phục vụ files Search hoạt động (nếu OpenSearch enabled) SQS queues xử lý messages Tất cả Lambda functions thực thi không lỗi Performance Benchmarks Thời gian phản hồi mong đợi:\nHealth check: \u0026lt; 50ms User login: \u0026lt; 200ms Get profile: \u0026lt; 100ms Create post: \u0026lt; 300ms Get posts feed: \u0026lt; 500ms AI recipe generation: 5-10 seconds File upload (pre-signed URL): \u0026lt; 100ms Search query: \u0026lt; 200ms Các Bước Tiếp Theo Sau khi tất cả tests pass, tiến hành Push to GitLab để version control code của bạn và thiết lập CI/CD.\n"
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/1-worklog/1.8-week8/",
	"title": "Báo cáo công việc Tuần 8",
	"tags": [],
	"description": "",
	"content": "Mục tiêu Tuần 8: Tối ưu hóa Chi phí: Làm chủ các mô hình định giá tiết kiệm như Savings Plans, Reserved Instances (RI) cho EC2 và RDS. Tối ưu hóa Tài nguyên: Sử dụng AWS Compute Optimizer và CloudWatch để xác định và điều chỉnh quy mô tài nguyên (Right Sizing). Quản lý \u0026amp; Trực quan hóa Chi phí: Phân tích báo cáo chi phí chi tiết bằng AWS Cost Explorer và hiểu rõ các chi phí truyền tải dữ liệu. Đánh giá Kiến thức: Thực hiện bài kiểm tra giữa kỳ mô phỏng kỳ thi AWS Certified Solutions Architect. Các nhiệm vụ thực hiện trong tuần: Ngày Nhiệm vụ Ngày bắt đầu Ngày hoàn thành Tài liệu tham khảo 2 Các Mô hình Tiết kiệm Chi phí - Tìm hiểu và phân biệt Savings Plans (Compute/EC2) và Reserved Instances. - Phân tích khuyến nghị Savings Plan (Recommendations). - Thực hành quy trình mua Savings Plan và Reserved DB Instances. 27/10/2025 27/10/2025 https://000042.awsstudygroup.com/ 3 Tối ưu hóa Tài nguyên (Right Sizing) - Cài đặt CloudWatch Agent để thu thập metrics bộ nhớ (RAM). - Cấu hình IAM Role cho CloudWatch và Compute Optimizer. - Sử dụng AWS Compute Optimizer để nhận khuyến nghị về loại instance tối ưu. - Áp dụng các Best Practices về EC2 Resource Optimization. 28/10/2025 28/10/2025 https://000032.awsstudygroup.com/ 4 Trực quan hóa \u0026amp; Phân tích Chi phí cơ bản - Sử dụng Cost Explorer để xem chi phí theo Dịch vụ (Service) và Tài khoản (Account). - Theo dõi mức độ bao phủ (Coverage) và sử dụng (Utilization) của Savings Plan/RI. - Phân tích tính đàn hồi (Elasticity) của hạ tầng. 29/10/2025 29/10/2025 https://000034.awsstudygroup.com/ 5 Phân tích Chi phí Nâng cao \u0026amp; Ôn tập - Tạo các Custom Reports cho EC2. - Phân tích chi phí Data Transfer (truyền tải dữ liệu). - Nghiên cứu thêm: Thiết lập AWS Cost \u0026amp; Usage Report (CUR) và truy vấn bằng Amazon Athena (Lý thuyết). - Hệ thống hóa lại kiến thức 8 tuần qua để chuẩn bị thi. 30/10/2025 30/10/2025 https://000034.awsstudygroup.com/ Ôn tập kiến thức SAA 6 Kiểm tra Giữa kỳ (Midterm Exam) - Thực hiện bài thi thử AWS Certified Solutions Architect - Associate (SAA-C03). - Định dạng: 65 câu hỏi trắc nghiệm / 130 phút. - Nội dung bao phủ: IAM, VPC, EC2, S3, RDS, HA/Scaling, Cost Optimization. - Đánh giá kết quả và rà soát các lỗ hổng kiến thức. 31/10/2025 31/10/2025 Đề thi thử AWS SAA Practice Exam Thành tựu Tuần 8 Chiến lược Tối ưu hóa Chi phí Đã nắm vững sự khác biệt giữa Savings Plans (linh hoạt hơn) và Reserved Instances (truyền thống), từ đó đưa ra quyết định mua phù hợp cho từng loại workload. Biết cách sử dụng công cụ Recommendations để xác định mức cam kết chi phí tối ưu dựa trên lịch sử sử dụng. Thực hiện thành công việc áp dụng Reserved Instance cho cơ sở dữ liệu RDS để giảm chi phí vận hành lâu dài. Tối ưu hóa Tài nguyên Hệ thống Triển khai thành công CloudWatch Agent để thu thập các chỉ số custom (như Memory usage) mà CloudWatch mặc định không cung cấp, giúp đánh giá chính xác hiệu năng instance. Sử dụng AWS Compute Optimizer để phát hiện các tài nguyên đang bị dư thừa (Over-provisioned) hoặc thiếu hụt (Under-provisioned) và thực hiện điều chỉnh kích thước (Right Sizing) hợp lý. Quản trị Tài chính Đám mây (FinOps) Làm chủ công cụ AWS Cost Explorer để trực quan hóa dòng tiền và chi phí sử dụng theo ngày, tháng, hoặc theo từng dịch vụ cụ thể. Tạo được các báo cáo tùy chỉnh (Custom Reports) để theo dõi chi phí Data Transfer - một loại chi phí ẩn thường bị bỏ qua. Hiểu rõ cách theo dõi hiệu quả sử dụng của các gói Savings Plan/RI thông qua các biểu đồ Coverage và Utilization. Đánh giá Năng lực (Midterm) Hoàn thành bài kiểm tra mô phỏng AWS Certified Solutions Architect. Đã rà soát lại toàn bộ kiến thức nền tảng về 4 trụ cột chính: Compute, Storage, Networking và Database. Xác định được các điểm yếu cần cải thiện trong các tuần tiếp theo (ví dụ: các kịch bản về Hybrid Cloud hoặc Advanced Networking). "
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/5-workshop/5.09-push-gitlab/",
	"title": "Push lên GitLab",
	"tags": [],
	"description": "",
	"content": "Tổng quan Sau khi test thành công, bạn sẽ push code lên GitLab để version control và chuẩn bị cho CI/CD.\nBước 1: Khởi tạo Git Repository 1. Kiểm tra Git Status\n# Di chuyển đến project root cd /path/to/everyonecook-dev # Kiểm tra Git đã được khởi tạo chưa git status # Nếu chưa khởi tạo: git init 2. Cấu hình Git\n# Đặt tên và email của bạn git config user.name \u0026#34;Your Name\u0026#34; git config user.email \u0026#34;your.email@example.com\u0026#34; # Xác minh cấu hình git config --list Bước 2: Tạo .gitignore 1. Tạo file .gitignore\n# Tạo .gitignore cat \u0026gt; .gitignore \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; # Dependencies node_modules/ package-lock.json yarn.lock # Build outputs dist/ build/ *.js.map *.d.ts.map cdk.out/ .next/ # Environment variables .env .env.local .env.*.local # AWS *.pem *.key cloudfront-private-key.pem # Deployment packages *.zip deployment/ # Logs logs/ *.log npm-debug.log* yarn-debug.log* yarn-error.log* # IDE .vscode/ .idea/ *.swp *.swo *~ # OS .DS_Store Thumbs.db # Test coverage coverage/ .nyc_output/ # Temporary files tmp/ temp/ *.tmp # CDK cdk.context.json outputs.json # TypeScript *.tsbuildinfo EOF Bước 3: Stage và Commit Files 1. Thêm Files vào Staging\n# Thêm tất cả files git add . # Kiểm tra những gì sẽ được commit git status 2. Tạo Initial Commit\n# Commit với message git commit -m \u0026#34;Initial commit: EveryoneCook infrastructure and backend\u0026#34; # Xác minh commit git log --oneline Screenshot: Terminal hiển thị initial commit\nBước 4: Tạo GitLab Repository 1. Đăng nhập vào GitLab\nTruy cập https://gitlab.com/ và đăng nhập\n2. Tạo New Project\nClick \u0026ldquo;New project\u0026rdquo; Chọn \u0026ldquo;Create blank project\u0026rdquo; Tên project: everyonecook Visibility: Private (khuyến nghị) Initialize with README: No (chúng ta đã có code) Click \u0026ldquo;Create project\u0026rdquo; Screenshot: GitLab hiển thị project mới được tạo\nTóm tắt Git Workflow 1. Tạo feature branch từ dev\rgit checkout -b feature/new-feature\r2. Thực hiện thay đổi và commit\rgit add .\rgit commit -m \u0026#34;Description\u0026#34;\r3. Push lên GitLab\rgit push -u origin feature/new-feature\r4. Tạo merge request trên GitLab\rfeature/new-feature → dev\r5. Review, test, và merge\r6. Deploy lên dev environment\r(manual trigger trong GitLab CI/CD)\r7. Test trong dev environment\r8. Merge dev → main cho production\r9. Deploy lên production\r(manual trigger trong GitLab CI/CD)\r10. Tag release\rgit tag -a v1.0.0 -m \u0026#34;Release\u0026#34; Best Practices Commit Messages:\nfeat: Thêm user authentication\rfix: Sửa lỗi login\rdocs: Cập nhật README\rstyle: Format code\rrefactor: Refactor user service\rtest: Thêm unit tests\rchore: Cập nhật dependencies Đặt tên Branch:\nfeature/add-notifications\rbugfix/fix-login-error\rhotfix/critical-security-patch\rrelease/v1.0.0 Khắc phục sự cố Vấn đề: Authentication failed\n# Sử dụng personal access token thay vì password # Tạo token: GitLab → Settings → Access Tokens # Sử dụng token làm password khi push Vấn đề: Large files rejected\n# Kiểm tra kích thước file git ls-files -z | xargs -0 du -h | sort -h # Xóa large files khỏi history git filter-branch --tree-filter \u0026#39;rm -f large-file.zip\u0026#39; HEAD Vấn đề: Merge conflicts\n# Cập nhật branch của bạn git checkout feature/your-feature git fetch origin git merge origin/dev # Giải quyết conflicts trong files # Sau đó commit git add . git commit -m \u0026#34;Resolve merge conflicts\u0026#34; git push Bước tiếp theo Sau khi push code lên GitLab, tiếp tục với Deploy lên Amplify để triển khai ứng dụng frontend.\n"
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/1-worklog/1.9-week9/",
	"title": "Worklog Tuần 9",
	"tags": [],
	"description": "",
	"content": "Mục tiêu tuần 9 Củng cố kiến thức nền tảng backend: thiết kế API, xác thực, cấu trúc dữ liệu. Làm quen với các dịch vụ backend quan trọng trên AWS: API Gateway, Lambda, DynamoDB, Cognito. Xây dựng phiên bản đầu tiên của kiến trúc backend dự án. Thực hành phát triển API an toàn và xử lý request/response đúng chuẩn. Các công việc thực hiện trong tuần: Ngày Công việc Ngày bắt đầu Ngày hoàn thành Nguồn tài liệu 2 Học thiết kế REST API, phương thức HTTP và quy trình backend. - Thiết kế các API endpoints ban đầu. 03/11/2025 03/11/2025 AWS Study Group 3 Học API Gateway. - Tạo routes, methods, validate request và enable logging. 04/11/2025 04/11/2025 AWS Study Group 4 Tìm hiểu AWS Lambda. - Viết và deploy các hàm CRUD cơ bản. - Test bằng event triggers. 05/11/2025 05/11/2025 AWS Study Group 5 Học DynamoDB. - Thiết kế schema. - Thực hiện CRUD operations. 06/11/2025 06/11/2025 AWS Study Group 6 Học Cognito Authentication. - Tạo User Pool. - Kết nối Cognito với API Gateway. 07/11/2025 07/11/2025 AWS Study Group Kết quả đạt được trong tuần 9 1. Nắm vững kiến trúc backend hiện đại Tôi hiểu rõ hơn về cách tổ chức backend theo kiến trúc nhiều lớp, cách tách biệt logic xử lý và cách API giao tiếp với dịch vụ xác thực và cơ sở dữ liệu. Điều này giúp tôi tự tin hơn khi xây dựng hệ thống quy mô lớn.\n2. Thiết kế tài liệu API rõ ràng và đầy đủ Tôi đã hoàn thiện bản API specification đầu tiên, bao gồm routes, body, response, error codes và mô tả logic. Đây là bước cực kỳ quan trọng giúp đồng bộ giữa backend và frontend.\n3. Cấu hình thành công API Gateway Tôi đã tạo các API routes, cấu hình CORS, logging và kết nối đến Lambda. Việc này giúp tôi hiểu rõ cách request từ client được chuyển đến backend trong mô hình serverless.\n4. Xây dựng Lambda Functions xử lý logic Tôi đã viết các hàm Lambda đầu tiên, học cách quản lý input/output và triển khai logic backend mà không cần server. Điều này giúp tôi làm quen với mô hình serverless hiệu quả và tiết kiệm chi phí.\n5. Thiết kế và vận hành DynamoDB Tôi đã tạo bảng, chọn partition/sort key hợp lý và thực hành các thao tác CRUD. Tôi hiểu rõ hơn về mô hình dữ liệu NoSQL và cách tối ưu truy vấn.\n6. Tích hợp xác thực bằng Cognito Tôi đã tạo User Pool, đăng ký người dùng và tích hợp xác thực vào API Gateway. Điều này giúp backend trở nên an toàn hơn và tuân thủ quy trình bảo mật tiêu chuẩn.\n"
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/5-workshop/5.10-deploy-amplify/",
	"title": "Deploy lên Amplify",
	"tags": [],
	"description": "",
	"content": "Tổng quan Bước cuối cùng là deploy frontend Next.js 15 lên AWS Amplify với tích hợp GitLab để tự động deploy khi có code mới.\nBước 1: Chuẩn bị Frontend Code 1. Kiểm tra Frontend Structure\ncd frontend # Kiểm tra package.json cat package.json # Phải hiển thị Next.js 15 2. Test Frontend Locally\n# Cài đặt dependencies npm install # Chạy development server npm run dev # Mở http://localhost:3000 3. Build Frontend\n# Build cho production npm run build # Test production build npm start Bước 2: Tạo Amplify App 1. Vào AWS Amplify Console\nMở AWS Console Tìm kiếm \u0026ldquo;Amplify\u0026rdquo; Click \u0026ldquo;Get started\u0026rdquo; hoặc \u0026ldquo;New app\u0026rdquo; 2. Kết nối với GitLab\nChọn \u0026ldquo;Host web app\u0026rdquo; Chọn \u0026ldquo;GitLab\u0026rdquo; Click \u0026ldquo;Connect branch\u0026rdquo; Ủy quyền AWS Amplify truy cập GitLab Screenshot: Amplify hiển thị kết nối GitLab\n3. Chọn Repository\nChọn repository: everyonecook Chọn branch: main (hoặc dev cho development) Click \u0026ldquo;Next\u0026rdquo; Bước 3: Cấu hình Build Settings 1. Tên App\nApp name: everyonecook-frontend 2. Build Settings\nAmplify tự động phát hiện Next.js, nhưng hãy xác minh:\nversion: 1 applications: - frontend: phases: preBuild: commands: - export HUSKY=0 - npm install --legacy-peer-deps --ignore-scripts build: commands: - echo \u0026#34;=== Creating .env.production from Amplify env vars ===\u0026#34; - rm -f .env.production - env | grep -e NEXT_PUBLIC_ \u0026gt; .env.production || true - echo \u0026#34;=== .env.production content ===\u0026#34; - cat .env.production - echo \u0026#34;=== Building frontend ===\u0026#34; - npm run build artifacts: baseDirectory: .next files: - \u0026#39;**/*\u0026#39; cache: paths: - node_modules/**/* - .next/cache/**/* appRoot: frontend 3. Advanced Settings\nThêm environment variables:\nNEXT_PUBLIC_API_URL=https://api.everyonecook.cloud\rNEXT_PUBLIC_CDN_URL=https://cdn.everyonecook.cloud\rNEXT_PUBLIC_USER_POOL_ID=us-east-1_ABC123\rNEXT_PUBLIC_USER_POOL_CLIENT_ID=abc123def456\rNEXT_PUBLIC_REGION=us-east-1 Screenshot: Cấu hình environment variables của Amplify\nBước 4: Deploy Frontend 1. Bắt đầu Deployment\nClick \u0026ldquo;Save and deploy\u0026rdquo;\nAmplify sẽ:\nClone repository từ GitLab Cài đặt dependencies Build Next.js app Deploy lên CDN Cung cấp domain 2. Theo dõi Deployment\nXem tiến trình deployment:\nProvision Build Deploy Verify 3. Đợi Hoàn thành\nDeployment mất 5-10 phút.\nScreenshot: Amplify hiển thị deployment thành công\nBước 5: Cấu hình Custom Domain 1. Thêm Custom Domain\nVào Amplify app → Domain management Click \u0026ldquo;Add domain\u0026rdquo; Nhập domain: everyonecook.cloud Amplify sẽ tự động cấu hình: Root domain: everyonecook.cloud WWW subdomain: www.everyonecook.cloud 2. Cấu hình DNS\nAmplify tự động tạo DNS records trong Route 53:\neveryonecook.cloud → A record → Amplify\rwww.everyonecook.cloud → CNAME → Amplify 3. SSL Certificate\nAmplify tự động cung cấp SSL certificate qua ACM.\n4. Đợi DNS Propagation\nMất 5-15 phút.\nScreenshot: Amplify hiển thị custom domain đã cấu hình\nBước 6: Xác minh Deployment 1. Truy cập Frontend\n# Qua Amplify domain curl -I https://main.d1234567890.amplifyapp.com # Qua custom domain curl -I https://everyonecook.cloud # Phải trả về 200 OK 2. Test Chức năng Frontend\nMở https://everyonecook.cloud trong trình duyệt Test đăng ký user Test đăng nhập Test tạo posts Test tạo recipes Test tính năng AI Screenshot: Trình duyệt hiển thị EveryoneCook frontend đang chạy\nBest Practices Sử dụng Environment Variables: Không bao giờ hardcode API URLs Bật Auto-Deploy: Tự động deployments khi push Nhiều Environments: Tách biệt dev và prod Monitor Performance: Sử dụng Amplify metrics Thiết lập Notifications: Nhận cảnh báo khi build fails Sử dụng Custom Domain: Giao diện chuyên nghiệp Bật HTTPS: Luôn sử dụng SSL Cấu hình Headers: Security headers để bảo vệ Bước tiếp theo Chúc mừng! Ứng dụng của bạn giờ đã được deploy đầy đủ:\n✅ Infrastructure trên AWS ✅ Backend APIs đang chạy ✅ Frontend trên Amplify ✅ Code trên GitLab ✅ CI/CD đã cấu hình Tiếp tục đến Cleanup khi bạn hoàn thành testing, hoặc bắt đầu sử dụng ứng dụng!\n"
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/1-worklog/1.10-week10/",
	"title": "Worklog Tuần 10",
	"tags": [],
	"description": "",
	"content": "Mục tiêu tuần 10 Nâng cao kiến thức bảo mật backend và quy trình xác thực trong môi trường cloud. Hoàn thiện tích hợp Cognito và áp dụng mô hình authentication dựa trên token. Áp dụng validation, access pattern và secondary index cho DynamoDB. Tìm hiểu về authorizer, throttling và rate-limit trên API Gateway. Bắt đầu kết nối các thành phần backend thành quy trình hoàn chỉnh. Các công việc thực hiện trong tuần: Ngày Công việc Ngày bắt đầu Ngày hoàn thành Tài liệu tham khảo 2 Học về authentication/authorization (JWT, Access Token, ID Token). - Ôn OWASP API Security. 10/11/2025 10/11/2025 AWS Study Group 3 Tìm hiểu sâu Cognito User Pool và Identity Pool. - Triển khai signup, login, refresh token flow. 11/11/2025 11/11/2025 AWS Study Group 4 Tạo Lambda Authorizer và gắn vào API Gateway. - Thêm IAM permission. 12/11/2025 12/11/2025 AWS Study Group 5 Nâng cấp DynamoDB: - Thêm secondary index. - Tăng cường validation \u0026amp; error handling. 13/11/2025 13/11/2025 AWS Study Group 6 Kiểm thử end-to-end: - Client → API Gateway → Lambda → DynamoDB. 14/11/2025 14/11/2025 AWS Study Group Kết quả đạt được trong tuần 10 1. Hiểu rõ hơn về bảo mật và quy trình xác thực Tôi đã tìm hiểu sâu về cơ chế hoạt động của JWT, sự khác nhau giữa Access/ID/Refresh Token và các phương pháp phòng chống tấn công trong API security. Điều này giúp backend an toàn hơn và tuân thủ chuẩn OWASP.\n2. Hoàn thiện quy trình xác thực bằng Cognito Tôi đã cấu hình signup, login, xác thực đa yếu tố (nếu cần), và refresh token trong Cognito. Các flow này được test bằng Postman và CLI để đảm bảo backend xử lý chính xác danh tính người dùng.\n3. Tích hợp Lambda Authorizer để bảo vệ API Tôi đã tạo Authorizer tùy chỉnh để xác minh token trước khi API được gọi. Nhờ đó, hệ thống có thể phân quyền chính xác và bảo vệ các endpoint quan trọng khỏi truy cập trái phép.\n4. Tối ưu DynamoDB bằng Secondary Index Tôi thêm GSI vào bảng dữ liệu, cải thiện đáng kể tốc độ truy vấn và hỗ trợ các kiểu truy vấn phức tạp hơn. Đồng thời, tôi bổ sung logic validation để dữ liệu luôn chính xác và nhất quán.\n5. Hoàn thiện quy trình backend đầu–cuối Tôi đã kiểm thử toàn bộ luồng:\nClient gửi request → API Gateway xử lý → Lambda thực thi → DynamoDB lưu/truy xuất → trả về kết quả.\nLuồng hoạt động mượt mà và chính xác.\n6. Cải thiện cấu trúc code và khả năng bảo trì Tôi đã refactor lại code của Lambda theo mô hình rõ ràng hơn, tách riêng logic, validation và truy cập database. Điều này giúp backend phát triển dễ dàng và hạn chế lỗi trong tương lai.\n"
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/5-workshop/5.11-cleanup/",
	"title": "Dọn dẹp tài nguyên",
	"tags": [],
	"description": "",
	"content": "Tổng quan Khi bạn hoàn thành workshop và không muốn tiếp tục sử dụng, hãy xóa tất cả tài nguyên để tránh phát sinh chi phí.\n⚠️ Cảnh báo: Quá trình này không thể hoàn tác. Tất cả dữ liệu sẽ bị xóa vĩnh viễn.\nThứ tự Dọn dẹp Phải xóa theo thứ tự ngược lại với deployment:\n1. Amplify App (Frontend)\r2. Observability Stack\r3. Backend Stack\r4. Auth Stack\r5. Core Stack\r6. Certificate Stack\r7. DNS Stack\r8. CDK Bootstrap (tùy chọn) Bước 1: Xóa Amplify App 1. Xóa qua Console\nVào AWS Amplify Console Chọn app của bạn Click \u0026ldquo;Actions\u0026rdquo; → \u0026ldquo;Delete app\u0026rdquo; Nhập tên app để xác nhận Click \u0026ldquo;Delete\u0026rdquo; 2. Xóa qua CLI\n# Lấy app ID APP_ID=$(aws amplify list-apps \\ --query \u0026#39;apps[?name==`everyonecook-frontend`].appId\u0026#39; \\ --output text) # Xóa app aws amplify delete-app --app-id $APP_ID Bước 2: Làm trống S3 Buckets S3 buckets phải được làm trống trước khi xóa:\n# Liệt kê tất cả EveryoneCook buckets aws s3 ls | grep everyonecook # Làm trống từng bucket (4 buckets) aws s3 rm s3://everyonecook-content-dev-xxxxx --recursive aws s3 rm s3://everyonecook-logs-dev-xxxxx --recursive aws s3 rm s3://everyonecook-emails-dev-xxxxx --recursive aws s3 rm s3://everyonecook-cdn-logs-dev-xxxxx --recursive # Hoặc sử dụng PowerShell script $buckets = aws s3 ls | Select-String \u0026#34;everyonecook\u0026#34; | ForEach-Object { $_.ToString().Split()[-1] } foreach ($bucket in $buckets) { Write-Host \u0026#34;Emptying bucket: $bucket\u0026#34; aws s3 rm \u0026#34;s3://$bucket\u0026#34; --recursive } Bước 3: Xóa CDK Stacks 1. Xóa Observability Stack\ncd infrastructure # Xóa Observability stack npx cdk destroy EveryoneCook-dev-Observability --context environment=dev # Nhập \u0026#39;y\u0026#39; để xác nhận 2. Xóa Backend Stack\n# Xóa Backend stack npx cdk destroy EveryoneCook-dev-Backend --context environment=dev # Nhập \u0026#39;y\u0026#39; để xác nhận 3. Xóa Auth Stack\n# Xóa Auth stack npx cdk destroy EveryoneCook-dev-Auth --context environment=dev # Nhập \u0026#39;y\u0026#39; để xác nhận 4. Xóa Core Stack\n# Xóa Core stack (mất 15-20 phút do CloudFront) npx cdk destroy EveryoneCook-dev-Core --context environment=dev # Nhập \u0026#39;y\u0026#39; để xác nhận 5. Xóa Certificate Stack\n# Xóa Certificate stack npx cdk destroy EveryoneCook-dev-Certificate --context environment=dev # Nhập \u0026#39;y\u0026#39; để xác nhận 6. Xóa DNS Stack (Tùy chọn)\n# Xóa DNS stack (chỉ nếu bạn không cần domain) npx cdk destroy EveryoneCook-dev-DNS --context environment=dev # Nhập \u0026#39;y\u0026#39; để xác nhận Bước 4: Xác minh Tất cả Stacks đã Xóa # Liệt kê các stacks còn lại aws cloudformation list-stacks \\ --stack-status-filter CREATE_COMPLETE UPDATE_COMPLETE \\ --query \u0026#39;StackSummaries[?contains(StackName, `EveryoneCook-dev`)].StackName\u0026#39; # Phải trả về mảng rỗng Bước 5: Xóa CDK Bootstrap (Tùy chọn) ⚠️ Chỉ làm điều này nếu bạn đã xong hoàn toàn với CDK:\n# Xóa CDK bootstrap stack aws cloudformation delete-stack --stack-name CDKToolkit # Làm trống và xóa CDK assets bucket BUCKET_NAME=$(aws s3 ls | grep cdk | awk \u0026#39;{print $3}\u0026#39;) aws s3 rm s3://$BUCKET_NAME --recursive aws s3 rb s3://$BUCKET_NAME Bước 6: Xóa GitLab Repository (Tùy chọn) 1. Archive Repository\nVào GitLab → Settings → General Kéo xuống \u0026ldquo;Advanced\u0026rdquo; Click \u0026ldquo;Archive project\u0026rdquo; 2. Xóa Repository\nVào GitLab → Settings → General Kéo xuống \u0026ldquo;Advanced\u0026rdquo; Click \u0026ldquo;Delete project\u0026rdquo; Nhập tên project để xác nhận Click \u0026ldquo;Yes, delete project\u0026rdquo; Bước 7: Xác minh Dọn dẹp Hoàn tất 1. Kiểm tra CloudFormation\naws cloudformation list-stacks \\ --stack-status-filter CREATE_COMPLETE UPDATE_COMPLETE \\ | grep EveryoneCook # Không trả về gì 2. Kiểm tra S3\naws s3 ls | grep everyonecook # Không trả về gì 3. Kiểm tra Lambda\naws lambda list-functions | grep EveryoneCook # Không trả về gì 4. Kiểm tra DynamoDB\naws dynamodb list-tables | grep EveryoneCook # Không trả về gì 5. Kiểm tra API Gateway\naws apigateway get-rest-apis | grep EveryoneCook # Không trả về gì 6. Kiểm tra Cognito\naws cognito-idp list-user-pools --max-results 10 | grep EveryoneCook # Không trả về gì 7. Kiểm tra CloudFront\naws cloudfront list-distributions | grep EveryoneCook # Không trả về gì 8. Kiểm tra OpenSearch\naws opensearch list-domain-names | grep everyonecook # Không trả về gì 9. Kiểm tra Amplify\naws amplify list-apps | grep everyonecook # Không trả về gì Chi phí Sau Dọn dẹp Ngay lập tức:\nHầu hết tài nguyên: $0/tháng Route 53 Hosted Zone: $0.50/tháng (nếu giữ lại) KMS keys: Đã lên lịch xóa (7-30 ngày), không tính phí trong thời gian chờ Sau 30 ngày:\nMọi thứ: $0/tháng (nếu DNS stack cũng đã xóa) Khắc phục sự cố Dọn dẹp Vấn đề: S3 bucket xóa thất bại\n# Buộc làm trống và xóa aws s3 rb s3://bucket-name --force Vấn đề: CloudFormation stack bị stuck\n# Kiểm tra stack events aws cloudformation describe-stack-events \\ --stack-name EveryoneCook-dev-Core \\ --max-items 20 # Nếu stuck, bỏ qua tài nguyên failed aws cloudformation delete-stack \\ --stack-name EveryoneCook-dev-Core \\ --retain-resources ResourceLogicalId Vấn đề: CloudFront distribution không thể xóa\n# Vô hiệu hóa distribution trước DIST_ID=$(aws cloudfront list-distributions \\ --query \u0026#34;DistributionList.Items[?Comment==\u0026#39;EveryoneCook-dev\u0026#39;].Id\u0026#34; \\ --output text) # Lấy ETag ETAG=$(aws cloudfront get-distribution --id $DIST_ID \\ --query \u0026#34;ETag\u0026#34; --output text) # Vô hiệu hóa distribution aws cloudfront update-distribution \\ --id $DIST_ID \\ --if-match $ETAG \\ --distribution-config file://disabled-config.json # Đợi 15-20 phút, sau đó xóa aws cloudfront delete-distribution --id $DIST_ID --if-match $ETAG Vấn đề: DynamoDB table có deletion protection\n# Tắt deletion protection aws dynamodb update-table \\ --table-name EveryoneCook-dev \\ --no-deletion-protection-enabled # Sau đó xóa stack Xác minh Cuối cùng # Kiểm tra AWS billing aws ce get-cost-and-usage \\ --time-period Start=2024-01-01,End=2024-01-31 \\ --granularity MONTHLY \\ --metrics BlendedCost # Phải hiển thị chi phí giảm dần Checklist Dọn dẹp Amplify app đã xóa Tất cả S3 buckets đã làm trống và xóa Observability stack đã xóa Backend stack đã xóa Auth stack đã xóa Core stack đã xóa Certificate stack đã xóa DNS stack đã xóa (tùy chọn) CDK bootstrap đã xóa (tùy chọn) GitLab repository đã archive/xóa (tùy chọn) Không còn CloudFormation stacks Không còn Lambda functions Không còn DynamoDB tables Không còn S3 buckets Không còn CloudFront distributions Không còn Cognito user pools Billing hiển thị $0 hoặc chi phí tối thiểu Kết luận Bạn đã hoàn thành workshop EveryoneCook! Bạn đã học được:\nInfrastructure as Code với AWS CDK\nServerless Architecture với Lambda và API Gateway\nDynamoDB Single Table Design với username-based PK\nOpenSearch với Vietnamese analyzer\nCloudFront CDN với Origin Access Control\nCognito Authentication với Lambda triggers\nBedrock AI integration\nGitLab version control và CI/CD\nAWS Amplify frontend deployment\nCloudWatch monitoring và X-Ray tracing\nTổng cộng đã deploy:\n7 CDK stacks 100+ AWS resources 6 Lambda modules + 1 worker Full-stack application CI/CD pipeline Production-ready infrastructure Cảm ơn bạn đã hoàn thành workshop! 🎉\n"
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/1-worklog/1.11-week11/",
	"title": "Worklog Tuần 11",
	"tags": [],
	"description": "",
	"content": "Mục tiêu tuần 11 Bắt đầu kết nối frontend với các API backend có xác thực. Tăng cường cơ chế xử lý lỗi cho API Gateway và Lambda. Triển khai lưu trữ token an toàn và logic refresh token. Xây dựng API client tái sử dụng (Axios/Fetch) với interceptors. Cải thiện logging, debugging và phân tích CloudWatch. Hoàn thiện luồng full-stack từ UI → Gateway → Lambda → Database. Các công việc thực hiện trong tuần: Ngày Nhiệm vụ Ngày bắt đầu Ngày hoàn thành Tài liệu tham khảo 2 Kết nối frontend đến các endpoint Cognito. - Xây UI đăng nhập và đăng ký. 17/11/2025 17/11/2025 AWS Study Group 3 Triển khai lưu token an toàn \u0026amp; cơ chế refresh token. - Thêm interceptors cho API client. 18/11/2025 18/11/2025 AWS Study Group 4 Tích hợp frontend với các route API Gateway có bảo vệ. - Kiểm tra luồng Lambda Authorizer. 19/11/2025 19/11/2025 AWS Study Group 5 Xây hệ thống xử lý lỗi toàn cục (frontend + backend). - Chuẩn hóa response API. 20/11/2025 20/11/2025 AWS Study Group 6 Tăng cường giám sát bằng CloudWatch Logs \u0026amp; Metrics. - Debug toàn bộ luồng end-to-end. 21/11/2025 21/11/2025 AWS Study Group Kết quả đạt được trong tuần 11 1. Hoàn tất kết nối Frontend với Cognito Tôi đã kết nối thành công frontend với Cognito, cho phép người dùng đăng ký, đăng nhập và đăng xuất ngay từ giao diện. Mọi thao tác lấy token và quản lý session đều hoạt động ổn định.\n2. Triển khai lưu token an toàn \u0026amp; tự động refresh Tôi sử dụng bộ nhớ tạm của trình duyệt để lưu token an toàn và xây dựng cơ chế refresh token tự động. Tôi cũng thêm interceptors để tự động đính kèm access token vào mỗi request.\n3. Kết nối frontend với API backend được bảo vệ Frontend hiện có thể gọi các route API Gateway có yêu cầu xác thực JWT, giúp xác nhận trọn vẹn luồng bảo mật từ UI → Client → Gateway → Lambda → DynamoDB.\n4. Xây dựng hệ thống xử lý lỗi thống nhất Tôi chuẩn hóa lỗi backend trong Lambda, config API Gateway mapping, và tạo một global error handler trên frontend để hiển thị thông báo rõ ràng hơn. Điều này cải thiện UX và giảm thời gian debug.\n5. Cải thiện logging \u0026amp; monitoring bằng CloudWatch Tôi phân tích log Lambda, phát hiện bottleneck, và tạo các bộ lọc CloudWatch Metrics để theo dõi tỷ lệ lỗi và độ trễ. Workflow debug nhanh hơn và hiệu quả hơn.\n6. Hoàn thành luồng Full-Stack Authentication + Data Cuối tuần, tôi đã chạy thành công trọn vẹn luồng full-stack: UI → Xác thực → Gửi request → Lambda → DynamoDB → Trả kết quả.\nMọi thứ hoạt động mượt mà với đầy đủ bảo mật và xử lý lỗi.\n"
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/1-worklog/1.12-week12/",
	"title": "Worklog Tuần 12 ",
	"tags": [],
	"description": "",
	"content": "Mục tiêu tuần 12 Cải thiện UI/UX tổng thể và triển khai quản lý state nâng cao. Kết nối các component frontend với dữ liệu backend theo thời gian thực. Tăng cường validation cho API và đảm bảo sự ổn định của API contract. Xây dựng các UI component tái sử dụng như form, modal, thông báo lỗi. Tối ưu mạng, caching và giảm số lượng API call không cần thiết. Chuẩn bị cho các tính năng full-stack phức tạp liên quan đến thao tác người dùng. Nhiệm vụ thực hiện trong tuần Ngày Nhiệm vụ Ngày bắt đầu Ngày hoàn thành Tài liệu tham khảo 2 Triển khai global state management (Redux/Zustand/Context). - Đồng bộ trạng thái session. 24/11/2025 24/11/2025 AWS Study Group 3 Xây dựng thư viện UI component tái sử dụng: input, modal, loader, thông báo. 25/11/2025 25/11/2025 AWS Study Group 4 Tích hợp dữ liệu backend vào UI. - Thêm cơ chế fetch + auto refresh. 26/11/2025 26/11/2025 AWS Study Group 5 Tăng cường validation API \u0026amp; form frontend. - Đảm bảo ổn định API contract. 27/11/2025 27/11/2025 AWS Study Group 6 Tối ưu performance và caching frontend. - Giảm API call trùng lặp bằng memoization. 28/11/2025 28/11/2025 AWS Study Group Kết quả đạt được tuần 12 1. Triển khai Global State Management có thể mở rộng Tuần này, tôi triển khai quản lý state tập trung để đồng bộ session, UI state và dữ liệu động. Điều này giúp code sạch hơn và giảm việc truyền props không cần thiết.\n2. Xây dựng thư viện UI Component tái sử dụng Tôi đã tạo nhiều component dùng lại được: button, input, modal, loader, skeleton và toast thông báo. Điều này giúp giao diện đồng nhất và tăng tốc phát triển UI.\n3. Tích hợp dữ liệu backend vào giao diện Tôi kết nối UI với dữ liệu backend theo thời gian thực, cập nhật trạng thái mỗi khi người dùng thao tác. Tôi cũng thêm cả auto-refresh và manual refresh.\n4. Tăng cường validation \u0026amp; API contract Backend đã được cải thiện validation và API Gateway mapping rõ ràng hơn. Frontend cũng được bổ sung form validation mạnh mẽ, giảm lỗi nhập liệu và giúp API phản hồi nhất quán.\n5. Tối ưu hiệu suất \u0026amp; giảm API Call Tôi triển khai caching, memoization và loại bỏ request trùng. Nhờ đó UI mượt hơn, giảm tải mạng và tăng tốc độ xử lý.\n6. Chuẩn bị nền tảng cho các tính năng full-stack phức tạp Cuối tuần, tôi đã hoàn thành nền tảng cần thiết để phát triển các chức năng full-stack liên quan đến cập nhật dữ liệu và hành vi UI động theo thao tác người dùng.\n"
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/categories/",
	"title": "Categories",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://nvtruongops.github.io/fcj-workshop-template/vi/tags/",
	"title": "Tags",
	"tags": [],
	"description": "",
	"content": ""
}]