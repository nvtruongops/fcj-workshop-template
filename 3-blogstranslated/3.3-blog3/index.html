<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.134.3"><meta name=description content><meta name=author content="thienlh@thienlu.com"><link rel=icon href=../../images/favicon.png type=image/png><title>Blog 3 :: Internship Report</title>
<link href=../../css/nucleus.css?1759567511 rel=stylesheet><link href=../../css/fontawesome-all.min.css?1759567511 rel=stylesheet><link href=../../css/hybrid.css?1759567511 rel=stylesheet><link href=../../css/featherlight.min.css?1759567511 rel=stylesheet><link href=../../css/perfect-scrollbar.min.css?1759567511 rel=stylesheet><link href=../../css/auto-complete.css?1759567511 rel=stylesheet><link href=../../css/atom-one-dark-reasonable.css?1759567511 rel=stylesheet><link href=../../css/theme.css?1759567511 rel=stylesheet><link href=../../css/hugo-theme.css?1759567511 rel=stylesheet><link href=../../css/theme-workshop.css?1759567511 rel=stylesheet><script src=../../js/jquery-3.3.1.min.js?1759567511></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=../../3-blogstranslated/3.3-blog3/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=../../><svg id="Layer_1" data-name="Layer 1" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff}.cls-2{fill:#f90;fill-rule:evenodd}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09 10.85a4.7 4.7.0 00.19 1.48 7.73 7.73.0 00.54 1.19.77.77.0 01.12.38.64.64.0 01-.32.49l-1 .7a.83.83.0 01-.44.15.69.69.0 01-.49-.23 3.8 3.8.0 01-.6-.77q-.25-.42-.51-1a6.14 6.14.0 01-4.89 2.3 4.54 4.54.0 01-3.32-1.19 4.27 4.27.0 01-1.22-3.2 4.28 4.28.0 011.46-3.4A6.06 6.06.0 017.69 6.46a12.47 12.47.0 011.76.13q.92.13 1.91.36V5.73a3.65 3.65.0 00-.79-2.66A3.81 3.81.0 007.86 2.3a7.71 7.71.0 00-1.79.22 12.78 12.78.0 00-1.79.57 4.55 4.55.0 01-.58.22h-.26q-.35.0-.35-.52V2a1.09 1.09.0 01.12-.58 1.2 1.2.0 01.47-.35A10.88 10.88.0 015.77.32 10.19 10.19.0 018.36.0a6 6 0 014.35 1.35 5.49 5.49.0 011.38 4.09zM7.34 13.38a5.36 5.36.0 001.72-.31A3.63 3.63.0 0010.63 12 2.62 2.62.0 0011.19 11a5.63 5.63.0 00.16-1.44v-.7a14.35 14.35.0 00-1.53-.28 12.37 12.37.0 00-1.56-.1 3.84 3.84.0 00-2.47.67A2.34 2.34.0 005 11a2.35 2.35.0 00.61 1.76A2.4 2.4.0 007.34 13.38zm13.35 1.8a1 1 0 01-.64-.16 1.3 1.3.0 01-.35-.65L15.81 1.51a3 3 0 01-.15-.67.36.36.0 01.41-.41H17.7a1 1 0 01.65.16 1.4 1.4.0 01.33.65l2.79 11 2.59-11A1.17 1.17.0 0124.39.6a1.1 1.1.0 01.67-.16H26.4a1.1 1.1.0 01.67.16 1.17 1.17.0 01.32.65L30 12.39 32.88 1.25A1.39 1.39.0 0133.22.6a1 1 0 01.65-.16h1.54a.36.36.0 01.41.41 1.36 1.36.0 010 .26 3.64 3.64.0 01-.12.41l-4 12.86a1.3 1.3.0 01-.35.65 1 1 0 01-.64.16H29.25a1 1 0 01-.67-.17 1.26 1.26.0 01-.32-.67L25.67 3.64l-2.56 10.7a1.26 1.26.0 01-.32.67 1 1 0 01-.67.17zm21.36.44a11.28 11.28.0 01-2.56-.29 7.44 7.44.0 01-1.92-.67 1 1 0 01-.61-.93v-.84q0-.52.38-.52a.9.9.0 01.31.06l.42.17a8.77 8.77.0 001.83.58 9.78 9.78.0 002 .2 4.48 4.48.0 002.43-.55 1.76 1.76.0 00.86-1.57 1.61 1.61.0 00-.45-1.16A4.29 4.29.0 0043 9.22l-2.41-.76A5.15 5.15.0 0138 6.78a3.94 3.94.0 01-.83-2.41 3.7 3.7.0 01.45-1.85 4.47 4.47.0 011.19-1.37 5.27 5.27.0 011.7-.86A7.4 7.4.0 0142.6.0a8.87 8.87.0 011.12.07q.57.07 1.08.19t.95.26a4.27 4.27.0 01.7.29 1.59 1.59.0 01.49.41.94.94.0 01.15.55v.79q0 .52-.38.52a1.76 1.76.0 01-.64-.2 7.74 7.74.0 00-3.2-.64 4.37 4.37.0 00-2.21.47 1.6 1.6.0 00-.79 1.48 1.58 1.58.0 00.49 1.18 4.94 4.94.0 001.83.92L44.55 7a5.08 5.08.0 012.57 1.6A3.76 3.76.0 0147.9 11a4.21 4.21.0 01-.44 1.93 4.4 4.4.0 01-1.21 1.47 5.43 5.43.0 01-1.85.93A8.25 8.25.0 0142.05 15.62z"/><path class="cls-2" d="M45.19 23.81C39.72 27.85 31.78 30 25 30A36.64 36.64.0 01.22 20.57c-.51-.46-.06-1.09.56-.74A49.78 49.78.0 0025.53 26.4 49.23 49.23.0 0044.4 22.53C45.32 22.14 46.1 23.14 45.19 23.81z"/><path class="cls-2" d="M47.47 21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74 3.13-2.2 8.27-1.57 8.86-.83s-.16 5.89-3.09 8.35c-.45.38-.88.18-.68-.32C46.69 25.8 48.17 22.11 47.47 21.21z"/></svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=../../js/lunr.min.js?1759567511></script><script type=text/javascript src=../../js/auto-complete.js?1759567511></script><script type=text/javascript>var baseurl="https://github.com/truongnv127/fcj-workshop-template/"</script><script type=text/javascript src=../../js/search.js?1759567511></script></div><div class=highlightable><ul class=topics><li data-nav-id=/1-worklog/ title=Worklog class=dd-item><a href=../../1-worklog/><b>1. </b>Worklog
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/1-worklog/1.1-week1/ title="Week 1 Worklog" class=dd-item><a href=../../1-worklog/1.1-week1/><b>1.1. </b>Week 1 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.5-week5/ title="Week 5 Worklog" class=dd-item><a href=../../1-worklog/1.5-week5/><b>1.5. </b>Week 5 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.6-week6/ title="Week 6 Worklog" class=dd-item><a href=../../1-worklog/1.6-week6/><b>1.6. </b>Week 6 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.7-week7/ title="Week 7 Worklog" class=dd-item><a href=../../1-worklog/1.7-week7/><b>1.7. </b>Week 7 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.8-week8/ title="Week 8 Worklog" class=dd-item><a href=../../1-worklog/1.8-week8/><b>1.8. </b>Week 8 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.9-week9/ title="Week 9 Worklog" class=dd-item><a href=../../1-worklog/1.9-week9/><b>1.9. </b>Week 9 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.2-week2/ title="Week 2 Worklog" class=dd-item><a href=../../1-worklog/1.2-week2/><b>1.2. </b>Week 2 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.10-week10/ title="Week 10 Worklog" class=dd-item><a href=../../1-worklog/1.10-week10/><b>1.10. </b>Week 10 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.11-week11/ title="Week 11 Worklog" class=dd-item><a href=../../1-worklog/1.11-week11/><b>1.11. </b>Week 11 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.12-week12/ title="Week 12 Worklog" class=dd-item><a href=../../1-worklog/1.12-week12/><b>1.12. </b>Week 12 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.3-week3/ title="Week 3 Worklog" class=dd-item><a href=../../1-worklog/1.3-week3/><b>1.3. </b>Week 3 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.4-week4/ title="Week 4 Worklog" class=dd-item><a href=../../1-worklog/1.4-week4/><b>1.4. </b>Week 4 Worklog
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/2-proposal/ title=Proposal class=dd-item><a href=../../2-proposal/><b>2. </b>Proposal
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/ title="Translated Blogs" class="dd-item
parent"><a href=../../3-blogstranslated/><b>3. </b>Translated Blogs
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/3-blogstranslated/3.4-blog4/ title="Blog 4" class=dd-item><a href=../../3-blogstranslated/3.4-blog4/><b>3.4. </b>Blog 4
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.3-blog3/ title="Blog 3" class="dd-item
active"><a href=../../3-blogstranslated/3.3-blog3/><b>3.3. </b>Blog 3
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.2-blog2/ title="Blog 2" class=dd-item><a href=../../3-blogstranslated/3.2-blog2/><b>3.2. </b>Blog 2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.1-blog1/ title="Blog 1" class=dd-item><a href=../../3-blogstranslated/3.1-blog1/><b>3.1. </b>Blog 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.5-blog5/ title="Blog 5" class=dd-item><a href=../../3-blogstranslated/3.5-blog5/><b>3.5. </b>Blog 5
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.6-blog6/ title="Blog 6" class=dd-item><a href=../../3-blogstranslated/3.6-blog6/><b>3.6. </b>Blog 6
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/4-eventparticipated/ title="Events Participated" class=dd-item><a href=../../4-eventparticipated/><b>4. </b>Events Participated
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/4-eventparticipated/4.1-event1/ title="Event 1" class=dd-item><a href=../../4-eventparticipated/4.1-event1/><b>4.1. </b>Event 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/4-eventparticipated/4.2-event2/ title="Event 2" class=dd-item><a href=../../4-eventparticipated/4.2-event2/><b>4.2. </b>Event 2
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/5-workshop/ title=Workshop class=dd-item><a href=../../5-workshop/><b>5. </b>Workshop
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/5-workshop/5.1-workshop-overview/ title=Introduction class=dd-item><a href=../../5-workshop/5.1-workshop-overview/><b>5.1. </b>Introduction
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.2-prerequiste/ title=Prerequiste class=dd-item><a href=../../5-workshop/5.2-prerequiste/><b>5.2. </b>Prerequiste
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.3-s3-vpc/ title="Access S3 from VPC" class=dd-item><a href=../../5-workshop/5.3-s3-vpc/><b>5.3. </b>Access S3 from VPC
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/5-workshop/5.3-s3-vpc/5.3.1-create-gwe/ title="Create a gateway endpoint" class=dd-item><a href=../../5-workshop/5.3-s3-vpc/5.3.1-create-gwe/><b>5.3.1 </b>Create a gateway endpoint
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.3-s3-vpc/5.3.2-test-gwe/ title="Test the Gateway Endpoint" class=dd-item><a href=../../5-workshop/5.3-s3-vpc/5.3.2-test-gwe/><b>5.3.2 </b>Test the Gateway Endpoint
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/5-workshop/5.4-s3-onprem/ title="Access S3 from on-premises" class=dd-item><a href=../../5-workshop/5.4-s3-onprem/><b>5.4. </b>Access S3 from on-premises
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/5-workshop/5.4-s3-onprem/5.4.1-prepare/ title="Prepare the environment" class=dd-item><a href=../../5-workshop/5.4-s3-onprem/5.4.1-prepare/><b>5.4.1 </b>Prepare the environment
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.4-s3-onprem/5.4.2-create-interface-enpoint/ title="Create an S3 Interface endpoint" class=dd-item><a href=../../5-workshop/5.4-s3-onprem/5.4.2-create-interface-enpoint/><b>5.4.2 </b>Create an S3 Interface endpoint
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.4-s3-onprem/5.4.3-test-endpoint/ title="Test the Interface Endpoint" class=dd-item><a href=../../5-workshop/5.4-s3-onprem/5.4.3-test-endpoint/><b>5.4.3 </b>Test the Interface Endpoint
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.4-s3-onprem/5.4.4-dns-simulation/ title="On-premises DNS Simulation" class=dd-item><a href=../../5-workshop/5.4-s3-onprem/5.4.4-dns-simulation/><b>5.4.4 </b>On-premises DNS Simulation
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/5-workshop/5.5-policy/ title="VPC Endpoint Policies" class=dd-item><a href=../../5-workshop/5.5-policy/><b>5.5. </b>VPC Endpoint Policies
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.6-cleanup/ title="Clean up" class=dd-item><a href=../../5-workshop/5.6-cleanup/><b>5.6. </b>Clean up
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/6-self-evaluation/ title=Self-Assessment class=dd-item><a href=../../6-self-evaluation/><b>6. </b>Self-Assessment
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/7-feedback/ title="Sharing and Feedback" class=dd-item><a href=../../7-feedback/><b>7. </b>Sharing and Feedback
<i class="fas fa-check read-icon"></i></a></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://www.facebook.com/groups/awsstudygroupfcj/><i class='fab fa-facebook'></i> AWS Study Group</a></li></ul></section><section id=prefooter><hr><ul><li><a class=padding><i class="fas fa-language fa-fw"></i><div class=select-style><select id=select-language onchange="location=this.value"><option id=en value=https://github.com/truongnv127/fcj-workshop-template/3-blogstranslated/3.3-blog3/ selected>English</option><option id=vi value=https://github.com/truongnv127/fcj-workshop-template/vi/3-blogstranslated/3.3-blog3/>Tiếng Việt</option></select><svg id="Capa_1" xmlns:xlink="http://www.w3.org/1999/xlink" width="255" height="255" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255"><g><g id="arrow-drop-down"><polygon points="0,63.75 127.5,191.25 255,63.75"/></g></g></svg></div></a></li><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></section><section id=footer><left><b>Workshop</b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7920860&style=0038&nbdigits=9&type=page&initCount=0" title=Migrate alt="web counter" border=0></a><br><b><a href=https://cloudjourney.awsstudygroup.com/>Cloud Journey</a></b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" alt="web counter" border=0>
</left><left><br><br><b>Last Updated</b><br><i><span id=lastUpdated style=color:orange></span>
</i><script>const today=new Date,formattedDate=today.toLocaleDateString("en-GB");document.getElementById("lastUpdated").textContent=formattedDate</script></left><left><br><br><b>Team</b><br><i><a href=https://www.facebook.com/groups/660548818043427 style=color:orange>First Cloud Journey</a><br></i></left><script async defer src=https://buttons.github.io/buttons.js></script></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=../../>Internship Report</a> > <a href=../../3-blogstranslated/>Translated Blogs</a> > Blog 3</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#cluster-state-overview>Cluster State Overview</a></li><li><a href=#bottleneck-1-cluster-state-communication>Bottleneck 1: Cluster State Communication</a><ul><li><a href=#solution-using-local-cluster-state>Solution: Using Local Cluster State</a></li></ul></li><li><a href=#bottleneck-2-scatter-gather-nature-of-statistics-apis>Bottleneck 2: Scatter-Gather Nature of Statistics APIs</a><ul><li><a href=#solution-local-aggregation-and-filtering>Solution: Local Aggregation and Filtering</a></li></ul></li><li><a href=#bottleneck-3-long-running-stats-requests>Bottleneck 3: Long-Running Stats Requests</a><ul><li><a href=#solution-cancellation-at-the-transport-layer>Solution: Cancellation at the Transport Layer</a></li></ul></li><li><a href=#bottleneck-4-large-response-sizes>Bottleneck 4: Large Response Sizes</a><ul><li><a href=#solution-paginated-list-apis>Solution: Paginated List APIs</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Blog 3</h1><h1 id=scaling-cluster-manager-and-admin-apis-in-amazon-opensearch-service>Scaling Cluster Manager and Admin APIs in Amazon OpenSearch Service</h1><p>Amazon OpenSearch Service is a managed service that makes it easy to deploy, secure, and operate OpenSearch clusters at scale in the AWS Cloud. A typical OpenSearch cluster consists of cluster manager, data, and coordinator nodes. It is recommended to have three cluster manager nodes, with one node elected as the leader.</p><hr><h2 id=introduction>Introduction</h2><p>With OpenSearch Service version 2.17, Amazon OpenSearch Service now supports clusters of up to 1,000 nodes capable of handling 500,000 shards. For large clusters, several bottlenecks in the admin API interactions with the leader node were identified and optimized in this version.</p><p>These improvements allow OpenSearch Service to maintain the same monitoring frequency for large clusters while using optimal resources (less than 10% CPU and under 75% JVM usage) on the leader node (16-core CPU with 64 GB JVM heap). It also ensures that metadata management operations can be performed on large clusters with predictable latency, without destabilizing the leader node.</p><hr><h2 id=cluster-state-overview>Cluster State Overview</h2><p>To understand the bottlenecks related to the cluster manager, let’s review the cluster state, which is the core operation of the leader node. The cluster state contains the following metadata:</p><ul><li>Cluster settings</li><li>Index metadata (index settings, mappings, aliases)</li><li>Routing table and shard metadata (shard allocations)</li><li>Node information and attributes</li><li>Snapshot information and custom metadata</li></ul><p>For example, a cluster with six nodes (three managers and three data nodes), one index, and three shards has a cluster state size of around 15 KB. However, a cluster with 1,000 nodes, 10,000 indexes, and 50 shards per index can result in a cluster state size of approximately 250 MB.</p><hr><h2 id=bottleneck-1-cluster-state-communication>Bottleneck 1: Cluster State Communication</h2><p>Admin APIs such as _cat, _cluster, and _nodes rely on the leader node to retrieve the latest cluster state. In very large clusters, these frequent calls can overwhelm the leader, leading to:</p><ul><li>Increased CPU usage from simultaneous admin API requests</li><li>High heap memory pressure due to repeated serialization of large cluster states</li><li>Delays and timeouts caused by busy transport threads</li><li>Missed heartbeat responses between nodes, triggering unnecessary recoveries</li></ul><h3 id=solution-using-local-cluster-state>Solution: Using Local Cluster State</h3><p>Each node caches the most recent version of the cluster state. By introducing versioning (term and version numbers), a coordinating node can check if its local state matches the leader’s before making a call. If it is up to date, it serves the API request locally without querying the leader.</p><p>This reduces the load on the leader node and improves cluster stability.</p><p><strong>Impact:</strong> Load tests show up to a 50% reduction in CPU usage on the leader with no increase in API latency, for clusters of 25,000 shards and larger.</p><hr><h2 id=bottleneck-2-scatter-gather-nature-of-statistics-apis>Bottleneck 2: Scatter-Gather Nature of Statistics APIs</h2><p>Statistics APIs such as _cat/indices, _cat/shards, _cluster/stats, and _nodes/stats require data to be collected from multiple data nodes and aggregated by the coordinator node.</p><p>In a 500,000-shard cluster, the combined response size can reach 2.5 GB, leading to:</p><ul><li>High network throughput</li><li>Memory pressure on coordinator nodes</li><li>Circuit breaker triggers and “429 Too Many Requests” responses</li><li>Increased CPU usage due to frequent garbage collection</li></ul><h3 id=solution-local-aggregation-and-filtering>Solution: Local Aggregation and Filtering</h3><p>Instead of returning complete shard-level statistics, each data node now performs local aggregation and sends only the requested metrics (for example, document count or storage size) to the coordinator.</p><p>This significantly reduces compute and memory overhead on the coordinator nodes.</p><p><strong>Impact:</strong></p><table><thead><tr><th style=text-align:left>API</th><th style=text-align:left>Previous Latency</th><th style=text-align:left>Optimized Latency</th></tr></thead><tbody><tr><td style=text-align:left>_cluster/stats</td><td style=text-align:left>15s</td><td style=text-align:left>0.65s</td></tr><tr><td style=text-align:left>_nodes/stats</td><td style=text-align:left>13.74s</td><td style=text-align:left>1.69s</td></tr><tr><td style=text-align:left>_cluster/health</td><td style=text-align:left>0.56s</td><td style=text-align:left>0.15s</td></tr></tbody></table><hr><h2 id=bottleneck-3-long-running-stats-requests>Bottleneck 3: Long-Running Stats Requests</h2><p>Previously, even if a user canceled a request or it timed out, the coordinator node continued to process and send internal transport requests to data nodes. This wasted compute and network resources.</p><h3 id=solution-cancellation-at-the-transport-layer>Solution: Cancellation at the Transport Layer</h3><p>The coordinator now cancels downstream requests once the client timeout expires. This prevents unnecessary load on data nodes and helps the cluster fail gracefully without cascading failures.</p><hr><h2 id=bottleneck-4-large-response-sizes>Bottleneck 4: Large Response Sizes</h2><p>Historically, the popular _cat APIs did not support pagination because the metadata size was small when they were designed. For modern large clusters, these unbounded responses can overwhelm coordinator nodes.</p><h3 id=solution-paginated-list-apis>Solution: Paginated List APIs</h3><p>New paginated list APIs (_list/indices and _list/shards) were introduced as stable, scalable alternatives. They maintain pagination consistency using a combination of index creation timestamps and index names, even when indexes are added or removed.</p><p><strong>Impact:</strong><br>Paginated APIs return consistent, bounded responses for clusters with up to 500,000 shards, ensuring stable response times and reduced resource usage.</p><hr><h2 id=conclusion>Conclusion</h2><p>Admin APIs are critical for observability and metadata management in Amazon OpenSearch Service. If not optimized, they can become performance bottlenecks in large clusters.</p><p>The improvements introduced in OpenSearch Service version 2.17 provide measurable performance gains for clusters of all sizes—small (20 nodes), medium (200 nodes), and large (1,000 nodes). These optimizations ensure that leader nodes remain stable even during heavy metadata and API operations.</p><p>Features like pagination, cancellation, and local aggregation are extensible and can be adopted for future API enhancements.</p><hr><p>For more information, see the original post on the AWS Big Data Blog:<br><a href=https://aws.amazon.com/blogs/big-data/scaling-cluster-manager-and-admin-apis-in-amazon-opensearch-service/>Scaling cluster manager and admin APIs in Amazon OpenSearch Service</a></p><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=../../3-blogstranslated/3.4-blog4/ title="Blog 4"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=../../3-blogstranslated/3.2-blog2/ title="Blog 2" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=../../js/clipboard.min.js?1759567511></script><script src=../../js/perfect-scrollbar.min.js?1759567511></script><script src=../../js/perfect-scrollbar.jquery.min.js?1759567511></script><script src=../../js/jquery.sticky.js?1759567511></script><script src=../../js/featherlight.min.js?1759567511></script><script src=../../js/highlight.pack.js?1759567511></script><script>hljs.initHighlightingOnLoad()</script><script src=../../js/modernizr.custom-3.6.0.js?1759567511></script><script src=../../js/learn.js?1759567511></script><script src=../../js/hugo-learn.js?1759567511></script><link href=../../mermaid/mermaid.css?1759567511 rel=stylesheet><script src=../../mermaid/mermaid.js?1759567511></script><script>mermaid.initialize({startOnLoad:!0})</script><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,(e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date),(i=t.createElement(n),a=t.getElementsByTagName(n)[0]),i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-158079754-2","auto"),ga("send","pageview")</script></body></html>